var data = {lines:[
{"lineNum":"    1","line":"const std = @import(\"std\");"},
{"lineNum":"    2","line":"const ast_ = @import(\"../ast/ast.zig\");"},
{"lineNum":"    3","line":"const CFG = @import(\"../ir/cfg.zig\");"},
{"lineNum":"    4","line":"const Cfg_Iterator = @import(\"../util/dfs.zig\").Dfs_Iterator(*CFG);"},
{"lineNum":"    5","line":"const Compiler_Context = @import(\"../hierarchy/compiler.zig\");"},
{"lineNum":"    6","line":"const errs_ = @import(\"../util/errors.zig\");"},
{"lineNum":"    7","line":"const Instruction = @import(\"../ir/instruction.zig\");"},
{"lineNum":"    8","line":"const pipeline_ = @import(\"../util/pipeline.zig\");"},
{"lineNum":"    9","line":"const Span = @import(\"../util/span.zig\");"},
{"lineNum":"   10","line":"const Scope = @import(\"../symbol/scope.zig\");"},
{"lineNum":"   11","line":"const Symbol = @import(\"../symbol/symbol.zig\");"},
{"lineNum":"   12","line":"const Module_Hash = @import(\"module_hash.zig\");"},
{"lineNum":"   13","line":"const Token = @import(\"../lexer/token.zig\");"},
{"lineNum":"   14","line":"const Type_Set = @import(\"../ast/type-set.zig\");"},
{"lineNum":"   15","line":"const UID_Gen = @import(\"../util/uid_gen.zig\");"},
{"lineNum":"   16","line":""},
{"lineNum":"   17","line":"// Front-end pipeline steps"},
{"lineNum":"   18","line":"const Read_File = @import(\"../lexer/read_file.zig\");"},
{"lineNum":"   19","line":"const Hash = @import(\"../lexer/hash.zig\");"},
{"lineNum":"   20","line":"const Split_Lines = @import(\"../lexer/split_lines.zig\");"},
{"lineNum":"   21","line":"const Tokenize = @import(\"../lexer/tokenize.zig\");"},
{"lineNum":"   22","line":"const Apply_Layout = @import(\"../lexer/apply_layout.zig\");"},
{"lineNum":"   23","line":"const Parse = @import(\"../parser/parse.zig\");"},
{"lineNum":"   24","line":"const Apply_Ast_Walk = @import(\"../ast/walker.zig\").Apply_Ast_Walk;"},
{"lineNum":"   25","line":"const Apply_Flat_Ast_Walk = @import(\"../ast/walker.zig\").Apply_Flat_Ast_Walk;"},
{"lineNum":"   26","line":""},
{"lineNum":"   27","line":"// AST walks"},
{"lineNum":"   28","line":"const Expand = @import(\"../ast/expand.zig\");"},
{"lineNum":"   29","line":"const Import = @import(\"../ast/import.zig\");"},
{"lineNum":"   30","line":"const Cinclude = @import(\"../ast/cinclude.zig\");"},
{"lineNum":"   31","line":"const Symbol_Tree = @import(\"../ast/symbol-tree.zig\");"},
{"lineNum":"   32","line":"const Decorate = @import(\"../ast/decorate.zig\");"},
{"lineNum":"   33","line":"// const Decorate_Access = @import(\"../ast/decorate-access.zig\");"},
{"lineNum":"   34","line":"const Type_Decorate = @import(\"../ast/type_decorate.zig\");"},
{"lineNum":"   35","line":""},
{"lineNum":"   36","line":"pub const Module_Errors = error{ OutOfMemory, LexerError, ParseError, CompileError, FileNotFound };"},
{"lineNum":"   37","line":"pub const Module_UID: type = u32;"},
{"lineNum":"   38","line":""},
{"lineNum":"   39","line":"var module_uids: Module_UID = 0;"},
{"lineNum":"   40","line":""},
{"lineNum":"   41","line":"/// This structure represents a module being compiled. Each module corresponds to a single .c/.h pair. A program has"},
{"lineNum":"   42","line":"/// many modules."},
{"lineNum":"   43","line":"///"},
{"lineNum":"   44","line":"/// Each module has a list of instructions, and a table of symbols/cfgs that refer to their corresponding instructions."},
{"lineNum":"   45","line":"pub const Module = struct {"},
{"lineNum":"   46","line":"    // A unique identifier for this Orange module"},
{"lineNum":"   47","line":"    uid: Module_UID,"},
{"lineNum":"   48","line":""},
{"lineNum":"   49","line":"    /// Unique Identifier generator for symbols in this module, so that symbols are given predictable, stable UIDs"},
{"lineNum":"   50","line":"    uid_gen: UID_Gen,"},
{"lineNum":"   51","line":""},
{"lineNum":"   52","line":"    // Absolute path of the module"},
{"lineNum":"   53","line":"    absolute_path: []const u8,"},
{"lineNum":"   54","line":""},
{"lineNum":"   55","line":"    // The name of the package this module belongs to"},
{"lineNum":"   56","line":"    package_name: []const u8,"},
{"lineNum":"   57","line":""},
{"lineNum":"   58","line":"    /// Set of local modules that are imported"},
{"lineNum":"   59","line":"    local_imported_modules: std.AutoArrayHashMap(*Module, void),"},
{"lineNum":"   60","line":""},
{"lineNum":"   61","line":"    // Set of C headers to include"},
{"lineNum":"   62","line":"    cincludes: std.array_list.Managed(*ast_.AST),"},
{"lineNum":"   63","line":""},
{"lineNum":"   64","line":"    /// List of instructions for this module. Used by the interpreter, so that instructions are indexable by a random"},
{"lineNum":"   65","line":"    /// access instruction pointer."},
{"lineNum":"   66","line":"    instructions: std.array_list.Managed(*Instruction),"},
{"lineNum":"   67","line":""},
{"lineNum":"   68","line":"    /// List of CFGs defined in this module. Used by codegen to generate functions and method definitions."},
{"lineNum":"   69","line":"    cfgs: std.array_list.Managed(*CFG),"},
{"lineNum":"   70","line":""},
{"lineNum":"   71","line":"    /// Main function. Used by codegen to jump to the main function. May be null for modules that don\'t contain the"},
{"lineNum":"   72","line":"    /// entry point of the package."},
{"lineNum":"   73","line":"    /// TODO: Isn\'t this more of a property of the package than the module?"},
{"lineNum":"   74","line":"    entry: ?*CFG,"},
{"lineNum":"   75","line":""},
{"lineNum":"   76","line":"    /// List of all traits defined in this module. Used by codegen to output the vtable structs definitions"},
{"lineNum":"   77","line":"    traits: std.array_list.Managed(*ast_.AST),"},
{"lineNum":"   78","line":""},
{"lineNum":"   79","line":"    /// List of all impls defined in this module. Used by codegen to output the vtable implementations."},
{"lineNum":"   80","line":"    impls: std.array_list.Managed(*ast_.AST),"},
{"lineNum":"   81","line":""},
{"lineNum":"   82","line":"    /// List of all tests defined in this module. Used by codegen to output the vtable implementations."},
{"lineNum":"   83","line":"    tests: std.array_list.Managed(*CFG),"},
{"lineNum":"   84","line":""},
{"lineNum":"   85","line":"    /// The types used by this module alone"},
{"lineNum":"   86","line":"    type_set: Type_Set,"},
{"lineNum":"   87","line":""},
{"lineNum":"   88","line":"    /// Allocator for the module"},
{"lineNum":"   89","line":"    allocator: std.mem.Allocator,"},
{"lineNum":"   90","line":""},
{"lineNum":"   91","line":"    /// The hash of the contents, used to track changes"},
{"lineNum":"   92","line":"    hash: u64,"},
{"lineNum":"   93","line":""},
{"lineNum":"   94","line":"    modified: ?bool,"},
{"lineNum":"   95","line":""},
{"lineNum":"   96","line":"    pub fn init(absolute_path: []const u8, allocator: std.mem.Allocator) *Module {","class":"lineCov","hits":"2","order":"369","possible_hits":"2",},
{"lineNum":"   97","line":"        var retval = allocator.create(Module) catch unreachable;","class":"lineCov","hits":"2","order":"370","possible_hits":"2",},
{"lineNum":"   98","line":"        retval.uid = module_uids;","class":"lineCov","hits":"1","order":"371","possible_hits":"1",},
{"lineNum":"   99","line":"        retval.uid_gen = UID_Gen.init();","class":"lineCov","hits":"1","order":"372","possible_hits":"1",},
{"lineNum":"  100","line":"        module_uids += 1;","class":"linePartCov","hits":"1","order":"373","possible_hits":"2",},
{"lineNum":"  101","line":"        std.debug.assert(std.fs.path.isAbsolute(absolute_path));","class":"lineCov","hits":"1","order":"374","possible_hits":"1",},
{"lineNum":"  102","line":"        retval.absolute_path = absolute_path;","class":"lineCov","hits":"1","order":"375","possible_hits":"1",},
{"lineNum":"  103","line":"        retval.package_name = std.fs.path.basename(std.fs.path.dirname(absolute_path).?);","class":"lineCov","hits":"2","order":"376","possible_hits":"2",},
{"lineNum":"  104","line":"        retval.allocator = allocator;","class":"lineCov","hits":"1","order":"377","possible_hits":"1",},
{"lineNum":"  105","line":"        retval.local_imported_modules = std.AutoArrayHashMap(*Module, void).init(allocator);","class":"lineCov","hits":"1","order":"378","possible_hits":"1",},
{"lineNum":"  106","line":"        retval.cincludes = std.array_list.Managed(*ast_.AST).init(allocator);","class":"lineCov","hits":"1","order":"379","possible_hits":"1",},
{"lineNum":"  107","line":"        retval.instructions = std.array_list.Managed(*Instruction).init(allocator);","class":"lineCov","hits":"1","order":"380","possible_hits":"1",},
{"lineNum":"  108","line":"        retval.traits = std.array_list.Managed(*ast_.AST).init(allocator);","class":"lineCov","hits":"1","order":"381","possible_hits":"1",},
{"lineNum":"  109","line":"        retval.impls = std.array_list.Managed(*ast_.AST).init(allocator);","class":"lineCov","hits":"1","order":"382","possible_hits":"1",},
{"lineNum":"  110","line":"        retval.tests = std.array_list.Managed(*CFG).init(allocator);","class":"lineCov","hits":"1","order":"383","possible_hits":"1",},
{"lineNum":"  111","line":"        retval.cfgs = std.array_list.Managed(*CFG).init(allocator);","class":"lineCov","hits":"1","order":"384","possible_hits":"1",},
{"lineNum":"  112","line":"        retval.type_set = Type_Set.init(allocator);","class":"lineCov","hits":"1","order":"385","possible_hits":"1",},
{"lineNum":"  113","line":"        retval.entry = null;","class":"lineCov","hits":"1","order":"388","possible_hits":"1",},
{"lineNum":"  114","line":"        retval.modified = null;","class":"lineCov","hits":"1","order":"389","possible_hits":"1",},
{"lineNum":"  115","line":""},
{"lineNum":"  116","line":"        return retval;","class":"lineCov","hits":"1","order":"390","possible_hits":"1",},
{"lineNum":"  117","line":"    }"},
{"lineNum":"  118","line":""},
{"lineNum":"  119","line":"    // TODO: Move to compiler context"},
{"lineNum":"  120","line":"    pub fn load_from_filename("},
{"lineNum":"  121","line":"        absolute_path: []const u8,"},
{"lineNum":"  122","line":"        entry_name: ?[]const u8,"},
{"lineNum":"  123","line":"        fuzz_tokens: bool,"},
{"lineNum":"  124","line":"        compiler: *Compiler_Context,"},
{"lineNum":"  125","line":"    ) Module_Errors!*Module {","class":"lineCov","hits":"2","order":"4384","possible_hits":"2",},
{"lineNum":"  126","line":"        // Check to see if the file exists"},
{"lineNum":"  127","line":"        {"},
{"lineNum":"  128","line":"            var file = std.fs.openFileAbsolute(absolute_path, .{}) catch |err| switch (err) {","class":"lineCov","hits":"2","order":"4385","possible_hits":"2",},
{"lineNum":"  129","line":"                error.FileNotFound => return error.FileNotFound,","class":"lineCov","hits":"1","order":"5791","possible_hits":"1",},
{"lineNum":"  130","line":"                else => return error.CompileError,","class":"linePartCov","hits":"1","order":"4386","possible_hits":"2",},
{"lineNum":"  131","line":"            };"},
{"lineNum":"  132","line":"            defer file.close();","class":"lineCov","hits":"1","order":"4387","possible_hits":"1",},
{"lineNum":"  133","line":"        }"},
{"lineNum":"  134","line":""},
{"lineNum":"  135","line":"        // Create the symbol for this module"},
{"lineNum":"  136","line":"        const module = Module.init(absolute_path, compiler.allocator());","class":"lineCov","hits":"1","order":"4388","possible_hits":"1",},
{"lineNum":"  137","line":"        var file_root = Scope.init(compiler.prelude, &module.uid_gen, compiler.allocator());","class":"lineCov","hits":"1","order":"4389","possible_hits":"1",},
{"lineNum":"  138","line":"        const symbol = Symbol.init(","class":"lineCov","hits":"1","order":"4396","possible_hits":"1",},
{"lineNum":"  139","line":"            compiler.prelude,","class":"lineCov","hits":"1","order":"4390","possible_hits":"1",},
{"lineNum":"  140","line":"            module.name(),","class":"lineCov","hits":"1","order":"4391","possible_hits":"1",},
{"lineNum":"  141","line":"            ast_.AST.create_module(","class":"lineCov","hits":"1","order":"4394","possible_hits":"1",},
{"lineNum":"  142","line":"                Token.init_simple(module.name()),","class":"lineCov","hits":"1","order":"4392","possible_hits":"1",},
{"lineNum":"  143","line":"                file_root,"},
{"lineNum":"  144","line":"                module,"},
{"lineNum":"  145","line":"                compiler.allocator(),","class":"lineCov","hits":"1","order":"4393","possible_hits":"1",},
{"lineNum":"  146","line":"            ),"},
{"lineNum":"  147","line":"            .module,"},
{"lineNum":"  148","line":"            .local,"},
{"lineNum":"  149","line":"            compiler.allocator(),","class":"lineCov","hits":"1","order":"4395","possible_hits":"1",},
{"lineNum":"  150","line":"        );"},
{"lineNum":"  151","line":"        try compiler.prelude.put_symbol(symbol, &compiler.errors);","class":"lineCov","hits":"2","order":"4397","possible_hits":"2",},
{"lineNum":"  152","line":"        file_root.module = module;","class":"lineCov","hits":"1","order":"4398","possible_hits":"1",},
{"lineNum":"  153","line":""},
{"lineNum":"  154","line":"        try fill_contents_from_file(absolute_path, entry_name, file_root, module, symbol, fuzz_tokens, compiler);","class":"lineCov","hits":"1","order":"4399","possible_hits":"1",},
{"lineNum":"  155","line":""},
{"lineNum":"  156","line":"        return module;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  157","line":"    }"},
{"lineNum":"  158","line":""},
{"lineNum":"  159","line":"    pub fn name(self: *const Module) []const u8 {","class":"lineCov","hits":"2","order":"3531","possible_hits":"2",},
{"lineNum":"  160","line":"        const basename = std.fs.path.basename(self.absolute_path);","class":"lineCov","hits":"1","order":"3532","possible_hits":"1",},
{"lineNum":"  161","line":"        var i: usize = 0;","class":"lineCov","hits":"1","order":"3533","possible_hits":"1",},
{"lineNum":"  162","line":"        while (i < basename.len and basename[i] != \'.\') : (i += 1) {}","class":"lineCov","hits":"1","order":"3534","possible_hits":"1",},
{"lineNum":"  163","line":"        return basename[0..i];","class":"lineCov","hits":"2","order":"3535","possible_hits":"2",},
{"lineNum":"  164","line":"    }"},
{"lineNum":"  165","line":""},
{"lineNum":"  166","line":"    fn fill_contents_from_file("},
{"lineNum":"  167","line":"        in_name: []const u8,"},
{"lineNum":"  168","line":"        entry_name: ?[]const u8,"},
{"lineNum":"  169","line":"        file_root: *Scope,"},
{"lineNum":"  170","line":"        module: *Module,"},
{"lineNum":"  171","line":"        module_symbol: *Symbol,"},
{"lineNum":"  172","line":"        fuzz_tokens: bool,"},
{"lineNum":"  173","line":"        compiler: *Compiler_Context,"},
{"lineNum":"  174","line":"    ) Module_Errors!void {","class":"lineCov","hits":"2","order":"4400","possible_hits":"2",},
{"lineNum":"  175","line":"        const read_file = Read_File.init(compiler.allocator());","class":"lineCov","hits":"1","order":"4401","possible_hits":"1",},
{"lineNum":"  176","line":"        const contents = try read_file.run(in_name);","class":"lineCov","hits":"1","order":"4402","possible_hits":"1",},
{"lineNum":"  177","line":"        return fill_contents(contents, in_name, entry_name, file_root, module, module_symbol, fuzz_tokens, compiler);","class":"lineCov","hits":"1","order":"4403","possible_hits":"1",},
{"lineNum":"  178","line":"    }"},
{"lineNum":"  179","line":""},
{"lineNum":"  180","line":"    pub fn fill_contents("},
{"lineNum":"  181","line":"        contents: []const u8,"},
{"lineNum":"  182","line":"        in_name: []const u8,"},
{"lineNum":"  183","line":"        entry_name: ?[]const u8,"},
{"lineNum":"  184","line":"        file_root: *Scope,"},
{"lineNum":"  185","line":"        module: *Module,"},
{"lineNum":"  186","line":"        module_symbol: *Symbol,"},
{"lineNum":"  187","line":"        fuzz_tokens: bool,"},
{"lineNum":"  188","line":"        compiler: *Compiler_Context,"},
{"lineNum":"  189","line":"    ) Module_Errors!void {","class":"lineCov","hits":"2","order":"471","possible_hits":"2",},
{"lineNum":"  190","line":"        compiler.register_interned_string_set(module.uid);","class":"lineCov","hits":"1","order":"472","possible_hits":"1",},
{"lineNum":"  191","line":"        compiler.register_module(module.absolute_path, module_symbol);","class":"lineCov","hits":"1","order":"480","possible_hits":"1",},
{"lineNum":"  192","line":""},
{"lineNum":"  193","line":"        if (compiler.core != null) {","class":"lineCov","hits":"1","order":"483","possible_hits":"1",},
{"lineNum":"  194","line":"            // Can be null if you\'re compiling the core module itself!"},
{"lineNum":"  195","line":"            module.local_imported_modules.put(compiler.core.?.module.?, void{}) catch unreachable;","class":"lineCov","hits":"2","order":"4404","possible_hits":"2",},
{"lineNum":"  196","line":"            const core_import_symbol = Symbol.init(","class":"lineCov","hits":"1","order":"4411","possible_hits":"1",},
{"lineNum":"  197","line":"                file_root,"},
{"lineNum":"  198","line":"                \"core\","},
{"lineNum":"  199","line":"                ast_.AST.create_module(","class":"lineCov","hits":"1","order":"4408","possible_hits":"1",},
{"lineNum":"  200","line":"                    Token.init_simple(\"core\"),","class":"lineCov","hits":"1","order":"4405","possible_hits":"1",},
{"lineNum":"  201","line":"                    compiler.core.?,","class":"lineCov","hits":"2","order":"4406","possible_hits":"2",},
{"lineNum":"  202","line":"                    module,"},
{"lineNum":"  203","line":"                    compiler.allocator(),","class":"lineCov","hits":"1","order":"4407","possible_hits":"1",},
{"lineNum":"  204","line":"                ),"},
{"lineNum":"  205","line":"                .{ .import = .{ .real_name = \"core\", .real_symbol = compiler.modules.get(compiler.core.?.module.?.absolute_path).? } },","class":"lineCov","hits":"3","order":"4409","possible_hits":"3",},
{"lineNum":"  206","line":"                .local,"},
{"lineNum":"  207","line":"                compiler.allocator(),","class":"lineCov","hits":"1","order":"4410","possible_hits":"1",},
{"lineNum":"  208","line":"            );"},
{"lineNum":"  209","line":"            try file_root.put_symbol(core_import_symbol, &compiler.errors);","class":"linePartCov","hits":"2","order":"484","possible_hits":"3",},
{"lineNum":"  210","line":"        }"},
{"lineNum":"  211","line":""},
{"lineNum":"  212","line":"        // Setup and run the front-end pipeline"},
{"lineNum":"  213","line":"        _ = try pipeline_.run(contents, .{","class":"lineCov","hits":"2","order":"527","possible_hits":"2",},
{"lineNum":"  214","line":"            Hash.init(&module.hash),","class":"lineCov","hits":"1","order":"485","possible_hits":"1",},
{"lineNum":"  215","line":"            Split_Lines.init(&compiler.errors, compiler.allocator()),","class":"lineCov","hits":"1","order":"488","possible_hits":"1",},
{"lineNum":"  216","line":"            Tokenize.init(in_name, &compiler.errors, fuzz_tokens, compiler.allocator()),","class":"lineCov","hits":"1","order":"492","possible_hits":"1",},
{"lineNum":"  217","line":"            Apply_Layout.init(),","class":"lineCov","hits":"1","order":"497","possible_hits":"1",},
{"lineNum":"  218","line":"            Parse.init(&compiler.errors, compiler.allocator()),","class":"lineCov","hits":"1","order":"500","possible_hits":"1",},
{"lineNum":"  219","line":"            Apply_Ast_Walk(Expand).init(Expand.new(&compiler.errors, compiler.allocator())),","class":"lineCov","hits":"1","order":"503","possible_hits":"1",},
{"lineNum":"  220","line":"            Apply_Flat_Ast_Walk(Import).init(Import.new(compiler, module.get_package_abs_path(), &module.local_imported_modules)),","class":"lineCov","hits":"1","order":"508","possible_hits":"1",},
{"lineNum":"  221","line":"            Apply_Flat_Ast_Walk(Cinclude).init(Cinclude.new(&module.cincludes)),","class":"lineCov","hits":"1","order":"515","possible_hits":"1",},
{"lineNum":"  222","line":"            Apply_Ast_Walk(Symbol_Tree).init(Symbol_Tree.new(file_root, &compiler.errors, compiler.allocator())),","class":"lineCov","hits":"1","order":"518","possible_hits":"1",},
{"lineNum":"  223","line":"            Apply_Ast_Walk(Decorate).init(Decorate.new(file_root, compiler)),","class":"lineCov","hits":"1","order":"521","possible_hits":"1",},
{"lineNum":"  224","line":"            Apply_Ast_Walk(Type_Decorate).init(Type_Decorate.new(compiler)),","class":"lineCov","hits":"1","order":"524","possible_hits":"1",},
{"lineNum":"  225","line":"        });"},
{"lineNum":"  226","line":""},
{"lineNum":"  227","line":"        // Perform checks and collections on the module"},
{"lineNum":"  228","line":"        try compiler.validate_module.validate_module(module);","class":"lineCov","hits":"1","order":"2050","possible_hits":"1",},
{"lineNum":"  229","line":"        compiler.module_scope(module.absolute_path).?.collect_traits_and_impls(&module.traits, &module.impls);","class":"lineCov","hits":"2","order":"3545","possible_hits":"2",},
{"lineNum":"  230","line":"        try module.add_all_cfgs(entry_name, compiler);","class":"lineCov","hits":"2","order":"3552","possible_hits":"2",},
{"lineNum":"  231","line":"        if (module.entry) |entry| {","class":"linePartCov","hits":"1","order":"3563","possible_hits":"2",},
{"lineNum":"  232","line":"            entry.assert_needed_at_runtime();","class":"linePartCov","hits":"1","order":"3564","possible_hits":"2",},
{"lineNum":"  233","line":"        }"},
{"lineNum":"  234","line":"        try module.collect_impls_cfgs(compiler);","class":"linePartCov","hits":"1","order":"3565","possible_hits":"2",},
{"lineNum":"  235","line":"        try module.collect_tests(compiler);","class":"lineCov","hits":"1","order":"4110","possible_hits":"1",},
{"lineNum":"  236","line":"        module.collect_local_types();","class":"lineCov","hits":"1","order":"4121","possible_hits":"1",},
{"lineNum":"  237","line":"    }"},
{"lineNum":"  238","line":""},
{"lineNum":"  239","line":"    fn add_all_cfgs(self: *Module, entry_name: ?[]const u8, compiler: *Compiler_Context) Module_Errors!void {","class":"lineCov","hits":"2","order":"3553","possible_hits":"2",},
{"lineNum":"  240","line":"        var found_entry = false;","class":"lineCov","hits":"1","order":"3554","possible_hits":"1",},
{"lineNum":"  241","line":"        const need_entry = entry_name != null;","class":"lineCov","hits":"1","order":"3555","possible_hits":"1",},
{"lineNum":"  242","line":"        for (compiler.module_scope(self.absolute_path).?.symbols.keys()) |key| {","class":"lineCov","hits":"3","order":"3556","possible_hits":"3",},
{"lineNum":"  243","line":"            const symbol: *Symbol = compiler.module_scope(self.absolute_path).?.symbols.get(key).?;","class":"lineCov","hits":"3","order":"3557","possible_hits":"3",},
{"lineNum":"  244","line":"            if (symbol.kind != .@\"fn\") {","class":"lineCov","hits":"1","order":"3558","possible_hits":"1",},
{"lineNum":"  245","line":"                continue;","class":"lineCov","hits":"2","order":"3559","possible_hits":"2",},
{"lineNum":"  246","line":"            }"},
{"lineNum":"  247","line":"            if (symbol.decl.?.num_generic_params() > 0) {","class":"lineCov","hits":"2","order":"4735","possible_hits":"2",},
{"lineNum":"  248","line":"                continue;","class":"linePartCov","hits":"1","order":"4736","possible_hits":"2",},
{"lineNum":"  249","line":"            }"},
{"lineNum":"  250","line":""},
{"lineNum":"  251","line":"            // Instruction translation"},
{"lineNum":"  252","line":"            const interned_strings = compiler.lookup_interned_string_set(self.uid).?;","class":"lineCov","hits":"3","order":"4737","possible_hits":"3",},
{"lineNum":"  253","line":"            const cfg = try compiler.cfg_store.get_cfg(symbol, interned_strings);","class":"lineCov","hits":"2","order":"4738","possible_hits":"2",},
{"lineNum":"  254","line":"            self.collect_cfgs(cfg);","class":"lineCov","hits":"1","order":"5044","possible_hits":"1",},
{"lineNum":"  255","line":""},
{"lineNum":"  256","line":"            if (need_entry and std.mem.eql(u8, key, entry_name.?)) {","class":"lineCov","hits":"2","order":"5045","possible_hits":"2",},
{"lineNum":"  257","line":"                self.entry = cfg;","class":"lineCov","hits":"1","order":"5046","possible_hits":"1",},
{"lineNum":"  258","line":"                found_entry = true;","class":"lineCov","hits":"1","order":"5047","possible_hits":"1",},
{"lineNum":"  259","line":""},
{"lineNum":"  260","line":"                // Check for entry context requirements"},
{"lineNum":"  261","line":"                for (cfg.symbol.type().function.contexts.items) |ctx| {","class":"lineCov","hits":"4","order":"5048","possible_hits":"4",},
{"lineNum":"  262","line":"                    if (!ctx.child().types_match(compiler.get_core_type(\"Allocating\"))) {","class":"lineCov","hits":"1","order":"5049","possible_hits":"1",},
{"lineNum":"  263","line":"                        compiler.errors.add_error(errs_.Error{ .basic = .{","class":"lineCov","hits":"2","order":"5055","possible_hits":"2",},
{"lineNum":"  264","line":"                            .span = ctx.token().span,","class":"lineCov","hits":"1","order":"5056","possible_hits":"1",},
{"lineNum":"  265","line":"                            .msg = \"entry point can\'t request this context\","},
{"lineNum":"  266","line":"                        } });"},
{"lineNum":"  267","line":"                        return error.CompileError;","class":"lineCov","hits":"1","order":"5057","possible_hits":"1",},
{"lineNum":"  268","line":"                    }"},
{"lineNum":"  269","line":"                }","class":"lineNoCov","hits":"0","possible_hits":"5",},
{"lineNum":"  270","line":"            }"},
{"lineNum":"  271","line":"        }","class":"linePartCov","hits":"2","order":"3560","possible_hits":"3",},
{"lineNum":"  272","line":"        if (need_entry and !found_entry) {","class":"lineCov","hits":"2","order":"3561","possible_hits":"2",},
{"lineNum":"  273","line":"            compiler.errors.add_error(errs_.Error{ .basic = .{","class":"lineCov","hits":"1","order":"5705","possible_hits":"1",},
{"lineNum":"  274","line":"                .span = Span.phony,"},
{"lineNum":"  275","line":"                .msg = \"no main function found\","},
{"lineNum":"  276","line":"            } });"},
{"lineNum":"  277","line":"            // Cannot find main function, fatal, do not procede"},
{"lineNum":"  278","line":"            return error.CompileError;","class":"lineCov","hits":"2","order":"3562","possible_hits":"2",},
{"lineNum":"  279","line":"        }"},
{"lineNum":"  280","line":"    }"},
{"lineNum":"  281","line":""},
{"lineNum":"  282","line":"    /// This allows us to pick up anon and inner CFGs that wouldn\'t be exposed to the module\'s scope"},
{"lineNum":"  283","line":"    fn collect_cfgs(self: *Module, cfg: *CFG) void {","class":"lineCov","hits":"2","order":"3696","possible_hits":"2",},
{"lineNum":"  284","line":"        var cfg_dfs_iter = Cfg_Iterator.init(cfg, self.allocator);","class":"lineCov","hits":"1","order":"3697","possible_hits":"1",},
{"lineNum":"  285","line":"        while (cfg_dfs_iter.next()) |next_cfg| {","class":"lineCov","hits":"2","order":"3702","possible_hits":"2",},
{"lineNum":"  286","line":"            if (next_cfg.symbol.decl.?.* == .method_decl and next_cfg.symbol.decl.?.method_decl.impl.?.num_generic_params() > 0) {","class":"lineCov","hits":"2","order":"3716","possible_hits":"2",},
{"lineNum":"  287","line":"                continue;","class":"linePartCov","hits":"1","order":"3718","possible_hits":"2",},
{"lineNum":"  288","line":"            }"},
{"lineNum":"  289","line":"            next_cfg.collect_generated_symbvers();","class":"lineCov","hits":"1","order":"3719","possible_hits":"1",},
{"lineNum":"  290","line":"            _ = next_cfg.emplace_cfg(self.uid, &self.cfgs, &self.instructions);","class":"lineCov","hits":"1","order":"3721","possible_hits":"1",},
{"lineNum":"  291","line":"        }","class":"lineCov","hits":"5","order":"3735","possible_hits":"5",},
{"lineNum":"  292","line":"    }"},
{"lineNum":"  293","line":""},
{"lineNum":"  294","line":"    fn collect_local_types(self: *Module) void {","class":"lineCov","hits":"2","order":"4122","possible_hits":"2",},
{"lineNum":"  295","line":"        for (self.traits.items) |trait| {","class":"lineCov","hits":"3","order":"4123","possible_hits":"3",},
{"lineNum":"  296","line":"            for (trait.trait.method_decls.items) |decl| {","class":"lineCov","hits":"4","order":"4124","possible_hits":"4",},
{"lineNum":"  297","line":"                const @\"type\" = decl.method_decl.c_type.?.expand_identifier();","class":"lineCov","hits":"3","order":"4125","possible_hits":"3",},
{"lineNum":"  298","line":"                if (@\"type\".refers_to_self()) continue;","class":"linePartCov","hits":"1","order":"4126","possible_hits":"2",},
{"lineNum":"  299","line":"                _ = self.type_set.add_type(decl.method_decl.c_type.?.expand_identifier());","class":"lineCov","hits":"3","order":"4127","possible_hits":"3",},
{"lineNum":"  300","line":"                _ = self.type_set.add_type(decl.method_decl.ret_type.expand_identifier());","class":"lineCov","hits":"3","order":"4179","possible_hits":"3",},
{"lineNum":"  301","line":"            }","class":"lineCov","hits":"3","order":"4193","possible_hits":"3",},
{"lineNum":"  302","line":"        }","class":"lineCov","hits":"4","order":"4198","possible_hits":"4",},
{"lineNum":"  303","line":"        for (self.cfgs.items) |cfg| {","class":"lineCov","hits":"3","order":"4202","possible_hits":"3",},
{"lineNum":"  304","line":"            cfg.collect_cfg_types(&self.type_set);","class":"lineCov","hits":"1","order":"4203","possible_hits":"1",},
{"lineNum":"  305","line":"        }","class":"lineCov","hits":"4","order":"4238","possible_hits":"4",},
{"lineNum":"  306","line":"    }"},
{"lineNum":"  307","line":""},
{"lineNum":"  308","line":"    /// Puts all the types used in this module into the given type set"},
{"lineNum":"  309","line":"    pub fn collect_module_types(self: *Module, type_set: *Type_Set) void {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  310","line":"        type_set.union_from(&self.type_set);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  311","line":"    }"},
{"lineNum":"  312","line":""},
{"lineNum":"  313","line":"    fn collect_impls_cfgs(self: *Module, compiler: *Compiler_Context) Module_Errors!void {","class":"lineCov","hits":"2","order":"3566","possible_hits":"2",},
{"lineNum":"  314","line":"        for (self.impls.items) |impl| {","class":"lineCov","hits":"3","order":"3567","possible_hits":"3",},
{"lineNum":"  315","line":"            if (impl.impl.instantiations.pairs.items.len == 0) {","class":"lineCov","hits":"2","order":"3568","possible_hits":"2",},
{"lineNum":"  316","line":"                try self.collect_impl_cfgs(impl, compiler);","class":"linePartCov","hits":"1","order":"3569","possible_hits":"3",},
{"lineNum":"  317","line":"            } else {"},
{"lineNum":"  318","line":"                for (impl.impl.instantiations.pairs.items) |pair| {","class":"lineNoCov","hits":"0","possible_hits":"4",},
{"lineNum":"  319","line":"                    try self.collect_impl_cfgs(pair.value, compiler);","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  320","line":"                }","class":"lineNoCov","hits":"0","possible_hits":"4",},
{"lineNum":"  321","line":"            }"},
{"lineNum":"  322","line":"        }","class":"lineCov","hits":"4","order":"4109","possible_hits":"4",},
{"lineNum":"  323","line":"    }"},
{"lineNum":"  324","line":""},
{"lineNum":"  325","line":"    fn collect_impl_cfgs(self: *Module, impl: *ast_.AST, compiler: *Compiler_Context) Module_Errors!void {","class":"lineCov","hits":"2","order":"3570","possible_hits":"2",},
{"lineNum":"  326","line":"        for (impl.impl.method_defs.items) |def| {","class":"lineCov","hits":"3","order":"3571","possible_hits":"3",},
{"lineNum":"  327","line":"            const symbol = def.symbol().?;","class":"lineCov","hits":"3","order":"3572","possible_hits":"3",},
{"lineNum":"  328","line":"            const interned_strings = compiler.lookup_interned_string_set(self.uid).?;","class":"lineCov","hits":"3","order":"3573","possible_hits":"3",},
{"lineNum":"  329","line":"            const cfg = try compiler.cfg_store.get_cfg(symbol, interned_strings);","class":"linePartCov","hits":"1","order":"3574","possible_hits":"2",},
{"lineNum":"  330","line":"            cfg.assert_needed_at_runtime();","class":"lineCov","hits":"1","order":"3689","possible_hits":"1",},
{"lineNum":"  331","line":"            self.collect_cfgs(cfg);","class":"lineCov","hits":"1","order":"3695","possible_hits":"1",},
{"lineNum":"  332","line":"        }","class":"lineCov","hits":"4","order":"3736","possible_hits":"4",},
{"lineNum":"  333","line":"    }"},
{"lineNum":"  334","line":""},
{"lineNum":"  335","line":"    fn collect_tests(self: *Module, compiler: *Compiler_Context) Module_Errors!void {","class":"lineCov","hits":"2","order":"4111","possible_hits":"2",},
{"lineNum":"  336","line":"        var test_asts = std.array_list.Managed(*ast_.AST).init(compiler.allocator());","class":"lineCov","hits":"1","order":"4112","possible_hits":"1",},
{"lineNum":"  337","line":"        compiler.module_scope(self.absolute_path).?.collect_tests(&test_asts);","class":"lineCov","hits":"2","order":"4113","possible_hits":"2",},
{"lineNum":"  338","line":""},
{"lineNum":"  339","line":"        for (test_asts.items) |test_ast| {","class":"linePartCov","hits":"2","order":"4119","possible_hits":"3",},
{"lineNum":"  340","line":"            const symbol = test_ast.symbol().?;","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  341","line":"            const interned_strings = compiler.lookup_interned_string_set(self.uid).?;","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  342","line":"            const cfg = try compiler.cfg_store.get_cfg(symbol, interned_strings);","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  343","line":"            self.tests.append(cfg) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  344","line":"            cfg.assert_needed_at_runtime();","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  345","line":"            self.collect_cfgs(cfg);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  346","line":"        }","class":"linePartCov","hits":"2","order":"4120","possible_hits":"4",},
{"lineNum":"  347","line":"    }"},
{"lineNum":"  348","line":""},
{"lineNum":"  349","line":"    pub fn get_package_abs_path(self: *Module) []const u8 {","class":"lineCov","hits":"2","order":"509","possible_hits":"2",},
{"lineNum":"  350","line":"        return std.fs.path.dirname(self.absolute_path).?;","class":"lineCov","hits":"1","order":"510","possible_hits":"1",},
{"lineNum":"  351","line":"    }"},
{"lineNum":"  352","line":""},
{"lineNum":"  353","line":"    pub fn pop_cfg(self: *Module, idx: i64) void {","class":"lineCov","hits":"2","order":"3187","possible_hits":"2",},
{"lineNum":"  354","line":"        _ = self.cfgs.orderedRemove(@as(usize, @intCast(idx)));","class":"lineCov","hits":"1","order":"3188","possible_hits":"1",},
{"lineNum":"  355","line":"    }"},
{"lineNum":"  356","line":""},
{"lineNum":"  357","line":"    pub fn get_adjacent(self: *Module) []*Module {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  358","line":"        return self.local_imported_modules.keys();","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  359","line":"    }"},
{"lineNum":"  360","line":""},
{"lineNum":"  361","line":"    pub fn print_instructions(self: *Module) void {"},
{"lineNum":"  362","line":"        for (self.instructions.items) |instr| {"},
{"lineNum":"  363","line":"            std.debug.print(\"{}\", .{instr});"},
{"lineNum":"  364","line":"        }"},
{"lineNum":"  365","line":"    }"},
{"lineNum":"  366","line":""},
{"lineNum":"  367","line":"    /// A module is modified if:"},
{"lineNum":"  368","line":"    /// - Its source hash differs from what is stored in the package\'s json file"},
{"lineNum":"  369","line":"    /// - Any of the module it imports have been modified"},
{"lineNum":"  370","line":"    pub fn determine_if_module_modified(self: *Module, compiler: *Compiler_Context) void {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  371","line":"        if (self.modified != null) {","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  372","line":"            return;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  373","line":"        }"},
{"lineNum":"  374","line":""},
{"lineNum":"  375","line":"        const package_abs_path = self.get_package_abs_path();","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  376","line":"        const module_hashes = compiler.lookup_package(package_abs_path).?.module_hash;","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  377","line":"        const old_hash = module_hashes.get_module_stored_hash(self.name());","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  378","line":"        const local_module_number_string = std.fmt.allocPrint(compiler.allocator(), \"{X}\", .{self.hash}) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  379","line":"        defer compiler.allocator().free(local_module_number_string);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  380","line":"        self.modified = (old_hash == null) or !std.mem.eql(u8, local_module_number_string, old_hash.?);","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  381","line":""},
{"lineNum":"  382","line":"        for (self.local_imported_modules.keys()) |imported_module| {","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  383","line":"            imported_module.determine_if_module_modified(compiler);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  384","line":"            self.modified = imported_module.modified.? or self.modified.?;","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  385","line":"        }","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  386","line":"    }"},
{"lineNum":"  387","line":""},
{"lineNum":"  388","line":"    pub fn update_module_hash(self: *const Module, module_hash: *Module_Hash, allocator: std.mem.Allocator) void {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  389","line":"        const local_module_number_string = std.fmt.allocPrint(allocator, \"{X}\", .{self.hash}) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  390","line":"        module_hash.set_module_hash(self.name(), local_module_number_string, allocator);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  391","line":"    }"},
{"lineNum":"  392","line":"};"},
]};
var percent_low = 25;var percent_high = 75;
var header = { "command" : "orng-test", "date" : "2025-11-10 15:43:08", "instrumented" : 176, "covered" : 145,};
var merged_data = [];
