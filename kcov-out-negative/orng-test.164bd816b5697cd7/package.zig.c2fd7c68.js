var data = {lines:[
{"lineNum":"    1","line":"const std = @import(\"std\");"},
{"lineNum":"    2","line":"const Module = @import(\"../hierarchy/module.zig\").Module;"},
{"lineNum":"    3","line":"const CFG = @import(\"../ir/cfg.zig\");"},
{"lineNum":"    4","line":"const Compiler_Context = @import(\"compiler.zig\");"},
{"lineNum":"    5","line":"const Symbol = @import(\"../symbol/symbol.zig\");"},
{"lineNum":"    6","line":"const Module_Hash = @import(\"module_hash.zig\");"},
{"lineNum":"    7","line":"const Type_Set = @import(\"../ast/type-set.zig\");"},
{"lineNum":"    8","line":""},
{"lineNum":"    9","line":"const Package = @This();"},
{"lineNum":"   10","line":""},
{"lineNum":"   11","line":"name: []const u8,"},
{"lineNum":"   12","line":"absolute_path: []const u8,"},
{"lineNum":"   13","line":"output_absolute_path: []const u8,"},
{"lineNum":"   14","line":"root: *Symbol,"},
{"lineNum":"   15","line":"local_modules: std.array_list.Managed(*Module),"},
{"lineNum":"   16","line":"/// Maps the names of required packages, relative to this package, to the symbol of their root module"},
{"lineNum":"   17","line":"requirements: std.StringArrayHashMap(*Symbol),"},
{"lineNum":"   18","line":"include_directories: std.StringArrayHashMap(void),"},
{"lineNum":"   19","line":"library_directories: std.StringArrayHashMap(void),"},
{"lineNum":"   20","line":"libraries: std.StringArrayHashMap(void),"},
{"lineNum":"   21","line":"kind: Package_Kind,"},
{"lineNum":"   22","line":"visited: bool,"},
{"lineNum":"   23","line":"module_hash: Module_Hash,"},
{"lineNum":"   24","line":"/// The C-equivalence type-closure for this package, built from the types used in all the package\'s modules"},
{"lineNum":"   25","line":"type_set: Type_Set,"},
{"lineNum":"   26","line":"modified: ?bool,"},
{"lineNum":"   27","line":""},
{"lineNum":"   28","line":"pub const Package_Kind = enum {"},
{"lineNum":"   29","line":"    executable,"},
{"lineNum":"   30","line":"    static_library,"},
{"lineNum":"   31","line":"    shared_library,"},
{"lineNum":"   32","line":"    test_executable,"},
{"lineNum":"   33","line":"};"},
{"lineNum":"   34","line":""},
{"lineNum":"   35","line":"pub const Package_Iterator_Node = struct {"},
{"lineNum":"   36","line":"    compiler: *Compiler_Context,"},
{"lineNum":"   37","line":"    package: *Package,"},
{"lineNum":"   38","line":""},
{"lineNum":"   39","line":"    pub fn init(compiler: *Compiler_Context, package_abs_path: []const u8) Package_Iterator_Node {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"   40","line":"        const package = compiler.lookup_package(package_abs_path).?;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"   41","line":"        return Package_Iterator_Node{ .compiler = compiler, .package = package };","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"   42","line":"    }"},
{"lineNum":"   43","line":""},
{"lineNum":"   44","line":"    pub fn get_adjacent(self: *Package_Iterator_Node) []Package_Iterator_Node {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"   45","line":"        var list = std.array_list.Managed(Package_Iterator_Node).init(self.compiler.allocator());","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"   46","line":""},
{"lineNum":"   47","line":"        for (self.package.requirements.keys()) |requirement_name| {","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"   48","line":"            const requirement_root_module_symbol = self.package.requirements.get(requirement_name);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"   49","line":"            const requirement_root_module = requirement_root_module_symbol.?.init_value().?.module.module;","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"   50","line":"            const requirement_root_abs_path = requirement_root_module.get_package_abs_path();","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"   51","line":"            list.append(Package_Iterator_Node.init(self.compiler, requirement_root_abs_path)) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"   52","line":"        }","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"   53","line":""},
{"lineNum":"   54","line":"        return list.toOwnedSlice() catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"   55","line":"    }"},
{"lineNum":"   56","line":""},
{"lineNum":"   57","line":"    pub fn free_adjacent(self: *Package_Iterator_Node, adj: []Package_Iterator_Node) void {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"   58","line":"        self.compiler.allocator().free(adj);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"   59","line":"    }"},
{"lineNum":"   60","line":"};"},
{"lineNum":"   61","line":""},
{"lineNum":"   62","line":"pub fn new(allocator: std.mem.Allocator, package_absolute_path: []const u8, kind: Package_Kind) *Package {","class":"lineCov","hits":"2","order":"4259","possible_hits":"2",},
{"lineNum":"   63","line":"    const package = allocator.create(Package) catch unreachable;","class":"lineCov","hits":"2","order":"4260","possible_hits":"2",},
{"lineNum":"   64","line":"    package.root = undefined; // filled in later","class":"lineCov","hits":"1","order":"4261","possible_hits":"1",},
{"lineNum":"   65","line":"    package.output_absolute_path = undefined; // filled in when the output binary is created","class":"lineCov","hits":"1","order":"4262","possible_hits":"1",},
{"lineNum":"   66","line":"    package.requirements = std.StringArrayHashMap(*Symbol).init(allocator);","class":"lineCov","hits":"1","order":"4263","possible_hits":"1",},
{"lineNum":"   67","line":"    package.include_directories = std.StringArrayHashMap(void).init(allocator);","class":"lineCov","hits":"1","order":"4264","possible_hits":"1",},
{"lineNum":"   68","line":"    package.library_directories = std.StringArrayHashMap(void).init(allocator);","class":"lineCov","hits":"1","order":"4265","possible_hits":"1",},
{"lineNum":"   69","line":"    package.libraries = std.StringArrayHashMap(void).init(allocator);","class":"lineCov","hits":"1","order":"4266","possible_hits":"1",},
{"lineNum":"   70","line":"    package.local_modules = std.array_list.Managed(*Module).init(allocator);","class":"lineCov","hits":"1","order":"4267","possible_hits":"1",},
{"lineNum":"   71","line":"    package.visited = false;","class":"lineCov","hits":"1","order":"4268","possible_hits":"1",},
{"lineNum":"   72","line":"    package.name = std.fs.path.basename(package_absolute_path);","class":"lineCov","hits":"1","order":"4269","possible_hits":"1",},
{"lineNum":"   73","line":"    package.absolute_path = package_absolute_path;","class":"lineCov","hits":"1","order":"4270","possible_hits":"1",},
{"lineNum":"   74","line":"    package.kind = kind;","class":"lineCov","hits":"1","order":"4271","possible_hits":"1",},
{"lineNum":"   75","line":"    package.module_hash = Module_Hash.init(package_absolute_path, allocator) catch unreachable;","class":"lineCov","hits":"3","order":"4272","possible_hits":"3",},
{"lineNum":"   76","line":"    package.type_set = Type_Set.init(allocator);","class":"lineCov","hits":"1","order":"4281","possible_hits":"1",},
{"lineNum":"   77","line":"    package.modified = null;","class":"lineCov","hits":"1","order":"4282","possible_hits":"1",},
{"lineNum":"   78","line":""},
{"lineNum":"   79","line":"    package.set_executable_name(allocator) catch unreachable;","class":"lineCov","hits":"2","order":"4283","possible_hits":"2",},
{"lineNum":"   80","line":""},
{"lineNum":"   81","line":"    return package;","class":"lineCov","hits":"1","order":"4292","possible_hits":"1",},
{"lineNum":"   82","line":"}"},
{"lineNum":"   83","line":""},
{"lineNum":"   84","line":"pub fn get_build_path(self: *const Package, allocator: std.mem.Allocator) []const u8 {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"   85","line":"    const package_root_module = self.root.init_value().?.module.module;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"   86","line":"    const package_path = package_root_module.get_package_abs_path();","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"   87","line":"    const build_paths = [_][]const u8{ package_path, \"build\" };","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"   88","line":"    return std.fs.path.join(allocator, &build_paths) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"   89","line":"}"},
{"lineNum":"   90","line":""},
{"lineNum":"   91","line":"pub fn get_types_path(self: *const Package, allocator: std.mem.Allocator) []const u8 {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"   92","line":"    const package_root_module = self.root.init_value().?.module.module;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"   93","line":"    const package_path = package_root_module.get_package_abs_path();","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"   94","line":"    const types_paths = [_][]const u8{ package_path, \"build\", \"types\" };","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"   95","line":"    return std.fs.path.join(allocator, &types_paths) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"   96","line":"}"},
{"lineNum":"   97","line":""},
{"lineNum":"   98","line":"pub fn get_build_module_absolute_path(self: *const Package, allocator: std.mem.Allocator) []const u8 {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"   99","line":"    const package_root_module = self.root.init_value().?.module.module;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  100","line":"    const package_path = package_root_module.get_package_abs_path();","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  101","line":"    const build_paths = [_][]const u8{ package_path, \"build.orng\" };","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  102","line":"    return std.fs.path.join(allocator, &build_paths) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  103","line":"}"},
{"lineNum":"  104","line":""},
{"lineNum":"  105","line":"pub fn entry(self: *const Package) ?*CFG {"},
{"lineNum":"  106","line":"    return self.root.init_value().?.module.module.entry;"},
{"lineNum":"  107","line":"}"},
{"lineNum":"  108","line":""},
{"lineNum":"  109","line":"pub fn get_build_module(self: *const Package, compiler: *Compiler_Context) ?*Module {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  110","line":"    const build_module_absolute_path: []const u8 = self.get_build_module_absolute_path(compiler.allocator());","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  111","line":"    const build_module_symbol: *Symbol = compiler.lookup_module(build_module_absolute_path) orelse return null;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  112","line":"    return build_module_symbol.init_value().?.module.module;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  113","line":"}"},
{"lineNum":"  114","line":""},
{"lineNum":"  115","line":"fn get_required_package(self: *Package, requirement_name: []const u8, packages: std.StringArrayHashMap(*Package)) *Package {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  116","line":"    const requirement_root_module_symbol: ?*Symbol = self.requirements.get(requirement_name);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  117","line":"    const requirement_root_module: *Module = requirement_root_module_symbol.?.init_value().?.module.module;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  118","line":"    const requirement_root_abs_path: []const u8 = requirement_root_module.get_package_abs_path();","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  119","line":"    const required_package: *Package = packages.get(requirement_root_abs_path).?;","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  120","line":"    return required_package;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  121","line":"}"},
{"lineNum":"  122","line":""},
{"lineNum":"  123","line":"/// A package is modified if:"},
{"lineNum":"  124","line":"/// - Any of its modules are modified"},
{"lineNum":"  125","line":"/// - Any of its dependencies are modified"},
{"lineNum":"  126","line":"pub fn determine_if_package_modified(self: *Package, packages: std.StringArrayHashMap(*Package), compiler: *Compiler_Context) void {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  127","line":"    if (self.modified != null) {","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  128","line":"        return;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  129","line":"    }"},
{"lineNum":"  130","line":"    self.modified = false;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  131","line":""},
{"lineNum":"  132","line":"    // Check if any requirements are modified"},
{"lineNum":"  133","line":"    for (self.requirements.keys()) |requirement_name| {","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  134","line":"        const required_package = self.get_required_package(requirement_name, packages);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  135","line":"        required_package.determine_if_package_modified(packages, compiler);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  136","line":"        self.modified = required_package.modified.? or self.modified.?;","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  137","line":"    }","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  138","line":""},
{"lineNum":"  139","line":"    // Check if the build module was modified, if it was, entire package will be rebuilt"},
{"lineNum":"  140","line":"    if (self.get_build_module(compiler)) |build_module| {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  141","line":"        build_module.determine_if_module_modified(compiler);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  142","line":"        build_module.update_module_hash(&self.module_hash, compiler.allocator());","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  143","line":"        self.modified = build_module.modified.? or self.modified.?;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  144","line":"    }"},
{"lineNum":"  145","line":""},
{"lineNum":"  146","line":"    // Check if any modules are modified"},
{"lineNum":"  147","line":"    for (self.local_modules.items) |local_module| {","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  148","line":"        local_module.determine_if_module_modified(compiler);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  149","line":"        local_module.update_module_hash(&self.module_hash, compiler.allocator());","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  150","line":"        self.modified = local_module.modified.? or self.modified.?;","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  151","line":"    }","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  152","line":""},
{"lineNum":"  153","line":"    // Check if the output exists - if it doesn\'t, package is modified"},
{"lineNum":"  154","line":"    self.modified = !file_exists(self.output_absolute_path) or self.modified.?;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  155","line":"}"},
{"lineNum":"  156","line":""},
{"lineNum":"  157","line":"pub fn collect_package_types(self: *Package) void {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  158","line":"    for (self.local_modules.items) |module| {","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  159","line":"        module.collect_module_types(&self.type_set);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  160","line":"    }","class":"lineNoCov","hits":"0","possible_hits":"4",},
{"lineNum":"  161","line":"}"},
{"lineNum":"  162","line":""},
{"lineNum":"  163","line":"fn file_exists(abs_path: []const u8) bool {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  164","line":"    var file = std.fs.openFileAbsolute(abs_path, .{}) catch |err| switch (err) {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  165","line":"        error.FileNotFound => return false,","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  166","line":"        else => return false,","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  167","line":"    };"},
{"lineNum":"  168","line":"    defer file.close();","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  169","line":"    return true;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  170","line":"}"},
{"lineNum":"  171","line":""},
{"lineNum":"  172","line":"/// Compiles a package. Assumes C files have already been emitted."},
{"lineNum":"  173","line":"pub fn output(self: *Package, packages: std.StringArrayHashMap(*Package), allocator: std.mem.Allocator) !void {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  174","line":"    if (self.visited) {","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  175","line":"        return;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  176","line":"    }"},
{"lineNum":"  177","line":"    self.visited = true;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  178","line":""},
{"lineNum":"  179","line":"    for (self.requirements.keys()) |requirement_name| {","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  180","line":"        const required_package = self.get_required_package(requirement_name, packages);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  181","line":"        try required_package.output(packages, allocator);","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  182","line":"    }","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  183","line":""},
{"lineNum":"  184","line":"    const obj_files = try self.compile_obj_files(packages, allocator);","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  185","line":"    self.module_hash.output_new_json(allocator);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  186","line":""},
{"lineNum":"  187","line":"    if (self.modified.?) {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  188","line":"        if (self.kind == .static_library) {","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  189","line":"            try self.ar(obj_files, allocator);","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  190","line":"        } else {"},
{"lineNum":"  191","line":"            try self.link_executable(obj_files, packages, allocator);","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  192","line":"        }"},
{"lineNum":"  193","line":"    }"},
{"lineNum":"  194","line":"}"},
{"lineNum":"  195","line":""},
{"lineNum":"  196","line":"/// Compiles the C files to object files for this package\'s local modules and entry point"},
{"lineNum":"  197","line":"fn compile_obj_files(self: *Package, packages: std.StringArrayHashMap(*Package), allocator: std.mem.Allocator) !std.StringArrayHashMap(void) {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  198","line":"    var obj_files = std.StringArrayHashMap(void).init(allocator);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  199","line":""},
{"lineNum":"  200","line":"    try self.compile_local_modules(&obj_files, packages, allocator);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  201","line":"    try self.compile_entry_point(&obj_files, packages, allocator);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  202","line":""},
{"lineNum":"  203","line":"    return obj_files;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  204","line":"}"},
{"lineNum":"  205","line":""},
{"lineNum":"  206","line":"/// Compiles the C files to object files for this package\'s local modules"},
{"lineNum":"  207","line":"fn compile_local_modules(self: *Package, obj_files: *std.StringArrayHashMap(void), packages: std.StringArrayHashMap(*Package), allocator: std.mem.Allocator) !void {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  208","line":"    for (self.local_modules.items) |local_module| {","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  209","line":"        if (!std.mem.eql(u8, local_module.get_package_abs_path(), self.absolute_path)) {","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  210","line":"            continue;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  211","line":"        }"},
{"lineNum":"  212","line":""},
{"lineNum":"  213","line":"        const o_file = self.add_module_obj_files(obj_files, local_module, allocator);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  214","line":""},
{"lineNum":"  215","line":"        if (!local_module.modified.?) {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  216","line":"            // No need to re-compile!"},
{"lineNum":"  217","line":"            continue;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  218","line":"        }"},
{"lineNum":"  219","line":""},
{"lineNum":"  220","line":"        try self.compile_module_sources(o_file, packages, local_module, allocator);","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  221","line":"    }","class":"lineNoCov","hits":"0","possible_hits":"4",},
{"lineNum":"  222","line":"}"},
{"lineNum":"  223","line":""},
{"lineNum":"  224","line":"/// Appends the object files for a module to a set of object files"},
{"lineNum":"  225","line":"fn add_module_obj_files(self: *Package, obj_files: *std.StringArrayHashMap(void), local_module: *Module, allocator: std.mem.Allocator) std.array_list.Managed(u8) {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  226","line":"    // Append the o filename to the obj files list, even if this isn\'t compiled!"},
{"lineNum":"  227","line":"    var o_file = std.array_list.Managed(u8).init(allocator);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  228","line":"    o_file.print(\"{s}{c}build{c}{s}.o\", .{","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  229","line":"        self.absolute_path,","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  230","line":"        std.fs.path.sep,"},
{"lineNum":"  231","line":"        std.fs.path.sep,"},
{"lineNum":"  232","line":"        local_module.name(),","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  233","line":"    }) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  234","line":"    obj_files.put(o_file.items, void{}) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  235","line":"    local_module.modified = !file_exists(o_file.items) or local_module.modified.?;","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  236","line":""},
{"lineNum":"  237","line":"    if (self.kind == .test_executable) {","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  238","line":"        var test_o_file = std.array_list.Managed(u8).init(allocator);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  239","line":"        test_o_file.print(\"{s}{c}build{c}{s}-tests.o\", .{","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  240","line":"            self.absolute_path,","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  241","line":"            std.fs.path.sep,"},
{"lineNum":"  242","line":"            std.fs.path.sep,"},
{"lineNum":"  243","line":"            local_module.name(),","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  244","line":"        }) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  245","line":"        obj_files.put(test_o_file.items, void{}) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  246","line":"        local_module.modified = !file_exists(test_o_file.items) or local_module.modified.?;","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  247","line":"    }"},
{"lineNum":"  248","line":"    return o_file;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  249","line":"}"},
{"lineNum":"  250","line":""},
{"lineNum":"  251","line":"/// Compiles the sources for a module"},
{"lineNum":"  252","line":"fn compile_module_sources(self: *Package, o_file: std.array_list.Managed(u8), packages: std.StringArrayHashMap(*Package), local_module: *Module, allocator: std.mem.Allocator) !void {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  253","line":"    var c_file = std.array_list.Managed(u8).init(allocator);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  254","line":"    defer c_file.deinit();","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  255","line":"    c_file.print(\"{s}{c}build{c}{s}-{s}.c\", .{","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  256","line":"        self.absolute_path,","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  257","line":"        std.fs.path.sep,"},
{"lineNum":"  258","line":"        std.fs.path.sep,"},
{"lineNum":"  259","line":"        self.name,","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  260","line":"        local_module.name(),","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  261","line":"    }) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  262","line":"    try self.cc(c_file.items, o_file.items, packages, allocator);","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  263","line":""},
{"lineNum":"  264","line":"    if (self.kind == .test_executable) {","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  265","line":"        var test_c_file = std.array_list.Managed(u8).init(allocator);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  266","line":"        test_c_file.print(\"{s}{c}build{c}{s}-{s}-tests.c\", .{","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  267","line":"            self.absolute_path,","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  268","line":"            std.fs.path.sep,"},
{"lineNum":"  269","line":"            std.fs.path.sep,"},
{"lineNum":"  270","line":"            self.name,","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  271","line":"            local_module.name(),","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  272","line":"        }) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  273","line":""},
{"lineNum":"  274","line":"        var test_o_file = std.array_list.Managed(u8).init(allocator);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  275","line":"        test_o_file.print(\"{s}-tests.o\", .{local_module.name()}) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  276","line":""},
{"lineNum":"  277","line":"        try self.cc(test_c_file.items, test_o_file.items, packages, allocator);","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  278","line":"    }"},
{"lineNum":"  279","line":"}"},
{"lineNum":"  280","line":""},
{"lineNum":"  281","line":"/// Compiles the C file for this package\'s entry point"},
{"lineNum":"  282","line":"fn compile_entry_point(self: *Package, obj_files: *std.StringArrayHashMap(void), packages: std.StringArrayHashMap(*Package), allocator: std.mem.Allocator) !void {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  283","line":"    if (!self.modified.?) {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  284","line":"        return;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  285","line":"    }"},
{"lineNum":"  286","line":""},
{"lineNum":"  287","line":"    switch (self.kind) {","class":"lineNoCov","hits":"0","possible_hits":"4",},
{"lineNum":"  288","line":"        .executable => try self.compile_executable_entry_point(obj_files, packages, allocator),","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  289","line":"        .test_executable => try self.compile_test_runner_entry_point(obj_files, packages, allocator),","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  290","line":"        else => {},"},
{"lineNum":"  291","line":"    }"},
{"lineNum":"  292","line":"}"},
{"lineNum":"  293","line":""},
{"lineNum":"  294","line":"/// Compiles the `start` C file to an object file"},
{"lineNum":"  295","line":"fn compile_executable_entry_point(self: *Package, obj_files: *std.StringArrayHashMap(void), packages: std.StringArrayHashMap(*Package), allocator: std.mem.Allocator) !void {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  296","line":"    var start_o_file = std.array_list.Managed(u8).init(allocator);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  297","line":"    start_o_file.print(\"{s}{c}build{c}start.o\", .{","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  298","line":"        self.absolute_path,","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  299","line":"        std.fs.path.sep,"},
{"lineNum":"  300","line":"        std.fs.path.sep,","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  301","line":"    }) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  302","line":"    obj_files.put(start_o_file.items, void{}) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  303","line":""},
{"lineNum":"  304","line":"    var c_file = std.array_list.Managed(u8).init(allocator);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  305","line":"    c_file.print(\"{s}{c}build{c}start.c\", .{","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  306","line":"        self.absolute_path,","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  307","line":"        std.fs.path.sep,"},
{"lineNum":"  308","line":"        std.fs.path.sep,","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  309","line":"    }) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  310","line":""},
{"lineNum":"  311","line":"    try self.cc(c_file.items, start_o_file.items, packages, allocator);","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  312","line":"}"},
{"lineNum":"  313","line":""},
{"lineNum":"  314","line":"/// Compiles the test-runner C file to an object file"},
{"lineNum":"  315","line":"fn compile_test_runner_entry_point(self: *Package, obj_files: *std.StringArrayHashMap(void), packages: std.StringArrayHashMap(*Package), allocator: std.mem.Allocator) !void {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  316","line":"    var test_runner_o_file = std.array_list.Managed(u8).init(allocator);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  317","line":"    test_runner_o_file.print(\"{s}{c}build{c}test-runner.o\", .{","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  318","line":"        self.absolute_path,","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  319","line":"        std.fs.path.sep,"},
{"lineNum":"  320","line":"        std.fs.path.sep,","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  321","line":"    }) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  322","line":"    obj_files.put(test_runner_o_file.items, void{}) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  323","line":""},
{"lineNum":"  324","line":"    var c_file = std.array_list.Managed(u8).init(allocator);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  325","line":"    c_file.print(\"{s}{c}build{c}test-runner.c\", .{","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  326","line":"        self.absolute_path,","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  327","line":"        std.fs.path.sep,"},
{"lineNum":"  328","line":"        std.fs.path.sep,","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  329","line":"    }) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  330","line":""},
{"lineNum":"  331","line":"    try self.cc(c_file.items, test_runner_o_file.items, packages, allocator);","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  332","line":"}"},
{"lineNum":"  333","line":""},
{"lineNum":"  334","line":"pub fn append_include_dir(self: *Package, packages: std.StringArrayHashMap(*Package), include_dirs: *std.StringArrayHashMap(void)) void {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  335","line":"    for (self.requirements.keys()) |requirement_name| {","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  336","line":"        const required_package = self.get_required_package(requirement_name, packages);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  337","line":"        required_package.append_include_dir(packages, &self.include_directories);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  338","line":"    }","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  339","line":"    for (self.include_directories.keys()) |dir| {","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  340","line":"        include_dirs.put(dir, void{}) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  341","line":"    }","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  342","line":"}"},
{"lineNum":"  343","line":""},
{"lineNum":"  344","line":"fn cc("},
{"lineNum":"  345","line":"    self: *Package,"},
{"lineNum":"  346","line":"    c_file: []const u8,"},
{"lineNum":"  347","line":"    o_file: []const u8,"},
{"lineNum":"  348","line":"    packages: std.StringArrayHashMap(*Package),"},
{"lineNum":"  349","line":"    allocator: std.mem.Allocator,"},
{"lineNum":"  350","line":") !void {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  351","line":"    const cc_cmd = try self.construct_obj_cc_cmd(c_file, o_file, packages, allocator);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  352","line":"    print_cmd(&cc_cmd);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  353","line":""},
{"lineNum":"  354","line":"    var cwd_string = std.array_list.Managed(u8).init(allocator);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  355","line":"    cwd_string.print(\"{s}{c}build\", .{ self.absolute_path, std.fs.path.sep }) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  356","line":""},
{"lineNum":"  357","line":"    const run_res = std.process.Child.run(.{","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  358","line":"        .allocator = allocator,"},
{"lineNum":"  359","line":"        .argv = cc_cmd.items,","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  360","line":"        .cwd = cwd_string.items,","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  361","line":"    }) catch |err| switch (err) {"},
{"lineNum":"  362","line":"        else => std.debug.panic(\"compile error: on cc invoke: {}\", .{err}),","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  363","line":"    };"},
{"lineNum":"  364","line":""},
{"lineNum":"  365","line":"    var retcode: u8 = 0;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  366","line":"    switch (run_res.term) {","class":"lineNoCov","hits":"0","possible_hits":"4",},
{"lineNum":"  367","line":"        .Exited => |c| {"},
{"lineNum":"  368","line":"            retcode = c;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  369","line":"        },"},
{"lineNum":"  370","line":"        .Signal => return error.CompileError,","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  371","line":"        else => {"},
{"lineNum":"  372","line":"            std.debug.print(\"{s}\\n\", .{run_res.stderr});","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  373","line":"            return error.CompileError;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  374","line":"        },"},
{"lineNum":"  375","line":"    }"},
{"lineNum":"  376","line":""},
{"lineNum":"  377","line":"    if (retcode != 0) {","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  378","line":"        std.debug.print(\"{s}\", .{run_res.stderr});","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  379","line":"        return error.CompileError;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  380","line":"    }"},
{"lineNum":"  381","line":"}"},
{"lineNum":"  382","line":""},
{"lineNum":"  383","line":"/// Constructs the command to call zig cc to compile a modules .o file"},
{"lineNum":"  384","line":"fn construct_obj_cc_cmd("},
{"lineNum":"  385","line":"    self: *Package,"},
{"lineNum":"  386","line":"    c_file: []const u8,"},
{"lineNum":"  387","line":"    o_file: []const u8,"},
{"lineNum":"  388","line":"    packages: std.StringArrayHashMap(*Package),"},
{"lineNum":"  389","line":"    allocator: std.mem.Allocator,"},
{"lineNum":"  390","line":") !std.array_list.Managed([]const u8) {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  391","line":"    var env_map = std.process.getEnvMap(allocator) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  392","line":"    defer env_map.deinit();","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  393","line":""},
{"lineNum":"  394","line":"    // Base cc command"},
{"lineNum":"  395","line":"    var cc_cmd = std.array_list.Managed([]const u8).init(allocator);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  396","line":"    cc_cmd.appendSlice(&[_][]const u8{ \"zig\", \"cc\" }) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  397","line":""},
{"lineNum":"  398","line":"    // Add input/output"},
{"lineNum":"  399","line":"    cc_cmd.append(\"-c\") catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  400","line":"    cc_cmd.append(c_file) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  401","line":""},
{"lineNum":"  402","line":"    cc_cmd.append(\"-o\") catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  403","line":"    cc_cmd.append(o_file) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  404","line":""},
{"lineNum":"  405","line":"    const std_path = env_map.get(\"ORNG_STD_PATH\").?;","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  406","line":"    var std_include_path = std.array_list.Managed(u8).init(allocator);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  407","line":"    std_include_path.print(\"-I{s}\", .{std_path}) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  408","line":""},
{"lineNum":"  409","line":"    // Add basic flags"},
{"lineNum":"  410","line":"    cc_cmd.appendSlice(&[_][]const u8{","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  411","line":"        \"-std=c11\","},
{"lineNum":"  412","line":"        \"-O3\","},
{"lineNum":"  413","line":"        \"-g\","},
{"lineNum":"  414","line":"        std_include_path.items,","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  415","line":"    }) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  416","line":""},
{"lineNum":"  417","line":"    if (true) {"},
{"lineNum":"  418","line":"        cc_cmd.appendSlice(&[_][]const u8{","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  419","line":"            // \"-Werror\", // TODO: Requires us to know when interned strings are unused"},
{"lineNum":"  420","line":"            \"-Wall\","},
{"lineNum":"  421","line":"            \"-Wextra\","},
{"lineNum":"  422","line":"            \"-Wpedantic\","},
{"lineNum":"  423","line":"            \"-pedantic-errors\","},
{"lineNum":"  424","line":"            \"-Wconversion\","},
{"lineNum":"  425","line":"            \"-Wsign-conversion\","},
{"lineNum":"  426","line":"            \"-Wfloat-conversion\","},
{"lineNum":"  427","line":"            \"-Wcast-qual\","},
{"lineNum":"  428","line":"            // \"-Wlogical-op\", // only GCC"},
{"lineNum":"  429","line":"            \"-Wshadow\","},
{"lineNum":"  430","line":"            \"-Wformat=2\","},
{"lineNum":"  431","line":"            \"-Wmisleading-indentation\","},
{"lineNum":"  432","line":"            \"-Wstrict-prototypes\","},
{"lineNum":"  433","line":"            \"-Wmissing-prototypes\","},
{"lineNum":"  434","line":"            \"-Winit-self\","},
{"lineNum":"  435","line":"            // \"-Wjump-misses-init\", // only GCC"},
{"lineNum":"  436","line":"            \"-Wdeclaration-after-statement\","},
{"lineNum":"  437","line":"            \"-Wbad-function-cast\","},
{"lineNum":"  438","line":"            // \"-Wc11-c2x-compat\", // For C11"},
{"lineNum":"  439","line":"            \"-Wcast-align\","},
{"lineNum":"  440","line":"            // \"-fsanitize=undefined,address\", // TODO: Needs some kind of linking"},
{"lineNum":"  441","line":"        }) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  442","line":"    }"},
{"lineNum":"  443","line":""},
{"lineNum":"  444","line":"    self.append_requirements_includes(&cc_cmd, packages, allocator);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  445","line":"    self.append_self_includes(&cc_cmd, allocator);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  446","line":""},
{"lineNum":"  447","line":"    return cc_cmd;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  448","line":"}"},
{"lineNum":"  449","line":""},
{"lineNum":"  450","line":"/// Appends the include directories of the packages that this packages requires to the cc command"},
{"lineNum":"  451","line":"fn append_requirements_includes("},
{"lineNum":"  452","line":"    self: *Package,"},
{"lineNum":"  453","line":"    cc_cmd: *std.array_list.Managed([]const u8),"},
{"lineNum":"  454","line":"    packages: std.StringArrayHashMap(*Package),"},
{"lineNum":"  455","line":"    allocator: std.mem.Allocator,"},
{"lineNum":"  456","line":") void {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  457","line":"    for (self.requirements.keys()) |requirement_name| {","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  458","line":"        const required_package = self.get_required_package(requirement_name, packages);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  459","line":""},
{"lineNum":"  460","line":"        var requirement_include_path = std.array_list.Managed(u8).init(allocator);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  461","line":"        requirement_include_path.print(\"-I{s}{c}build\", .{ required_package.root.init_value().?.module.module.get_package_abs_path(), std.fs.path.sep }) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  462","line":"        cc_cmd.append(requirement_include_path.items) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  463","line":"    }","class":"lineNoCov","hits":"0","possible_hits":"4",},
{"lineNum":"  464","line":"}"},
{"lineNum":"  465","line":""},
{"lineNum":"  466","line":"/// Appends the include directories that this package specified in `build.orng` to the cc command"},
{"lineNum":"  467","line":"fn append_self_includes("},
{"lineNum":"  468","line":"    self: *Package,"},
{"lineNum":"  469","line":"    cc_cmd: *std.array_list.Managed([]const u8),"},
{"lineNum":"  470","line":"    allocator: std.mem.Allocator,"},
{"lineNum":"  471","line":") void {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  472","line":"    for (self.include_directories.keys()) |include_dir| {","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  473","line":"        var requirement_include_path = std.array_list.Managed(u8).init(allocator);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  474","line":"        requirement_include_path.print(\"-I{s}\", .{include_dir}) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  475","line":"        cc_cmd.append(requirement_include_path.items) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  476","line":"    }","class":"lineNoCov","hits":"0","possible_hits":"4",},
{"lineNum":"  477","line":"}"},
{"lineNum":"  478","line":""},
{"lineNum":"  479","line":"fn ar(self: *Package, obj_files: std.StringArrayHashMap(void), allocator: std.mem.Allocator) !void {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  480","line":"    // Base command"},
{"lineNum":"  481","line":"    var cmd = std.array_list.Managed([]const u8).init(allocator);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  482","line":"    cmd.appendSlice(&[_][]const u8{","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  483","line":"        \"zig\","},
{"lineNum":"  484","line":"        \"ar\","},
{"lineNum":"  485","line":"        \"rcs\","},
{"lineNum":"  486","line":"    }) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  487","line":""},
{"lineNum":"  488","line":"    // Add the lib name"},
{"lineNum":"  489","line":"    cmd.append(self.output_absolute_path) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  490","line":""},
{"lineNum":"  491","line":"    // Add all the object files"},
{"lineNum":"  492","line":"    cmd.appendSlice(obj_files.keys()) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  493","line":""},
{"lineNum":"  494","line":"    // Set cwd"},
{"lineNum":"  495","line":"    var cwd_string = std.array_list.Managed(u8).init(allocator);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  496","line":"    cwd_string.print(\"{s}{c}build\", .{ self.absolute_path, std.fs.path.sep }) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  497","line":""},
{"lineNum":"  498","line":"    print_cmd(&cmd);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  499","line":"    const run_res = std.process.Child.run(.{","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  500","line":"        .allocator = allocator,"},
{"lineNum":"  501","line":"        .argv = cmd.items,","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  502","line":"        .cwd = cwd_string.items,","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  503","line":"    }) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  504","line":""},
{"lineNum":"  505","line":"    var retcode: u8 = 0;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  506","line":"    switch (run_res.term) {","class":"lineNoCov","hits":"0","possible_hits":"4",},
{"lineNum":"  507","line":"        .Exited => |c| {"},
{"lineNum":"  508","line":"            retcode = c;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  509","line":"        },"},
{"lineNum":"  510","line":"        .Signal => return error.CompileError,","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  511","line":"        else => {"},
{"lineNum":"  512","line":"            std.debug.print(\"{s}\\n\", .{run_res.stderr});","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  513","line":"            return error.CompileError;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  514","line":"        },"},
{"lineNum":"  515","line":"    }"},
{"lineNum":"  516","line":""},
{"lineNum":"  517","line":"    if (retcode != 0) {","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  518","line":"        std.debug.print(\"ar error: {s}\\n\", .{run_res.stderr});","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  519","line":"        return error.CompileError;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  520","line":"    }"},
{"lineNum":"  521","line":"}"},
{"lineNum":"  522","line":""},
{"lineNum":"  523","line":"pub fn set_executable_name(self: *Package, allocator: std.mem.Allocator) !void {","class":"lineCov","hits":"2","order":"4284","possible_hits":"2",},
{"lineNum":"  524","line":"    var output_absolute_path = std.array_list.Managed(u8).init(allocator);","class":"lineCov","hits":"1","order":"4285","possible_hits":"1",},
{"lineNum":"  525","line":"    output_absolute_path.print(\"{s}{c}build{c}\", .{","class":"lineCov","hits":"2","order":"4288","possible_hits":"2",},
{"lineNum":"  526","line":"        self.absolute_path,","class":"lineCov","hits":"1","order":"4286","possible_hits":"1",},
{"lineNum":"  527","line":"        std.fs.path.sep,"},
{"lineNum":"  528","line":"        std.fs.path.sep,","class":"lineCov","hits":"1","order":"4287","possible_hits":"1",},
{"lineNum":"  529","line":"    }) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  530","line":"    switch (self.kind) {","class":"linePartCov","hits":"1","order":"4289","possible_hits":"2",},
{"lineNum":"  531","line":"        .executable => try output_absolute_path.print(\"{s}\", .{self.name}),","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  532","line":"        .test_executable => try output_absolute_path.print(\"{s}-test\", .{self.name}),","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  533","line":"        .static_library => try output_absolute_path.print(\"lib{s}.a\", .{self.name}),","class":"linePartCov","hits":"1","order":"4290","possible_hits":"2",},
{"lineNum":"  534","line":"        .shared_library => try output_absolute_path.print(\"{s}.so\", .{self.name}),","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  535","line":"    }"},
{"lineNum":"  536","line":"    self.output_absolute_path = output_absolute_path.items;","class":"lineCov","hits":"1","order":"4291","possible_hits":"1",},
{"lineNum":"  537","line":"}"},
{"lineNum":"  538","line":""},
{"lineNum":"  539","line":"/// Runs the command to link the object files of a package into an executable"},
{"lineNum":"  540","line":"fn link_executable(self: *Package, obj_files: std.StringArrayHashMap(void), packages: std.StringArrayHashMap(*Package), allocator: std.mem.Allocator) !void {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  541","line":"    const cmd = try self.construct_exe_cc_cmd(obj_files, packages, allocator);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  542","line":""},
{"lineNum":"  543","line":"    // Set cwd"},
{"lineNum":"  544","line":"    var cwd_string = std.array_list.Managed(u8).init(allocator);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  545","line":"    cwd_string.print(\"{s}{c}build\", .{ self.absolute_path, std.fs.path.sep }) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  546","line":""},
{"lineNum":"  547","line":"    print_cmd(&cmd);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  548","line":"    const run_res = std.process.Child.run(.{","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  549","line":"        .allocator = allocator,"},
{"lineNum":"  550","line":"        .argv = cmd.items,","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  551","line":"        .cwd = cwd_string.items,","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  552","line":"    }) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  553","line":""},
{"lineNum":"  554","line":"    var retcode: u8 = 0;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  555","line":"    switch (run_res.term) {","class":"lineNoCov","hits":"0","possible_hits":"4",},
{"lineNum":"  556","line":"        .Exited => |c| {"},
{"lineNum":"  557","line":"            retcode = c;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  558","line":"        },"},
{"lineNum":"  559","line":"        else => {"},
{"lineNum":"  560","line":"            std.debug.panic(\"{s}\\n\", .{run_res.stderr});","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  561","line":"        },"},
{"lineNum":"  562","line":"    }"},
{"lineNum":"  563","line":""},
{"lineNum":"  564","line":"    if (retcode != 0) {","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  565","line":"        std.debug.panic(\"err:{s}\\n\", .{run_res.stderr});","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  566","line":"    }"},
{"lineNum":"  567","line":"}"},
{"lineNum":"  568","line":""},
{"lineNum":"  569","line":"/// Constructs the command to call zig cc to compile an executable from a list of object files"},
{"lineNum":"  570","line":"fn construct_exe_cc_cmd("},
{"lineNum":"  571","line":"    self: *Package,"},
{"lineNum":"  572","line":"    obj_files: std.StringArrayHashMap(void),"},
{"lineNum":"  573","line":"    packages: std.StringArrayHashMap(*Package),"},
{"lineNum":"  574","line":"    allocator: std.mem.Allocator,"},
{"lineNum":"  575","line":") !std.array_list.Managed([]const u8) {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  576","line":"    var env_map = std.process.getEnvMap(allocator) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  577","line":"    defer env_map.deinit();","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  578","line":""},
{"lineNum":"  579","line":"    // Base command"},
{"lineNum":"  580","line":"    var cmd = std.array_list.Managed([]const u8).init(allocator);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  581","line":"    cmd.appendSlice(&[_][]const u8{ \"zig\", \"cc\" }) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  582","line":""},
{"lineNum":"  583","line":"    // Add all the object files"},
{"lineNum":"  584","line":"    cmd.appendSlice(obj_files.keys()) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  585","line":""},
{"lineNum":"  586","line":"    for (self.requirements.keys()) |requirement_name| {","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  587","line":"        self.append_requirement_link(&cmd, packages, requirement_name, allocator);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  588","line":"    }","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  589","line":""},
{"lineNum":"  590","line":"    // Add the output name"},
{"lineNum":"  591","line":"    cmd.append(\"-o\") catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  592","line":"    cmd.append(self.output_absolute_path) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  593","line":""},
{"lineNum":"  594","line":"    return cmd;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  595","line":"}"},
{"lineNum":"  596","line":""},
{"lineNum":"  597","line":"/// Appends the flags to link against a required package"},
{"lineNum":"  598","line":"fn append_requirement_link("},
{"lineNum":"  599","line":"    self: *Package,"},
{"lineNum":"  600","line":"    cmd: *std.array_list.Managed([]const u8),"},
{"lineNum":"  601","line":"    packages: std.StringArrayHashMap(*Package),"},
{"lineNum":"  602","line":"    requirement_name: []const u8,"},
{"lineNum":"  603","line":"    allocator: std.mem.Allocator,"},
{"lineNum":"  604","line":") void {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  605","line":"    const required_package = self.get_required_package(requirement_name, packages);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  606","line":""},
{"lineNum":"  607","line":"    try self.append_library_dirs(cmd, required_package, allocator);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  608","line":"    try self.append_library_flags(cmd, required_package, allocator);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  609","line":"}"},
{"lineNum":"  610","line":""},
{"lineNum":"  611","line":"fn append_library_dirs("},
{"lineNum":"  612","line":"    self: *Package,"},
{"lineNum":"  613","line":"    cmd: *std.array_list.Managed([]const u8),"},
{"lineNum":"  614","line":"    required_package: *Package,"},
{"lineNum":"  615","line":"    allocator: std.mem.Allocator,"},
{"lineNum":"  616","line":") !void {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  617","line":"    var requirement_library_path = std.array_list.Managed(u8).init(allocator);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  618","line":"    requirement_library_path.print(\"{s}{c}build\", .{ required_package.root.init_value().?.module.module.get_package_abs_path(), std.fs.path.sep }) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  619","line":"    cmd.append(\"-L\") catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  620","line":"    cmd.append(requirement_library_path.items) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  621","line":""},
{"lineNum":"  622","line":"    for (self.library_directories.keys()) |lib_dir| {","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  623","line":"        cmd.append(\"-L\") catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  624","line":"        cmd.append(lib_dir) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  625","line":"    }","class":"lineNoCov","hits":"0","possible_hits":"4",},
{"lineNum":"  626","line":"}"},
{"lineNum":"  627","line":""},
{"lineNum":"  628","line":"fn append_library_flags("},
{"lineNum":"  629","line":"    self: *Package,"},
{"lineNum":"  630","line":"    cmd: *std.array_list.Managed([]const u8),"},
{"lineNum":"  631","line":"    required_package: *Package,"},
{"lineNum":"  632","line":"    allocator: std.mem.Allocator,"},
{"lineNum":"  633","line":") !void {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  634","line":"    var requirement_library = std.array_list.Managed(u8).init(allocator);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  635","line":"    requirement_library.print(\"-l{s}\", .{required_package.name}) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  636","line":"    cmd.append(requirement_library.items) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  637","line":""},
{"lineNum":"  638","line":"    for (self.libraries.keys()) |lib| {","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  639","line":"        cmd.append(\"-l\") catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  640","line":"        cmd.append(lib) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  641","line":"    }","class":"lineNoCov","hits":"0","possible_hits":"4",},
{"lineNum":"  642","line":"}"},
{"lineNum":"  643","line":""},
{"lineNum":"  644","line":"const debug: bool = false;"},
{"lineNum":"  645","line":"fn print_cmd(cmd: *const std.array_list.Managed([]const u8)) void {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  646","line":"    if (debug) {","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  647","line":"        for (cmd.items) |item| {"},
{"lineNum":"  648","line":"            std.debug.print(\"{s} \", .{item});"},
{"lineNum":"  649","line":"        }"},
{"lineNum":"  650","line":"        std.debug.print(\"\\n\", .{});"},
{"lineNum":"  651","line":"    }"},
{"lineNum":"  652","line":"}"},
]};
var percent_low = 25;var percent_high = 75;
var header = { "command" : "orng-test", "date" : "2025-11-10 15:43:08", "instrumented" : 325, "covered" : 26,};
var merged_data = [];
