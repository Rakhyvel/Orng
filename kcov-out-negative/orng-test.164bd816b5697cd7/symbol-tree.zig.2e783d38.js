var data = {lines:[
{"lineNum":"    1","line":"//! This file represents a struct for an AST walk, and constructs the symbol tree for the AST."},
{"lineNum":"    2","line":""},
{"lineNum":"    3","line":"const std = @import(\"std\");"},
{"lineNum":"    4","line":"const ast_ = @import(\"../ast/ast.zig\");"},
{"lineNum":"    5","line":"const Canonical_Type_Fmt = @import(\"../types/canonical_type_fmt.zig\");"},
{"lineNum":"    6","line":"const core_ = @import(\"../hierarchy/core.zig\");"},
{"lineNum":"    7","line":"const errs_ = @import(\"../util/errors.zig\");"},
{"lineNum":"    8","line":"const prelude_ = @import(\"../hierarchy/prelude.zig\");"},
{"lineNum":"    9","line":"const String = @import(\"../zig-string/zig-string.zig\").String;"},
{"lineNum":"   10","line":"const Scope = @import(\"../symbol/scope.zig\");"},
{"lineNum":"   11","line":"const Symbol = @import(\"../symbol/symbol.zig\");"},
{"lineNum":"   12","line":"const Token = @import(\"../lexer/token.zig\");"},
{"lineNum":"   13","line":"const Type_AST = @import(\"../types/type.zig\").Type_AST;"},
{"lineNum":"   14","line":"const walk_ = @import(\"../ast/walker.zig\");"},
{"lineNum":"   15","line":""},
{"lineNum":"   16","line":"scope: *Scope,"},
{"lineNum":"   17","line":"in_loop: bool,"},
{"lineNum":"   18","line":"is_param_scope: bool,"},
{"lineNum":"   19","line":"defers: ?*std.array_list.Managed(*ast_.AST),"},
{"lineNum":"   20","line":"errdefers: ?*std.array_list.Managed(*ast_.AST),"},
{"lineNum":"   21","line":"errors: *errs_.Errors,"},
{"lineNum":"   22","line":"allocator: std.mem.Allocator,"},
{"lineNum":"   23","line":""},
{"lineNum":"   24","line":"const Self = @This();"},
{"lineNum":"   25","line":"const Error = walk_.Error;"},
{"lineNum":"   26","line":""},
{"lineNum":"   27","line":"pub fn new(scope: *Scope, errors: *errs_.Errors, allocator: std.mem.Allocator) Self {","class":"lineCov","hits":"2","order":"519","possible_hits":"2",},
{"lineNum":"   28","line":"    return Self{","class":"lineCov","hits":"1","order":"520","possible_hits":"1",},
{"lineNum":"   29","line":"        .scope = scope,"},
{"lineNum":"   30","line":"        .in_loop = false,"},
{"lineNum":"   31","line":"        .is_param_scope = false,"},
{"lineNum":"   32","line":"        .defers = null,"},
{"lineNum":"   33","line":"        .errdefers = null,"},
{"lineNum":"   34","line":"        .errors = errors,"},
{"lineNum":"   35","line":"        .allocator = allocator,"},
{"lineNum":"   36","line":"    };"},
{"lineNum":"   37","line":"}"},
{"lineNum":"   38","line":""},
{"lineNum":"   39","line":"pub fn prefix(self: Self, ast: *ast_.AST) walk_.Error!?Self {","class":"lineCov","hits":"2","order":"1539","possible_hits":"2",},
{"lineNum":"   40","line":"    return self.symbol_tree_prefix(ast);","class":"lineCov","hits":"1","order":"1540","possible_hits":"1",},
{"lineNum":"   41","line":"}"},
{"lineNum":"   42","line":""},
{"lineNum":"   43","line":"pub fn postfix(self: Self, ast: *ast_.AST) walk_.Error!void {","class":"lineCov","hits":"2","order":"1577","possible_hits":"2",},
{"lineNum":"   44","line":"    return self.symbol_tree_postfix(ast);","class":"lineCov","hits":"1","order":"1578","possible_hits":"1",},
{"lineNum":"   45","line":"}"},
{"lineNum":"   46","line":""},
{"lineNum":"   47","line":"fn symbol_tree_prefix(self: Self, ast: *ast_.AST) walk_.Error!?Self {","class":"lineCov","hits":"2","order":"1541","possible_hits":"2",},
{"lineNum":"   48","line":"    switch (ast.*) {","class":"lineCov","hits":"3","order":"1542","possible_hits":"3",},
{"lineNum":"   49","line":"        else => {},"},
{"lineNum":"   50","line":""},
{"lineNum":"   51","line":"        // Capture scope"},
{"lineNum":"   52","line":"        .@\"comptime\", .access, .call, .invoke, .addr_of => ast.set_scope(self.scope),","class":"lineCov","hits":"1","order":"1574","possible_hits":"1",},
{"lineNum":"   53","line":""},
{"lineNum":"   54","line":"        // Check that AST is inside a loop"},
{"lineNum":"   55","line":"        .@\"break\", .@\"continue\" => try self.in_loop_check(ast, self.errors),","class":"lineCov","hits":"2","order":"6678","possible_hits":"2",},
{"lineNum":"   56","line":""},
{"lineNum":"   57","line":"        // Check that AST is inside a function"},
{"lineNum":"   58","line":"        .@\"try\", .@\"return\" => ast.set_symbol(try in_function_check(ast, self.scope, self.errors)),","class":"lineCov","hits":"2","order":"1904","possible_hits":"2",},
{"lineNum":"   59","line":""},
{"lineNum":"   60","line":"        // Add defers to scope"},
{"lineNum":"   61","line":"        .@\"defer\" => if (self.defers) |defers| {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"   62","line":"            defers.append(ast.statement()) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"   63","line":"        } else {"},
{"lineNum":"   64","line":"            // TODO: an error"},
{"lineNum":"   65","line":"        },"},
{"lineNum":"   66","line":""},
{"lineNum":"   67","line":"        .@\"errdefer\" => if (self.errdefers) |errdefers| {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"   68","line":"            errdefers.append(ast.statement()) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"   69","line":"        } else {"},
{"lineNum":"   70","line":"            // TODO: an error"},
{"lineNum":"   71","line":"        },"},
{"lineNum":"   72","line":""},
{"lineNum":"   73","line":"        // Create a new scope, pass it to children"},
{"lineNum":"   74","line":"        .@\"if\", .match, .@\"while\", .@\"for\" => {"},
{"lineNum":"   75","line":"            var new_self = self;","class":"lineCov","hits":"1","order":"1899","possible_hits":"1",},
{"lineNum":"   76","line":"            new_self.scope = Scope.init(self.scope, self.scope.uid_gen, self.allocator);","class":"lineCov","hits":"1","order":"1900","possible_hits":"1",},
{"lineNum":"   77","line":"            new_self.in_loop = new_self.in_loop or ast.* == .@\"while\" or ast.* == .@\"for\";","class":"lineCov","hits":"3","order":"1901","possible_hits":"3",},
{"lineNum":"   78","line":"            ast.set_scope(new_self.scope);","class":"lineCov","hits":"1","order":"1902","possible_hits":"1",},
{"lineNum":"   79","line":"            return new_self;","class":"lineCov","hits":"1","order":"1903","possible_hits":"1",},
{"lineNum":"   80","line":"        },"},
{"lineNum":"   81","line":""},
{"lineNum":"   82","line":"        // Create a new scope, set defers, pass it to children"},
{"lineNum":"   83","line":"        .block => {"},
{"lineNum":"   84","line":"            var new_self = self;","class":"lineCov","hits":"1","order":"1880","possible_hits":"1",},
{"lineNum":"   85","line":"            new_self.scope = Scope.init(self.scope, self.scope.uid_gen, self.allocator);","class":"lineCov","hits":"1","order":"1881","possible_hits":"1",},
{"lineNum":"   86","line":"            if (ast.block.defers.items.len == 0) {","class":"lineCov","hits":"2","order":"1882","possible_hits":"2",},
{"lineNum":"   87","line":"                // Only register defers list to be appended if the list is empty"},
{"lineNum":"   88","line":"                new_self.defers = &ast.block.defers;","class":"lineCov","hits":"1","order":"1883","possible_hits":"1",},
{"lineNum":"   89","line":"            }"},
{"lineNum":"   90","line":"            if (ast.block.errdefers.items.len == 0) {","class":"lineCov","hits":"2","order":"1884","possible_hits":"2",},
{"lineNum":"   91","line":"                // Only register errdefers list to be appended if the list is empty"},
{"lineNum":"   92","line":"                new_self.errdefers = &ast.block.errdefers;","class":"lineCov","hits":"1","order":"1885","possible_hits":"1",},
{"lineNum":"   93","line":"            }"},
{"lineNum":"   94","line":"            new_self.in_loop = new_self.in_loop or ast.* == .@\"while\" or ast.* == .@\"for\";","class":"lineCov","hits":"3","order":"1886","possible_hits":"3",},
{"lineNum":"   95","line":"            ast.set_scope(new_self.scope);","class":"lineCov","hits":"1","order":"1887","possible_hits":"1",},
{"lineNum":"   96","line":"            return new_self;","class":"lineCov","hits":"1","order":"1888","possible_hits":"1",},
{"lineNum":"   97","line":"        },"},
{"lineNum":"   98","line":""},
{"lineNum":"   99","line":"        // Create symbols (potentially >1) from pattern, put inside scope"},
{"lineNum":"  100","line":"        .binding => {"},
{"lineNum":"  101","line":"            var symbols = std.array_list.Managed(*Symbol).init(self.allocator);","class":"lineCov","hits":"1","order":"1778","possible_hits":"1",},
{"lineNum":"  102","line":"            try create_symbol(","class":"lineCov","hits":"2","order":"1785","possible_hits":"2",},
{"lineNum":"  103","line":"                &symbols,"},
{"lineNum":"  104","line":"                ast.binding.pattern,","class":"lineCov","hits":"3","order":"1779","possible_hits":"3",},
{"lineNum":"  105","line":"                ast,"},
{"lineNum":"  106","line":"                ast.binding.type,","class":"lineCov","hits":"3","order":"1780","possible_hits":"3",},
{"lineNum":"  107","line":"                ast.binding.init,","class":"lineCov","hits":"3","order":"1781","possible_hits":"3",},
{"lineNum":"  108","line":"                self.scope,","class":"lineCov","hits":"1","order":"1782","possible_hits":"1",},
{"lineNum":"  109","line":"                self.errors,","class":"lineCov","hits":"1","order":"1783","possible_hits":"1",},
{"lineNum":"  110","line":"                self.allocator,","class":"lineCov","hits":"1","order":"1784","possible_hits":"1",},
{"lineNum":"  111","line":"            );"},
{"lineNum":"  112","line":"            for (symbols.items) |symbol| {","class":"lineCov","hits":"3","order":"1799","possible_hits":"3",},
{"lineNum":"  113","line":"                ast.binding.decls.append(symbol.decl.?) catch unreachable;","class":"lineCov","hits":"2","order":"1800","possible_hits":"2",},
{"lineNum":"  114","line":"            }","class":"lineCov","hits":"2","order":"1801","possible_hits":"2",},
{"lineNum":"  115","line":"            try self.scope.put_all_symbols(&symbols, self.errors);","class":"lineCov","hits":"2","order":"1802","possible_hits":"2",},
{"lineNum":"  116","line":"        },"},
{"lineNum":"  117","line":""},
{"lineNum":"  118","line":"        .struct_decl, .enum_decl, .type_alias => {"},
{"lineNum":"  119","line":"            if (ast.symbol() != null) {","class":"lineCov","hits":"1","order":"1543","possible_hits":"1",},
{"lineNum":"  120","line":"                // Do not re-do symbol if already declared"},
{"lineNum":"  121","line":"                return null;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  122","line":"            }"},
{"lineNum":"  123","line":""},
{"lineNum":"  124","line":"            var new_self = self;","class":"lineCov","hits":"1","order":"1546","possible_hits":"1",},
{"lineNum":"  125","line":"            new_self.scope = Scope.init(self.scope, self.scope.uid_gen, self.allocator);","class":"lineCov","hits":"1","order":"1547","possible_hits":"1",},
{"lineNum":"  126","line":""},
{"lineNum":"  127","line":"            const symbol = Symbol.init(","class":"lineCov","hits":"1","order":"1555","possible_hits":"1",},
{"lineNum":"  128","line":"                self.scope,","class":"lineCov","hits":"1","order":"1548","possible_hits":"1",},
{"lineNum":"  129","line":"                ast.decl_name().token().data,","class":"lineCov","hits":"1","order":"1549","possible_hits":"1",},
{"lineNum":"  130","line":"                ast,"},
{"lineNum":"  131","line":"                .type,"},
{"lineNum":"  132","line":"                ast.decl_name().pattern_symbol.storage,","class":"lineCov","hits":"3","order":"1553","possible_hits":"3",},
{"lineNum":"  133","line":"                self.allocator,","class":"lineCov","hits":"1","order":"1554","possible_hits":"1",},
{"lineNum":"  134","line":"            );"},
{"lineNum":"  135","line":"            try self.register_symbol(ast, symbol);","class":"linePartCov","hits":"1","order":"1556","possible_hits":"2",},
{"lineNum":"  136","line":""},
{"lineNum":"  137","line":"            ast.set_scope(new_self.scope);","class":"lineCov","hits":"1","order":"1569","possible_hits":"1",},
{"lineNum":"  138","line":"            return new_self;","class":"lineCov","hits":"1","order":"1573","possible_hits":"1",},
{"lineNum":"  139","line":"        },"},
{"lineNum":"  140","line":""},
{"lineNum":"  141","line":"        .context_value_decl => {"},
{"lineNum":"  142","line":"            if (ast.symbol() != null) {","class":"lineCov","hits":"1","order":"4985","possible_hits":"1",},
{"lineNum":"  143","line":"                // Do not re-do symbol if already declared"},
{"lineNum":"  144","line":"                return null;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  145","line":"            }"},
{"lineNum":"  146","line":""},
{"lineNum":"  147","line":"            const number = self.scope.num_visible_contexts();","class":"lineCov","hits":"1","order":"4986","possible_hits":"1",},
{"lineNum":"  148","line":"            var out = std.array_list.Managed(u8).init(self.allocator);","class":"lineCov","hits":"1","order":"4997","possible_hits":"1",},
{"lineNum":"  149","line":"            defer out.deinit();","class":"linePartCov","hits":"1","order":"5004","possible_hits":"2",},
{"lineNum":"  150","line":"            out.print(\"context_value__{}\", .{number}) catch unreachable;","class":"lineCov","hits":"2","order":"4998","possible_hits":"2",},
{"lineNum":"  151","line":""},
{"lineNum":"  152","line":"            const symbol = Symbol.init(","class":"lineCov","hits":"1","order":"5002","possible_hits":"1",},
{"lineNum":"  153","line":"                self.scope,","class":"lineCov","hits":"1","order":"4999","possible_hits":"1",},
{"lineNum":"  154","line":"                out.toOwnedSlice() catch unreachable,","class":"lineCov","hits":"2","order":"5000","possible_hits":"2",},
{"lineNum":"  155","line":"                ast,"},
{"lineNum":"  156","line":"                .let,"},
{"lineNum":"  157","line":"                .local,"},
{"lineNum":"  158","line":"                self.allocator,","class":"lineCov","hits":"1","order":"5001","possible_hits":"1",},
{"lineNum":"  159","line":"            );"},
{"lineNum":"  160","line":"            try self.register_symbol(ast, symbol);","class":"linePartCov","hits":"1","order":"5003","possible_hits":"2",},
{"lineNum":"  161","line":""},
{"lineNum":"  162","line":"            return self;","class":"lineCov","hits":"1","order":"5005","possible_hits":"1",},
{"lineNum":"  163","line":"        },"},
{"lineNum":"  164","line":""},
{"lineNum":"  165","line":"        .context_decl => {"},
{"lineNum":"  166","line":"            if (ast.symbol() != null) {","class":"lineCov","hits":"1","order":"1909","possible_hits":"1",},
{"lineNum":"  167","line":"                // Do not re-do symbol if already declared"},
{"lineNum":"  168","line":"                return null;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  169","line":"            }"},
{"lineNum":"  170","line":""},
{"lineNum":"  171","line":"            var new_self = self;","class":"lineCov","hits":"1","order":"1910","possible_hits":"1",},
{"lineNum":"  172","line":"            new_self.scope = Scope.init(self.scope, self.scope.uid_gen, self.allocator);","class":"lineCov","hits":"1","order":"1911","possible_hits":"1",},
{"lineNum":"  173","line":""},
{"lineNum":"  174","line":"            const symbol = Symbol.init(","class":"lineCov","hits":"1","order":"1917","possible_hits":"1",},
{"lineNum":"  175","line":"                self.scope,","class":"lineCov","hits":"1","order":"1912","possible_hits":"1",},
{"lineNum":"  176","line":"                ast.decl_name().token().data,","class":"lineCov","hits":"1","order":"1913","possible_hits":"1",},
{"lineNum":"  177","line":"                ast,"},
{"lineNum":"  178","line":"                .context,"},
{"lineNum":"  179","line":"                ast.decl_name().pattern_symbol.storage,","class":"lineCov","hits":"3","order":"1915","possible_hits":"3",},
{"lineNum":"  180","line":"                self.allocator,","class":"lineCov","hits":"1","order":"1916","possible_hits":"1",},
{"lineNum":"  181","line":"            );"},
{"lineNum":"  182","line":"            try self.register_symbol(ast, symbol);","class":"linePartCov","hits":"1","order":"1918","possible_hits":"2",},
{"lineNum":"  183","line":""},
{"lineNum":"  184","line":"            ast.set_scope(new_self.scope);","class":"lineCov","hits":"1","order":"1919","possible_hits":"1",},
{"lineNum":"  185","line":"            return new_self;","class":"lineCov","hits":"1","order":"1920","possible_hits":"1",},
{"lineNum":"  186","line":"        },"},
{"lineNum":"  187","line":""},
{"lineNum":"  188","line":"        .type_param_decl => {"},
{"lineNum":"  189","line":"            const symbol = Symbol.init(","class":"lineCov","hits":"1","order":"5208","possible_hits":"1",},
{"lineNum":"  190","line":"                self.scope,","class":"lineCov","hits":"1","order":"5205","possible_hits":"1",},
{"lineNum":"  191","line":"                ast.token().data,","class":"lineCov","hits":"1","order":"5206","possible_hits":"1",},
{"lineNum":"  192","line":"                ast,"},
{"lineNum":"  193","line":"                .type,"},
{"lineNum":"  194","line":"                .local,"},
{"lineNum":"  195","line":"                self.allocator,","class":"lineCov","hits":"1","order":"5207","possible_hits":"1",},
{"lineNum":"  196","line":"            );"},
{"lineNum":"  197","line":"            try self.register_symbol(ast, symbol);","class":"linePartCov","hits":"1","order":"5209","possible_hits":"2",},
{"lineNum":"  198","line":"        },"},
{"lineNum":"  199","line":""},
{"lineNum":"  200","line":"        .@\"test\" => {"},
{"lineNum":"  201","line":"            var new_self = self;","class":"lineCov","hits":"1","order":"5072","possible_hits":"1",},
{"lineNum":"  202","line":"            new_self.scope = Scope.init(self.scope, self.scope.uid_gen, self.allocator);","class":"lineCov","hits":"1","order":"5073","possible_hits":"1",},
{"lineNum":"  203","line":""},
{"lineNum":"  204","line":"            ast.set_scope(new_self.scope);","class":"lineCov","hits":"1","order":"5074","possible_hits":"1",},
{"lineNum":"  205","line":"            new_self.scope.function_depth = self.scope.function_depth + 1;","class":"linePartCov","hits":"1","order":"5075","possible_hits":"2",},
{"lineNum":"  206","line":""},
{"lineNum":"  207","line":"            const symbol = try create_test_symbol(ast, self.allocator);","class":"lineCov","hits":"1","order":"5076","possible_hits":"1",},
{"lineNum":"  208","line":"            try self.register_symbol(ast, symbol);","class":"lineCov","hits":"1","order":"5092","possible_hits":"1",},
{"lineNum":"  209","line":""},
{"lineNum":"  210","line":"            return new_self;","class":"lineCov","hits":"1","order":"5093","possible_hits":"1",},
{"lineNum":"  211","line":"        },"},
{"lineNum":"  212","line":""},
{"lineNum":"  213","line":"        // Create a symbol for this function"},
{"lineNum":"  214","line":"        .fn_decl => {"},
{"lineNum":"  215","line":"            if (ast.symbol() != null) {","class":"lineCov","hits":"1","order":"4458","possible_hits":"1",},
{"lineNum":"  216","line":"                // this can happen sometimes with: decl(fn_decl())"},
{"lineNum":"  217","line":"                // its fine, just return"},
{"lineNum":"  218","line":"                return null;","class":"lineCov","hits":"1","order":"6213","possible_hits":"1",},
{"lineNum":"  219","line":"            }"},
{"lineNum":"  220","line":""},
{"lineNum":"  221","line":"            var new_self = self;","class":"lineCov","hits":"1","order":"4459","possible_hits":"1",},
{"lineNum":"  222","line":"            new_self.scope = Scope.init(self.scope, self.scope.uid_gen, self.allocator);","class":"lineCov","hits":"1","order":"4460","possible_hits":"1",},
{"lineNum":"  223","line":""},
{"lineNum":"  224","line":"            ast.set_scope(new_self.scope);","class":"lineCov","hits":"1","order":"4461","possible_hits":"1",},
{"lineNum":"  225","line":"            new_self.scope.function_depth = self.scope.function_depth + 1;","class":"linePartCov","hits":"1","order":"4462","possible_hits":"2",},
{"lineNum":"  226","line":""},
{"lineNum":"  227","line":"            const symbol = create_function_symbol(ast, self.allocator);","class":"lineCov","hits":"1","order":"4463","possible_hits":"1",},
{"lineNum":"  228","line":"            try self.register_symbol(ast, symbol);","class":"lineCov","hits":"1","order":"4481","possible_hits":"1",},
{"lineNum":"  229","line":""},
{"lineNum":"  230","line":"            return new_self;","class":"lineCov","hits":"1","order":"4482","possible_hits":"1",},
{"lineNum":"  231","line":"        },"},
{"lineNum":"  232","line":""},
{"lineNum":"  233","line":"        // Create new scope, create and walk trait symbols/decls"},
{"lineNum":"  234","line":"        .trait => {"},
{"lineNum":"  235","line":"            if (ast.symbol() != null) {","class":"lineCov","hits":"1","order":"1725","possible_hits":"1",},
{"lineNum":"  236","line":"                // Do not re-do symboo if already declared"},
{"lineNum":"  237","line":"                return null;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  238","line":"            }"},
{"lineNum":"  239","line":"            var new_self = self;","class":"lineCov","hits":"1","order":"1726","possible_hits":"1",},
{"lineNum":"  240","line":"            new_self.scope = Scope.init(self.scope, self.scope.uid_gen, self.allocator);","class":"lineCov","hits":"1","order":"1727","possible_hits":"1",},
{"lineNum":"  241","line":"            ast.set_scope(new_self.scope);","class":"lineCov","hits":"1","order":"1728","possible_hits":"1",},
{"lineNum":"  242","line":"            const symbol = try create_trait_symbol(ast, self.scope, self.allocator);","class":"linePartCov","hits":"1","order":"1729","possible_hits":"2",},
{"lineNum":"  243","line":"            try self.register_symbol(ast, symbol);","class":"lineCov","hits":"1","order":"1735","possible_hits":"1",},
{"lineNum":"  244","line":""},
{"lineNum":"  245","line":"            const self_type_decl = ast_.AST.create_type_alias(","class":"lineCov","hits":"1","order":"1742","possible_hits":"1",},
{"lineNum":"  246","line":"                ast.token(),","class":"lineCov","hits":"1","order":"1736","possible_hits":"1",},
{"lineNum":"  247","line":"                ast_.AST.create_pattern_symbol(","class":"lineCov","hits":"1","order":"1739","possible_hits":"1",},
{"lineNum":"  248","line":"                    Token.init_simple(\"Self\"),","class":"lineCov","hits":"1","order":"1737","possible_hits":"1",},
{"lineNum":"  249","line":"                    .type,"},
{"lineNum":"  250","line":"                    .local,"},
{"lineNum":"  251","line":"                    \"Self\","},
{"lineNum":"  252","line":"                    self.allocator,","class":"lineCov","hits":"1","order":"1738","possible_hits":"1",},
{"lineNum":"  253","line":"                ),"},
{"lineNum":"  254","line":"                null,"},
{"lineNum":"  255","line":"                std.array_list.Managed(*ast_.AST).init(self.allocator),","class":"lineCov","hits":"1","order":"1740","possible_hits":"1",},
{"lineNum":"  256","line":"                self.allocator,","class":"lineCov","hits":"1","order":"1741","possible_hits":"1",},
{"lineNum":"  257","line":"            );"},
{"lineNum":"  258","line":"            try walk_.walk_ast(self_type_decl, new_self);","class":"lineCov","hits":"1","order":"1743","possible_hits":"1",},
{"lineNum":"  259","line":""},
{"lineNum":"  260","line":"            return new_self;","class":"lineCov","hits":"1","order":"1744","possible_hits":"1",},
{"lineNum":"  261","line":"        },"},
{"lineNum":"  262","line":""},
{"lineNum":"  263","line":"        // Create new scope, create anon trait, create and walk impl symbols/decls"},
{"lineNum":"  264","line":"        .impl => {"},
{"lineNum":"  265","line":"            // Impls get there own scope, actually"},
{"lineNum":"  266","line":"            var new_self = self;","class":"lineCov","hits":"1","order":"1582","possible_hits":"1",},
{"lineNum":"  267","line":"            new_self.scope = Scope.init(self.scope, self.scope.uid_gen, self.allocator);","class":"lineCov","hits":"1","order":"1583","possible_hits":"1",},
{"lineNum":"  268","line":"            ast.set_scope(new_self.scope);","class":"lineCov","hits":"1","order":"1584","possible_hits":"1",},
{"lineNum":"  269","line":""},
{"lineNum":"  270","line":"            const self_type_decl = ast_.AST.create_type_alias(","class":"lineCov","hits":"1","order":"1591","possible_hits":"1",},
{"lineNum":"  271","line":"                ast.token(),","class":"lineCov","hits":"1","order":"1585","possible_hits":"1",},
{"lineNum":"  272","line":"                ast_.AST.create_pattern_symbol(","class":"lineCov","hits":"1","order":"1587","possible_hits":"1",},
{"lineNum":"  273","line":"                    Token.init_simple(\"Self\"),","class":"lineCov","hits":"1","order":"1586","possible_hits":"1",},
{"lineNum":"  274","line":"                    .type,"},
{"lineNum":"  275","line":"                    .local,"},
{"lineNum":"  276","line":"                    \"Self\","},
{"lineNum":"  277","line":"                    self.allocator,"},
{"lineNum":"  278","line":"                ),"},
{"lineNum":"  279","line":"                ast.impl._type,","class":"lineCov","hits":"3","order":"1588","possible_hits":"3",},
{"lineNum":"  280","line":"                std.array_list.Managed(*ast_.AST).init(self.allocator),","class":"lineCov","hits":"1","order":"1589","possible_hits":"1",},
{"lineNum":"  281","line":"                self.allocator,","class":"lineCov","hits":"1","order":"1590","possible_hits":"1",},
{"lineNum":"  282","line":"            );"},
{"lineNum":"  283","line":"            try walk_.walk_ast(self_type_decl, new_self);","class":"linePartCov","hits":"1","order":"1592","possible_hits":"2",},
{"lineNum":"  284","line":""},
{"lineNum":"  285","line":"            for (ast.impl.method_defs.items, 0..) |method_def, i| {","class":"lineCov","hits":"3","order":"1594","possible_hits":"3",},
{"lineNum":"  286","line":"                var subst = std.StringArrayHashMap(*Type_AST).init(self.allocator);","class":"lineCov","hits":"1","order":"1595","possible_hits":"1",},
{"lineNum":"  287","line":"                defer subst.deinit();","class":"lineCov","hits":"1","order":"1648","possible_hits":"1",},
{"lineNum":"  288","line":""},
{"lineNum":"  289","line":"                subst.put(\"Self\", ast.impl._type) catch unreachable;","class":"lineCov","hits":"2","order":"1596","possible_hits":"2",},
{"lineNum":"  290","line":""},
{"lineNum":"  291","line":"                ast.impl.method_defs.items[i] = method_def.clone(&subst, self.allocator);","class":"lineCov","hits":"3","order":"1597","possible_hits":"3",},
{"lineNum":"  292","line":"            }","class":"lineCov","hits":"3","order":"1649","possible_hits":"3",},
{"lineNum":"  293","line":""},
{"lineNum":"  294","line":"            if (ast.impl.trait == null) {","class":"lineCov","hits":"2","order":"1704","possible_hits":"2",},
{"lineNum":"  295","line":"                // impl\'d for an anon trait, create an anon trait for it"},
{"lineNum":"  296","line":"                var new_self_for_anon_trait = self;","class":"lineCov","hits":"1","order":"1705","possible_hits":"1",},
{"lineNum":"  297","line":"                new_self_for_anon_trait.scope = Scope.init(self.scope, self.scope.uid_gen, self.allocator);","class":"lineCov","hits":"1","order":"1706","possible_hits":"1",},
{"lineNum":"  298","line":""},
{"lineNum":"  299","line":"                // TODO: Don\'t do this for generic impls (but those\'ll be a new node anyway)"},
{"lineNum":"  300","line":"                var subst = std.StringArrayHashMap(*Type_AST).init(self.allocator);","class":"lineCov","hits":"1","order":"1707","possible_hits":"1",},
{"lineNum":"  301","line":"                defer subst.deinit();","class":"linePartCov","hits":"2","order":"1863","possible_hits":"3",},
{"lineNum":"  302","line":""},
{"lineNum":"  303","line":"                var token = ast.token();","class":"lineCov","hits":"1","order":"1708","possible_hits":"1",},
{"lineNum":"  304","line":"                token.kind = .identifier;","class":"lineCov","hits":"1","order":"1709","possible_hits":"1",},
{"lineNum":"  305","line":"                token.data = next_anon_name(\"Trait\", self.allocator);","class":"lineCov","hits":"1","order":"1710","possible_hits":"1",},
{"lineNum":"  306","line":"                const cloned_methods = ast_.AST.clone_children(ast.impl.method_defs, &subst, self.allocator);","class":"lineCov","hits":"3","order":"1717","possible_hits":"3",},
{"lineNum":"  307","line":"                for (cloned_methods.items) |cloned_method| {","class":"lineCov","hits":"3","order":"1718","possible_hits":"3",},
{"lineNum":"  308","line":"                    cloned_method.method_decl.init = null;","class":"lineCov","hits":"3","order":"1719","possible_hits":"3",},
{"lineNum":"  309","line":"                }","class":"lineCov","hits":"3","order":"1720","possible_hits":"3",},
{"lineNum":"  310","line":"                const anon_trait = ast_.AST.create_trait(","class":"lineCov","hits":"2","order":"1721","possible_hits":"2",},
{"lineNum":"  311","line":"                    token,"},
{"lineNum":"  312","line":"                    cloned_methods,"},
{"lineNum":"  313","line":"                    ast_.AST.clone_children(ast.impl.const_defs, &subst, self.allocator),","class":"lineCov","hits":"3","order":"1722","possible_hits":"3",},
{"lineNum":"  314","line":"                    self.allocator,","class":"lineCov","hits":"1","order":"1723","possible_hits":"1",},
{"lineNum":"  315","line":"                );"},
{"lineNum":"  316","line":"                try walk_.walk_ast(anon_trait, new_self_for_anon_trait);","class":"linePartCov","hits":"1","order":"1724","possible_hits":"2",},
{"lineNum":"  317","line":"                ast.impl.trait = ast_.AST.create_identifier(token, self.allocator);","class":"lineCov","hits":"2","order":"1860","possible_hits":"2",},
{"lineNum":"  318","line":"                ast.impl.trait.?.set_symbol(anon_trait.symbol().?);","class":"lineCov","hits":"3","order":"1861","possible_hits":"3",},
{"lineNum":"  319","line":"                ast.impl.impls_anon_trait = true;","class":"lineCov","hits":"3","order":"1862","possible_hits":"3",},
{"lineNum":"  320","line":"            }"},
{"lineNum":"  321","line":""},
{"lineNum":"  322","line":"            self.scope.impls.append(ast) catch unreachable;","class":"lineCov","hits":"2","order":"1864","possible_hits":"2",},
{"lineNum":"  323","line":""},
{"lineNum":"  324","line":"            return new_self;","class":"lineCov","hits":"1","order":"1865","possible_hits":"1",},
{"lineNum":"  325","line":"        },"},
{"lineNum":"  326","line":""},
{"lineNum":"  327","line":"        // Create scope"},
{"lineNum":"  328","line":"        .method_decl => {"},
{"lineNum":"  329","line":"            if (ast.symbol() != null) {","class":"lineCov","hits":"1","order":"1745","possible_hits":"1",},
{"lineNum":"  330","line":"                // Do not re-do symbol if already declared"},
{"lineNum":"  331","line":"                return null;","class":"lineCov","hits":"1","order":"5485","possible_hits":"1",},
{"lineNum":"  332","line":"            }"},
{"lineNum":"  333","line":""},
{"lineNum":"  334","line":"            var new_self = self;","class":"lineCov","hits":"1","order":"1746","possible_hits":"1",},
{"lineNum":"  335","line":"            new_self.scope = Scope.init(self.scope, self.scope.uid_gen, self.allocator);","class":"lineCov","hits":"1","order":"1747","possible_hits":"1",},
{"lineNum":"  336","line":"            ast.set_scope(new_self.scope);","class":"lineCov","hits":"1","order":"1748","possible_hits":"1",},
{"lineNum":"  337","line":"            new_self.scope.function_depth = new_self.scope.function_depth + 1;","class":"linePartCov","hits":"1","order":"1749","possible_hits":"2",},
{"lineNum":"  338","line":""},
{"lineNum":"  339","line":"            if (ast.method_decl.init == null) {","class":"lineCov","hits":"2","order":"1750","possible_hits":"2",},
{"lineNum":"  340","line":"                // Trait method decl"},
{"lineNum":"  341","line":"                ast.method_decl._decl_type = create_method_type(ast, self.allocator);","class":"lineCov","hits":"2","order":"1751","possible_hits":"2",},
{"lineNum":"  342","line":"            } else {"},
{"lineNum":"  343","line":"                // Impl method decl"},
{"lineNum":"  344","line":"                const symbol = try create_method_symbol(ast, self.errors, self.allocator);","class":"linePartCov","hits":"1","order":"1866","possible_hits":"2",},
{"lineNum":"  345","line":"                try self.register_symbol(ast, symbol);","class":"lineCov","hits":"1","order":"1879","possible_hits":"1",},
{"lineNum":"  346","line":"            }"},
{"lineNum":"  347","line":""},
{"lineNum":"  348","line":"            return new_self;","class":"lineCov","hits":"1","order":"1777","possible_hits":"1",},
{"lineNum":"  349","line":"        },"},
{"lineNum":"  350","line":"    }"},
{"lineNum":"  351","line":""},
{"lineNum":"  352","line":"    return self;","class":"lineCov","hits":"1","order":"1575","possible_hits":"1",},
{"lineNum":"  353","line":"}"},
{"lineNum":"  354","line":""},
{"lineNum":"  355","line":"fn register_symbol(self: Self, ast: *ast_.AST, symbol: *Symbol) walk_.Error!void {","class":"lineCov","hits":"2","order":"1557","possible_hits":"2",},
{"lineNum":"  356","line":"    try self.scope.put_symbol(symbol, self.errors);","class":"lineCov","hits":"1","order":"1558","possible_hits":"1",},
{"lineNum":"  357","line":"    ast.set_symbol(symbol);","class":"lineCov","hits":"1","order":"1563","possible_hits":"1",},
{"lineNum":"  358","line":"}"},
{"lineNum":"  359","line":""},
{"lineNum":"  360","line":"fn symbol_tree_postfix(self: Self, ast: *ast_.AST) walk_.Error!void {","class":"lineCov","hits":"2","order":"1579","possible_hits":"2",},
{"lineNum":"  361","line":"    switch (ast.*) {","class":"lineCov","hits":"3","order":"1580","possible_hits":"3",},
{"lineNum":"  362","line":"        else => {},"},
{"lineNum":"  363","line":""},
{"lineNum":"  364","line":"        .match => {"},
{"lineNum":"  365","line":"            try create_match_pattern_symbol(ast, self.scope, self.errors, self.allocator);","class":"linePartCov","hits":"1","order":"6014","possible_hits":"2",},
{"lineNum":"  366","line":"        },"},
{"lineNum":"  367","line":""},
{"lineNum":"  368","line":"        .trait => {"},
{"lineNum":"  369","line":"            for (ast.trait.method_decls.items) |method_decl| {","class":"lineCov","hits":"4","order":"1857","possible_hits":"4",},
{"lineNum":"  370","line":"                method_decl.method_decl.c_type = create_method_type(method_decl, self.allocator);","class":"lineCov","hits":"3","order":"1858","possible_hits":"3",},
{"lineNum":"  371","line":"            }","class":"lineCov","hits":"5","order":"1859","possible_hits":"5",},
{"lineNum":"  372","line":"        },"},
{"lineNum":"  373","line":""},
{"lineNum":"  374","line":"        .fn_decl => {"},
{"lineNum":"  375","line":"            for (ast.children().items) |param_binding| {","class":"lineCov","hits":"3","order":"4483","possible_hits":"3",},
{"lineNum":"  376","line":"                const symbol = param_binding.binding.decls.items[0].decl.name.symbol().?;","class":"lineCov","hits":"3","order":"4490","possible_hits":"3",},
{"lineNum":"  377","line":"                ast.param_symbols().?.append(symbol) catch unreachable;","class":"lineCov","hits":"2","order":"4491","possible_hits":"2",},
{"lineNum":"  378","line":"                symbol.defined = true;","class":"lineCov","hits":"1","order":"4493","possible_hits":"1",},
{"lineNum":"  379","line":"                symbol.param = true;","class":"lineCov","hits":"1","order":"4494","possible_hits":"1",},
{"lineNum":"  380","line":"            }","class":"lineCov","hits":"4","order":"4484","possible_hits":"4",},
{"lineNum":"  381","line":"            for (ast.fn_decl.context_decls.items) |context_param| {","class":"lineCov","hits":"4","order":"4485","possible_hits":"4",},
{"lineNum":"  382","line":"                const symbol = context_param.symbol().?;","class":"lineCov","hits":"3","order":"5006","possible_hits":"3",},
{"lineNum":"  383","line":"                ast.context_param_symbols().?.append(symbol) catch unreachable;","class":"lineCov","hits":"2","order":"5007","possible_hits":"2",},
{"lineNum":"  384","line":"                symbol.defined = true;","class":"lineCov","hits":"1","order":"5009","possible_hits":"1",},
{"lineNum":"  385","line":"                symbol.param = true;","class":"lineCov","hits":"1","order":"5010","possible_hits":"1",},
{"lineNum":"  386","line":"            }","class":"lineCov","hits":"5","order":"4486","possible_hits":"5",},
{"lineNum":"  387","line":"        },"},
{"lineNum":"  388","line":""},
{"lineNum":"  389","line":"        .@\"test\" => {"},
{"lineNum":"  390","line":"            for (ast.@\"test\".context_decls.items) |context_param| {","class":"lineCov","hits":"4","order":"5094","possible_hits":"4",},
{"lineNum":"  391","line":"                const symbol = context_param.symbol().?;","class":"lineCov","hits":"3","order":"5095","possible_hits":"3",},
{"lineNum":"  392","line":"                ast.context_param_symbols().?.append(symbol) catch unreachable;","class":"lineCov","hits":"2","order":"5096","possible_hits":"2",},
{"lineNum":"  393","line":"                symbol.defined = true;","class":"lineCov","hits":"1","order":"5098","possible_hits":"1",},
{"lineNum":"  394","line":"                symbol.param = true;","class":"lineCov","hits":"1","order":"5099","possible_hits":"1",},
{"lineNum":"  395","line":"            }","class":"lineCov","hits":"5","order":"1816","possible_hits":"5",},
{"lineNum":"  396","line":"        },"},
{"lineNum":"  397","line":""},
{"lineNum":"  398","line":"        .method_decl => {"},
{"lineNum":"  399","line":"            for (ast.children().items) |param_binding| {","class":"lineCov","hits":"3","order":"1817","possible_hits":"3",},
{"lineNum":"  400","line":"                const symbol = param_binding.binding.decls.items[0].decl.name.symbol().?;","class":"lineCov","hits":"3","order":"1818","possible_hits":"3",},
{"lineNum":"  401","line":"                ast.param_symbols().?.append(symbol) catch unreachable;","class":"lineCov","hits":"2","order":"1819","possible_hits":"2",},
{"lineNum":"  402","line":"                symbol.defined = true;","class":"lineCov","hits":"1","order":"1823","possible_hits":"1",},
{"lineNum":"  403","line":"                symbol.param = true;","class":"lineCov","hits":"1","order":"1824","possible_hits":"1",},
{"lineNum":"  404","line":"            }","class":"lineCov","hits":"4","order":"1825","possible_hits":"4",},
{"lineNum":"  405","line":"            for (ast.method_decl.context_decls.items) |context_param| {","class":"linePartCov","hits":"3","order":"1826","possible_hits":"4",},
{"lineNum":"  406","line":"                const symbol = context_param.symbol().?;","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  407","line":"                ast.context_param_symbols().?.append(symbol) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  408","line":"                symbol.defined = true;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  409","line":"                symbol.param = true;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  410","line":"            }","class":"linePartCov","hits":"2","order":"1827","possible_hits":"4",},
{"lineNum":"  411","line":"        },"},
{"lineNum":"  412","line":"    }"},
{"lineNum":"  413","line":"}"},
{"lineNum":"  414","line":""},
{"lineNum":"  415","line":"fn in_loop_check(self: Self, ast: *ast_.AST, errors: *errs_.Errors) Error!void {","class":"lineCov","hits":"2","order":"6679","possible_hits":"2",},
{"lineNum":"  416","line":"    if (!self.in_loop) {","class":"lineCov","hits":"1","order":"6680","possible_hits":"1",},
{"lineNum":"  417","line":"        errors.add_error(errs_.Error{ .not_inside_loop = .{","class":"lineCov","hits":"2","order":"6681","possible_hits":"2",},
{"lineNum":"  418","line":"            .span = ast.token().span,","class":"lineCov","hits":"1","order":"6682","possible_hits":"1",},
{"lineNum":"  419","line":"            .name = @tagName(ast.*),","class":"lineCov","hits":"3","order":"6683","possible_hits":"3",},
{"lineNum":"  420","line":"        } });"},
{"lineNum":"  421","line":"        return error.CompileError;","class":"linePartCov","hits":"1","order":"6684","possible_hits":"3",},
{"lineNum":"  422","line":"    }"},
{"lineNum":"  423","line":"}"},
{"lineNum":"  424","line":""},
{"lineNum":"  425","line":"/// Returns the inner symbol of a scope, or an error if one doesnt exist"},
{"lineNum":"  426","line":"fn in_function_check(ast: *ast_.AST, scope: *Scope, errors: *errs_.Errors) Error!*Symbol {","class":"lineCov","hits":"2","order":"1905","possible_hits":"2",},
{"lineNum":"  427","line":"    if (scope.inner_function == null) {","class":"lineCov","hits":"1","order":"1906","possible_hits":"1",},
{"lineNum":"  428","line":"        errors.add_error(errs_.Error{ .not_inside_function = .{","class":"lineCov","hits":"2","order":"6796","possible_hits":"2",},
{"lineNum":"  429","line":"            .span = ast.token().span,","class":"lineCov","hits":"1","order":"6797","possible_hits":"1",},
{"lineNum":"  430","line":"            .name = @tagName(ast.*),","class":"lineCov","hits":"3","order":"6798","possible_hits":"3",},
{"lineNum":"  431","line":"        } });"},
{"lineNum":"  432","line":"        return error.CompileError;","class":"lineCov","hits":"1","order":"6799","possible_hits":"1",},
{"lineNum":"  433","line":"    } else {"},
{"lineNum":"  434","line":"        return scope.inner_function.?;","class":"lineCov","hits":"2","order":"1907","possible_hits":"2",},
{"lineNum":"  435","line":"    }"},
{"lineNum":"  436","line":"}"},
{"lineNum":"  437","line":""},
{"lineNum":"  438","line":"/// Creates symbols from a given pattern, declaration, type, and initializer within the given scope."},
{"lineNum":"  439","line":"fn create_symbol("},
{"lineNum":"  440","line":"    symbols: *std.array_list.Managed(*Symbol), // Mutable list that accumulates all the created symbols for a given scope, to be put() later."},
{"lineNum":"  441","line":"    pattern: *ast_.AST, // Represents the pattern being matched; processed recursively to create symbols."},
{"lineNum":"  442","line":"    decl: ?*ast_.AST, // Potential decl AST to be given to symbols."},
{"lineNum":"  443","line":"    _type: *Type_AST, // Type of the current pattern."},
{"lineNum":"  444","line":"    init: ?*ast_.AST, // The value being matched on. Null for function parameter symbols."},
{"lineNum":"  445","line":"    scope: *Scope,"},
{"lineNum":"  446","line":"    errors: *errs_.Errors,"},
{"lineNum":"  447","line":"    allocator: std.mem.Allocator,"},
{"lineNum":"  448","line":") Error!void {","class":"lineCov","hits":"2","order":"1786","possible_hits":"2",},
{"lineNum":"  449","line":"    switch (pattern.*) {","class":"linePartCov","hits":"1","order":"1787","possible_hits":"3",},
{"lineNum":"  450","line":"        .pattern_symbol => {"},
{"lineNum":"  451","line":"            if (std.mem.eql(u8, pattern.pattern_symbol.name, \"_\")) {","class":"lineCov","hits":"2","order":"1788","possible_hits":"2",},
{"lineNum":"  452","line":"                if (pattern.pattern_symbol.kind != .let) {","class":"lineCov","hits":"2","order":"5979","possible_hits":"2",},
{"lineNum":"  453","line":"                    // It is an error for `_` to be marked as `const` or `mut`"},
{"lineNum":"  454","line":"                    errors.add_error(errs_.Error{ .discard_marked = .{","class":"lineCov","hits":"2","order":"5980","possible_hits":"2",},
{"lineNum":"  455","line":"                        .span = pattern.token().span,","class":"lineCov","hits":"1","order":"5981","possible_hits":"1",},
{"lineNum":"  456","line":"                        .kind = pattern.pattern_symbol.kind,","class":"lineCov","hits":"3","order":"5982","possible_hits":"3",},
{"lineNum":"  457","line":"                    } });"},
{"lineNum":"  458","line":"                    return error.CompileError;","class":"lineCov","hits":"1","order":"5983","possible_hits":"1",},
{"lineNum":"  459","line":"                } else {"},
{"lineNum":"  460","line":"                    // Register the symbol of the symbol pattern as the blackhole symbol, but do not append"},
{"lineNum":"  461","line":"                    pattern.set_symbol(prelude_.blackhole);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  462","line":"                    return;","class":"linePartCov","hits":"1","order":"1789","possible_hits":"2",},
{"lineNum":"  463","line":"                }"},
{"lineNum":"  464","line":"            }"},
{"lineNum":"  465","line":""},
{"lineNum":"  466","line":"            if (pattern.symbol()) |sym| {","class":"lineCov","hits":"2","order":"1790","possible_hits":"2",},
{"lineNum":"  467","line":"                symbols.append(sym) catch unreachable;","class":"lineCov","hits":"2","order":"4886","possible_hits":"2",},
{"lineNum":"  468","line":"                return;","class":"lineCov","hits":"1","order":"1791","possible_hits":"1",},
{"lineNum":"  469","line":"            }"},
{"lineNum":"  470","line":""},
{"lineNum":"  471","line":"            const symbol = Symbol.init(","class":"lineCov","hits":"1","order":"1796","possible_hits":"1",},
{"lineNum":"  472","line":"                scope,"},
{"lineNum":"  473","line":"                pattern.pattern_symbol.name,","class":"lineCov","hits":"3","order":"1792","possible_hits":"3",},
{"lineNum":"  474","line":"                ast_.AST.create_decl(pattern.token(), pattern, _type, init, allocator),","class":"lineCov","hits":"1","order":"1793","possible_hits":"1",},
{"lineNum":"  475","line":"                pattern.pattern_symbol.kind,","class":"lineCov","hits":"3","order":"1794","possible_hits":"3",},
{"lineNum":"  476","line":"                pattern.pattern_symbol.storage,","class":"lineCov","hits":"3","order":"1795","possible_hits":"3",},
{"lineNum":"  477","line":"                allocator,"},
{"lineNum":"  478","line":"            );"},
{"lineNum":"  479","line":"            pattern.set_symbol(symbol);","class":"lineCov","hits":"1","order":"1797","possible_hits":"1",},
{"lineNum":"  480","line":"            symbols.append(symbol) catch unreachable;","class":"lineCov","hits":"2","order":"1798","possible_hits":"2",},
{"lineNum":"  481","line":"        },"},
{"lineNum":"  482","line":"        .tuple_value, .array_value => {"},
{"lineNum":"  483","line":"            for (pattern.children().items, 0..) |term, i| {","class":"lineCov","hits":"3","order":"6120","possible_hits":"3",},
{"lineNum":"  484","line":"                const index = ast_.AST.create_int(pattern.token(), i, allocator);","class":"lineCov","hits":"1","order":"6121","possible_hits":"1",},
{"lineNum":"  485","line":"                const new_type: *Type_AST = Type_AST.create_index_type(_type.token(), _type, index, allocator);","class":"lineCov","hits":"1","order":"6122","possible_hits":"1",},
{"lineNum":"  486","line":"                var index_rhs = std.array_list.Managed(*ast_.AST).init(allocator);","class":"lineCov","hits":"1","order":"6125","possible_hits":"1",},
{"lineNum":"  487","line":"                index_rhs.append(index) catch unreachable;","class":"lineCov","hits":"2","order":"6126","possible_hits":"2",},
{"lineNum":"  488","line":"                const new_init: *ast_.AST = ast_.AST.create_index(init.?.token(), init.?, index_rhs, allocator);","class":"lineCov","hits":"3","order":"6127","possible_hits":"3",},
{"lineNum":"  489","line":"                try create_symbol(symbols, term, decl, new_type, new_init, scope, errors, allocator);","class":"linePartCov","hits":"1","order":"6128","possible_hits":"2",},
{"lineNum":"  490","line":"            }","class":"lineCov","hits":"4","order":"6129","possible_hits":"4",},
{"lineNum":"  491","line":"        },"},
{"lineNum":"  492","line":"        .enum_value => {"},
{"lineNum":"  493","line":"            const lhs_type = Type_AST.create_type_of(pattern.token(), init.?, allocator);","class":"lineCov","hits":"3","order":"6024","possible_hits":"3",},
{"lineNum":"  494","line":"            const rhs_type = Type_AST.create_domain_of(pattern.token(), lhs_type, pattern.enum_value.get_name(), allocator);","class":"lineCov","hits":"3","order":"6025","possible_hits":"3",},
{"lineNum":"  495","line":""},
{"lineNum":"  496","line":"            if (pattern.enum_value.init != null) {","class":"lineCov","hits":"2","order":"6031","possible_hits":"2",},
{"lineNum":"  497","line":"                // Here init is null!"},
{"lineNum":"  498","line":"                try create_symbol(symbols, pattern.enum_value.init.?, decl, rhs_type, pattern.enum_value.init.?, scope, errors, allocator);","class":"linePartCov","hits":"2","order":"6032","possible_hits":"3",},
{"lineNum":"  499","line":"            }"},
{"lineNum":"  500","line":"        },"},
{"lineNum":"  501","line":""},
{"lineNum":"  502","line":"        // Likely literals etc, for `match` mappings"},
{"lineNum":"  503","line":"        else => {},"},
{"lineNum":"  504","line":"    }"},
{"lineNum":"  505","line":"}"},
{"lineNum":"  506","line":""},
{"lineNum":"  507","line":"/// Creates and initializes pattern symbols for each mapping in a match expression, defining the symbols within the"},
{"lineNum":"  508","line":"/// mapping\'s scope."},
{"lineNum":"  509","line":"fn create_match_pattern_symbol(match: *ast_.AST, scope: *Scope, errors: *errs_.Errors, allocator: std.mem.Allocator) Error!void {","class":"lineCov","hits":"2","order":"6015","possible_hits":"2",},
{"lineNum":"  510","line":"    for (match.children().items) |mapping| {","class":"lineCov","hits":"3","order":"6016","possible_hits":"3",},
{"lineNum":"  511","line":"        const new_scope = Scope.init(scope, scope.uid_gen, allocator);","class":"lineCov","hits":"1","order":"6017","possible_hits":"1",},
{"lineNum":"  512","line":"        mapping.set_scope(new_scope);","class":"lineCov","hits":"1","order":"6018","possible_hits":"1",},
{"lineNum":"  513","line":"        var symbols = std.array_list.Managed(*Symbol).init(allocator);","class":"lineCov","hits":"1","order":"6019","possible_hits":"1",},
{"lineNum":"  514","line":"        defer symbols.deinit();","class":"linePartCov","hits":"1","order":"6039","possible_hits":"4",},
{"lineNum":"  515","line":"        const match_expr = match.expr();","class":"lineCov","hits":"1","order":"6020","possible_hits":"1",},
{"lineNum":"  516","line":"        const match_expr_token = match_expr.token();","class":"lineCov","hits":"1","order":"6021","possible_hits":"1",},
{"lineNum":"  517","line":"        const _type = Type_AST.create_type_of(match_expr_token, match_expr, allocator);","class":"lineCov","hits":"1","order":"6022","possible_hits":"1",},
{"lineNum":"  518","line":"        try create_symbol(&symbols, mapping.lhs(), null, _type, match_expr, new_scope, errors, allocator);","class":"linePartCov","hits":"1","order":"6023","possible_hits":"2",},
{"lineNum":"  519","line":"        for (symbols.items) |symbol| {","class":"linePartCov","hits":"2","order":"6033","possible_hits":"3",},
{"lineNum":"  520","line":"            symbol.defined = true;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  521","line":"        }","class":"linePartCov","hits":"1","order":"6034","possible_hits":"3",},
{"lineNum":"  522","line":"        for (symbols.items) |symbol| {","class":"linePartCov","hits":"2","order":"6035","possible_hits":"3",},
{"lineNum":"  523","line":"            mapping.mapping.captures.append(symbol.decl.?) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  524","line":"        }","class":"linePartCov","hits":"1","order":"6036","possible_hits":"2",},
{"lineNum":"  525","line":"        try new_scope.put_all_symbols(&symbols, errors);","class":"linePartCov","hits":"1","order":"6037","possible_hits":"2",},
{"lineNum":"  526","line":"        try walk_.walk_ast(mapping.rhs(), Self.new(new_scope, errors, allocator));","class":"linePartCov","hits":"1","order":"6038","possible_hits":"2",},
{"lineNum":"  527","line":"    }","class":"lineCov","hits":"4","order":"6040","possible_hits":"4",},
{"lineNum":"  528","line":"}"},
{"lineNum":"  529","line":""},
{"lineNum":"  530","line":"pub fn create_function_symbol(ast: *ast_.AST, allocator: std.mem.Allocator) *Symbol {","class":"lineCov","hits":"2","order":"4464","possible_hits":"2",},
{"lineNum":"  531","line":"    // Calculate the domain type from the function paramter types"},
{"lineNum":"  532","line":"    const domain = extract_domain(ast.children().*, allocator);","class":"lineCov","hits":"1","order":"4465","possible_hits":"1",},
{"lineNum":"  533","line":""},
{"lineNum":"  534","line":"    var contexts = std.array_list.Managed(*Type_AST).init(allocator);","class":"lineCov","hits":"1","order":"4467","possible_hits":"1",},
{"lineNum":"  535","line":"    for (ast.fn_decl.context_decls.items) |ctx| {","class":"lineCov","hits":"3","order":"4468","possible_hits":"3",},
{"lineNum":"  536","line":"        contexts.append(ctx.context_value_decl.parent) catch unreachable;","class":"lineCov","hits":"2","order":"4984","possible_hits":"2",},
{"lineNum":"  537","line":"    }","class":"lineCov","hits":"2","order":"4469","possible_hits":"2",},
{"lineNum":"  538","line":""},
{"lineNum":"  539","line":"    // Create the function type"},
{"lineNum":"  540","line":"    const _type = Type_AST.create_function(","class":"lineCov","hits":"1","order":"4472","possible_hits":"1",},
{"lineNum":"  541","line":"        ast.fn_decl.ret_type.token(),","class":"lineCov","hits":"3","order":"4470","possible_hits":"3",},
{"lineNum":"  542","line":"        domain,"},
{"lineNum":"  543","line":"        ast.fn_decl.ret_type,","class":"lineCov","hits":"3","order":"4471","possible_hits":"3",},
{"lineNum":"  544","line":"        contexts,"},
{"lineNum":"  545","line":"        allocator,"},
{"lineNum":"  546","line":"    );"},
{"lineNum":"  547","line":"    ast.fn_decl._decl_type = _type;","class":"lineCov","hits":"3","order":"4473","possible_hits":"3",},
{"lineNum":"  548","line":""},
{"lineNum":"  549","line":"    // Choose name (maybe anon)"},
{"lineNum":"  550","line":"    var buf: []const u8 = undefined;","class":"lineCov","hits":"1","order":"4474","possible_hits":"1",},
{"lineNum":"  551","line":"    if (ast.fn_decl.name) |name| {","class":"lineCov","hits":"2","order":"4475","possible_hits":"2",},
{"lineNum":"  552","line":"        buf = name.token().data;","class":"lineCov","hits":"1","order":"4476","possible_hits":"1",},
{"lineNum":"  553","line":"    } else {"},
{"lineNum":"  554","line":"        buf = next_anon_name(\"anon\", allocator);","class":"lineCov","hits":"1","order":"6212","possible_hits":"1",},
{"lineNum":"  555","line":"    }"},
{"lineNum":"  556","line":""},
{"lineNum":"  557","line":"    // Create the symbol"},
{"lineNum":"  558","line":"    const retval = Symbol.init(","class":"lineCov","hits":"1","order":"4478","possible_hits":"1",},
{"lineNum":"  559","line":"        ast.scope().?,","class":"lineCov","hits":"3","order":"4477","possible_hits":"3",},
{"lineNum":"  560","line":"        buf,"},
{"lineNum":"  561","line":"        ast,"},
{"lineNum":"  562","line":"        .@\"fn\","},
{"lineNum":"  563","line":"        .local,"},
{"lineNum":"  564","line":"        allocator,"},
{"lineNum":"  565","line":"    );"},
{"lineNum":"  566","line":"    ast.scope().?.inner_function = retval;","class":"lineCov","hits":"3","order":"4479","possible_hits":"3",},
{"lineNum":"  567","line":"    return retval;","class":"lineCov","hits":"1","order":"4480","possible_hits":"1",},
{"lineNum":"  568","line":"}"},
{"lineNum":"  569","line":""},
{"lineNum":"  570","line":"pub fn create_test_symbol(ast: *ast_.AST, allocator: std.mem.Allocator) Error!*Symbol {","class":"lineCov","hits":"2","order":"5077","possible_hits":"2",},
{"lineNum":"  571","line":"    var contexts = std.array_list.Managed(*Type_AST).init(allocator);","class":"lineCov","hits":"1","order":"5078","possible_hits":"1",},
{"lineNum":"  572","line":"    for (ast.@\"test\".context_decls.items) |ctx| {","class":"lineCov","hits":"3","order":"5079","possible_hits":"3",},
{"lineNum":"  573","line":"        contexts.append(ctx.context_value_decl.parent) catch unreachable;","class":"lineCov","hits":"2","order":"5080","possible_hits":"2",},
{"lineNum":"  574","line":"    }","class":"lineCov","hits":"2","order":"5081","possible_hits":"2",},
{"lineNum":"  575","line":""},
{"lineNum":"  576","line":"    const _type = Type_AST.create_function(","class":"lineCov","hits":"1","order":"5085","possible_hits":"1",},
{"lineNum":"  577","line":"        ast.token(),","class":"lineCov","hits":"1","order":"5082","possible_hits":"1",},
{"lineNum":"  578","line":"        prelude_.unit_type,","class":"lineCov","hits":"1","order":"5083","possible_hits":"1",},
{"lineNum":"  579","line":"        core_.test_result_type,","class":"lineCov","hits":"1","order":"5084","possible_hits":"1",},
{"lineNum":"  580","line":"        contexts,"},
{"lineNum":"  581","line":"        allocator,"},
{"lineNum":"  582","line":"    );"},
{"lineNum":"  583","line":"    ast.@\"test\"._decl_type = _type;","class":"lineCov","hits":"3","order":"5086","possible_hits":"3",},
{"lineNum":"  584","line":""},
{"lineNum":"  585","line":"    // Choose name (maybe anon)"},
{"lineNum":"  586","line":"    const buf: []const u8 = next_anon_name(\"test\", allocator);","class":"lineCov","hits":"1","order":"5087","possible_hits":"1",},
{"lineNum":"  587","line":"    const retval = Symbol.init(","class":"lineCov","hits":"1","order":"5089","possible_hits":"1",},
{"lineNum":"  588","line":"        ast.scope().?,","class":"lineCov","hits":"2","order":"5088","possible_hits":"2",},
{"lineNum":"  589","line":"        buf,"},
{"lineNum":"  590","line":"        ast,"},
{"lineNum":"  591","line":"        .@\"test\","},
{"lineNum":"  592","line":"        .local,"},
{"lineNum":"  593","line":"        allocator,"},
{"lineNum":"  594","line":"    );"},
{"lineNum":"  595","line":"    ast.scope().?.inner_function = retval;","class":"lineCov","hits":"3","order":"5090","possible_hits":"3",},
{"lineNum":"  596","line":""},
{"lineNum":"  597","line":"    return retval;","class":"lineCov","hits":"1","order":"5091","possible_hits":"1",},
{"lineNum":"  598","line":"}"},
{"lineNum":"  599","line":""},
{"lineNum":"  600","line":"var num_anons: usize = 0;"},
{"lineNum":"  601","line":"pub fn next_anon_name(class: []const u8, allocator: std.mem.Allocator) []const u8 {","class":"lineCov","hits":"2","order":"1711","possible_hits":"2",},
{"lineNum":"  602","line":"    defer num_anons += 1;","class":"linePartCov","hits":"1","order":"1716","possible_hits":"2",},
{"lineNum":"  603","line":"    var out = std.array_list.Managed(u8).init(allocator);","class":"lineCov","hits":"1","order":"1712","possible_hits":"1",},
{"lineNum":"  604","line":"    defer out.deinit();","class":"lineCov","hits":"1","order":"1715","possible_hits":"1",},
{"lineNum":"  605","line":"    out.print(\"{s}__{}\", .{ class, num_anons }) catch unreachable;","class":"lineCov","hits":"2","order":"1713","possible_hits":"2",},
{"lineNum":"  606","line":"    return out.toOwnedSlice() catch unreachable;","class":"lineCov","hits":"3","order":"1714","possible_hits":"3",},
{"lineNum":"  607","line":"}"},
{"lineNum":"  608","line":""},
{"lineNum":"  609","line":"pub fn extract_domain(params: std.array_list.Managed(*ast_.AST), allocator: std.mem.Allocator) *Type_AST {","class":"lineCov","hits":"2","order":"1758","possible_hits":"2",},
{"lineNum":"  610","line":"    if (params.items.len == 0) {","class":"lineCov","hits":"1","order":"1759","possible_hits":"1",},
{"lineNum":"  611","line":"        return prelude_.unit_type;","class":"lineCov","hits":"1","order":"4466","possible_hits":"1",},
{"lineNum":"  612","line":"    } else if (params.items.len <= 1) {","class":"lineCov","hits":"1","order":"1760","possible_hits":"1",},
{"lineNum":"  613","line":"        return Type_AST.create_annotation(","class":"lineCov","hits":"1","order":"1765","possible_hits":"1",},
{"lineNum":"  614","line":"            params.items[0].token(),","class":"lineCov","hits":"3","order":"1761","possible_hits":"3",},
{"lineNum":"  615","line":"            params.items[0].binding.pattern,","class":"lineCov","hits":"3","order":"1762","possible_hits":"3",},
{"lineNum":"  616","line":"            params.items[0].binding.type,","class":"lineCov","hits":"3","order":"1763","possible_hits":"3",},
{"lineNum":"  617","line":"            params.items[0].binding.init,","class":"lineCov","hits":"3","order":"1764","possible_hits":"3",},
{"lineNum":"  618","line":"            allocator,"},
{"lineNum":"  619","line":"        );"},
{"lineNum":"  620","line":"    } else {"},
{"lineNum":"  621","line":"        std.debug.assert(params.items.len >= 2);","class":"lineCov","hits":"1","order":"4487","possible_hits":"1",},
{"lineNum":"  622","line":"        var param_types = std.array_list.Managed(*Type_AST).init(allocator);","class":"lineCov","hits":"1","order":"4488","possible_hits":"1",},
{"lineNum":"  623","line":"        return build_paramlist(params, &param_types, allocator);","class":"lineCov","hits":"1","order":"4489","possible_hits":"1",},
{"lineNum":"  624","line":"    }"},
{"lineNum":"  625","line":"}"},
{"lineNum":"  626","line":""},
{"lineNum":"  627","line":"fn extract_domain_with_receiver(impl_type: *Type_AST, receiver: *ast_.AST, params: std.array_list.Managed(*ast_.AST), allocator: std.mem.Allocator) *Type_AST {","class":"lineCov","hits":"2","order":"1829","possible_hits":"2",},
{"lineNum":"  628","line":"    const receiver_addr_type = create_receiver_addr(impl_type, receiver, allocator);","class":"lineCov","hits":"1","order":"1830","possible_hits":"1",},
{"lineNum":"  629","line":"    receiver.receiver._type = receiver_addr_type;","class":"lineCov","hits":"2","order":"1835","possible_hits":"2",},
{"lineNum":"  630","line":"    const _receiver_type = create_receiver_annot(receiver_addr_type, receiver, allocator);","class":"lineCov","hits":"1","order":"1836","possible_hits":"1",},
{"lineNum":"  631","line":"    if (params.items.len == 0) {","class":"lineCov","hits":"1","order":"1840","possible_hits":"1",},
{"lineNum":"  632","line":"        return _receiver_type;","class":"lineCov","hits":"1","order":"1908","possible_hits":"1",},
{"lineNum":"  633","line":"    } else {"},
{"lineNum":"  634","line":"        var param_types = std.array_list.Managed(*Type_AST).init(allocator);","class":"lineCov","hits":"1","order":"1841","possible_hits":"1",},
{"lineNum":"  635","line":"        param_types.append(_receiver_type) catch unreachable;","class":"lineCov","hits":"2","order":"1842","possible_hits":"2",},
{"lineNum":"  636","line":"        return build_paramlist(params, &param_types, allocator);","class":"lineCov","hits":"1","order":"1843","possible_hits":"1",},
{"lineNum":"  637","line":"    }"},
{"lineNum":"  638","line":"}"},
{"lineNum":"  639","line":""},
{"lineNum":"  640","line":"fn build_paramlist(params: std.array_list.Managed(*ast_.AST), param_types: *std.array_list.Managed(*Type_AST), allocator: std.mem.Allocator) *Type_AST {","class":"lineCov","hits":"2","order":"1844","possible_hits":"2",},
{"lineNum":"  641","line":"    for (0..params.items.len) |i| {","class":"lineCov","hits":"3","order":"1845","possible_hits":"3",},
{"lineNum":"  642","line":"        param_types.append(Type_AST.create_annotation(","class":"lineCov","hits":"3","order":"1846","possible_hits":"3",},
{"lineNum":"  643","line":"            params.items[i].token(),","class":"lineCov","hits":"3","order":"1847","possible_hits":"3",},
{"lineNum":"  644","line":"            params.items[i].binding.pattern,","class":"lineCov","hits":"3","order":"1848","possible_hits":"3",},
{"lineNum":"  645","line":"            params.items[i].binding.type,","class":"lineCov","hits":"3","order":"1849","possible_hits":"3",},
{"lineNum":"  646","line":"            params.items[i].binding.init,","class":"lineCov","hits":"3","order":"1850","possible_hits":"3",},
{"lineNum":"  647","line":"            allocator,"},
{"lineNum":"  648","line":"        )) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  649","line":"    }","class":"lineCov","hits":"2","order":"1851","possible_hits":"2",},
{"lineNum":"  650","line":"    const retval = Type_AST.create_tuple_type(params.items[0].token(), param_types.*, allocator);","class":"lineCov","hits":"3","order":"1852","possible_hits":"3",},
{"lineNum":"  651","line":"    return retval;","class":"lineCov","hits":"1","order":"1855","possible_hits":"1",},
{"lineNum":"  652","line":"}"},
{"lineNum":"  653","line":""},
{"lineNum":"  654","line":"fn create_receiver_addr(impl_type: *Type_AST, receiver: *ast_.AST, allocator: std.mem.Allocator) *Type_AST {","class":"lineCov","hits":"2","order":"1831","possible_hits":"2",},
{"lineNum":"  655","line":"    if (impl_type.* == .anyptr_type) return impl_type; // If the type is already an anyptr, then dont make it an address too","class":"lineCov","hits":"2","order":"1832","possible_hits":"2",},
{"lineNum":"  656","line":"    return switch (receiver.receiver.kind) {","class":"linePartCov","hits":"2","order":"1833","possible_hits":"3",},
{"lineNum":"  657","line":"        .value, .addr_of => Type_AST.create_addr_of_type(receiver.token(), impl_type, false, false, allocator),","class":"lineCov","hits":"1","order":"5272","possible_hits":"1",},
{"lineNum":"  658","line":"        .mut_addr_of => Type_AST.create_addr_of_type(receiver.token(), impl_type, true, false, allocator),","class":"lineCov","hits":"1","order":"1834","possible_hits":"1",},
{"lineNum":"  659","line":"    };"},
{"lineNum":"  660","line":"}"},
{"lineNum":"  661","line":""},
{"lineNum":"  662","line":"fn create_receiver_annot(receiver_addr: *Type_AST, receiver: *ast_.AST, allocator: std.mem.Allocator) *Type_AST {","class":"lineCov","hits":"2","order":"1837","possible_hits":"2",},
{"lineNum":"  663","line":"    return Type_AST.create_annotation(","class":"lineCov","hits":"1","order":"1839","possible_hits":"1",},
{"lineNum":"  664","line":"        receiver.token(),","class":"lineCov","hits":"1","order":"1838","possible_hits":"1",},
{"lineNum":"  665","line":"        receiver,"},
{"lineNum":"  666","line":"        receiver_addr,"},
{"lineNum":"  667","line":"        null,"},
{"lineNum":"  668","line":"        allocator,"},
{"lineNum":"  669","line":"    );"},
{"lineNum":"  670","line":"}"},
{"lineNum":"  671","line":""},
{"lineNum":"  672","line":"/// Creates a symbol which represents the comptime function to be ran."},
{"lineNum":"  673","line":"pub fn create_temp_comptime_symbol("},
{"lineNum":"  674","line":"    ast: *ast_.AST,"},
{"lineNum":"  675","line":"    rhs_type_hint: ?*Type_AST,"},
{"lineNum":"  676","line":"    scope: *Scope,"},
{"lineNum":"  677","line":"    allocator: std.mem.Allocator,"},
{"lineNum":"  678","line":") Error!*Symbol {","class":"lineCov","hits":"2","order":"2434","possible_hits":"2",},
{"lineNum":"  679","line":"    // Create the function type. The rhs is a typeof node, since type expansion is done in a later time"},
{"lineNum":"  680","line":"    const lhs = prelude_.unit_type;","class":"lineCov","hits":"1","order":"2435","possible_hits":"1",},
{"lineNum":"  681","line":"    const rhs = Type_AST.create_type_of(ast.token(), ast, allocator);","class":"lineCov","hits":"1","order":"2436","possible_hits":"1",},
{"lineNum":"  682","line":"    const _type = Type_AST.create_function(","class":"lineCov","hits":"1","order":"2439","possible_hits":"1",},
{"lineNum":"  683","line":"        ast.token(),","class":"lineCov","hits":"2","order":"2437","possible_hits":"2",},
{"lineNum":"  684","line":"        lhs,"},
{"lineNum":"  685","line":"        rhs_type_hint orelse rhs,"},
{"lineNum":"  686","line":"        std.array_list.Managed(*Type_AST).init(allocator),","class":"lineCov","hits":"1","order":"2438","possible_hits":"1",},
{"lineNum":"  687","line":"        allocator,"},
{"lineNum":"  688","line":"    );"},
{"lineNum":"  689","line":""},
{"lineNum":"  690","line":"    // Create the comptime scope"},
{"lineNum":"  691","line":"    // This is to prevent `comptime` expressions from using runtime variables"},
{"lineNum":"  692","line":"    var comptime_scope = Scope.init(scope, scope.uid_gen, allocator);","class":"lineCov","hits":"1","order":"2440","possible_hits":"1",},
{"lineNum":"  693","line":"    comptime_scope.function_depth = scope.function_depth + 1;","class":"linePartCov","hits":"1","order":"2441","possible_hits":"2",},
{"lineNum":"  694","line":""},
{"lineNum":"  695","line":"    // Choose name"},
{"lineNum":"  696","line":"    var buf: []const u8 = undefined;","class":"lineCov","hits":"1","order":"2442","possible_hits":"1",},
{"lineNum":"  697","line":"    buf = next_anon_name(\"comptime\", allocator);","class":"lineCov","hits":"1","order":"2443","possible_hits":"1",},
{"lineNum":"  698","line":""},
{"lineNum":"  699","line":"    const decl = ast_.AST.create_decl(","class":"lineCov","hits":"1","order":"2447","possible_hits":"1",},
{"lineNum":"  700","line":"        ast.token(),","class":"lineCov","hits":"1","order":"2444","possible_hits":"1",},
{"lineNum":"  701","line":"        ast_.AST.create_pattern_symbol(","class":"lineCov","hits":"1","order":"2446","possible_hits":"1",},
{"lineNum":"  702","line":"            ast.token(),","class":"lineCov","hits":"1","order":"2445","possible_hits":"1",},
{"lineNum":"  703","line":"            .@\"comptime\","},
{"lineNum":"  704","line":"            .local,"},
{"lineNum":"  705","line":"            buf,"},
{"lineNum":"  706","line":"            allocator,"},
{"lineNum":"  707","line":"        ),"},
{"lineNum":"  708","line":"        _type,"},
{"lineNum":"  709","line":"        ast,"},
{"lineNum":"  710","line":"        allocator,"},
{"lineNum":"  711","line":"    );"},
{"lineNum":"  712","line":""},
{"lineNum":"  713","line":"    // Create the symbol"},
{"lineNum":"  714","line":"    const retval = Symbol.init(","class":"lineCov","hits":"1","order":"2448","possible_hits":"1",},
{"lineNum":"  715","line":"        comptime_scope,"},
{"lineNum":"  716","line":"        buf,"},
{"lineNum":"  717","line":"        decl,"},
{"lineNum":"  718","line":"        .@\"comptime\","},
{"lineNum":"  719","line":"        .local,"},
{"lineNum":"  720","line":"        allocator,"},
{"lineNum":"  721","line":"    );"},
{"lineNum":"  722","line":"    comptime_scope.inner_function = retval;","class":"lineCov","hits":"1","order":"2449","possible_hits":"1",},
{"lineNum":"  723","line":""},
{"lineNum":"  724","line":"    return retval;","class":"lineCov","hits":"1","order":"2450","possible_hits":"1",},
{"lineNum":"  725","line":"}"},
{"lineNum":"  726","line":""},
{"lineNum":"  727","line":"fn create_trait_symbol("},
{"lineNum":"  728","line":"    ast: *ast_.AST,"},
{"lineNum":"  729","line":"    scope: *Scope,"},
{"lineNum":"  730","line":"    allocator: std.mem.Allocator,"},
{"lineNum":"  731","line":") Error!*Symbol {","class":"lineCov","hits":"2","order":"1730","possible_hits":"2",},
{"lineNum":"  732","line":"    // Create the symbol"},
{"lineNum":"  733","line":"    const retval = Symbol.init(","class":"lineCov","hits":"1","order":"1732","possible_hits":"1",},
{"lineNum":"  734","line":"        scope,"},
{"lineNum":"  735","line":"        ast.token().data,","class":"lineCov","hits":"1","order":"1731","possible_hits":"1",},
{"lineNum":"  736","line":"        ast,"},
{"lineNum":"  737","line":"        .trait,"},
{"lineNum":"  738","line":"        .local,"},
{"lineNum":"  739","line":"        allocator,"},
{"lineNum":"  740","line":"    );"},
{"lineNum":"  741","line":"    retval.defined = true;","class":"lineCov","hits":"1","order":"1733","possible_hits":"1",},
{"lineNum":"  742","line":"    return retval;","class":"lineCov","hits":"1","order":"1734","possible_hits":"1",},
{"lineNum":"  743","line":"}"},
{"lineNum":"  744","line":""},
{"lineNum":"  745","line":"fn create_method_type(ast: *ast_.AST, allocator: std.mem.Allocator) *Type_AST {","class":"lineCov","hits":"2","order":"1752","possible_hits":"2",},
{"lineNum":"  746","line":"    const receiver_base_type: *Type_AST = if (ast.method_decl.impl != null)","class":"lineCov","hits":"2","order":"1753","possible_hits":"2",},
{"lineNum":"  747","line":"        ast.method_decl.impl.?.impl._type","class":"lineCov","hits":"2","order":"1754","possible_hits":"2",},
{"lineNum":"  748","line":"    else"},
{"lineNum":"  749","line":"        Type_AST.create_anyptr_type(ast.token(), allocator);","class":"lineCov","hits":"2","order":"1755","possible_hits":"2",},
{"lineNum":"  750","line":""},
{"lineNum":"  751","line":"    // Calculate the domain type from the function paramter types"},
{"lineNum":"  752","line":"    ast.method_decl.domain = if (ast.method_decl.receiver) |receiver|","class":"lineCov","hits":"3","order":"1756","possible_hits":"3",},
{"lineNum":"  753","line":"        extract_domain_with_receiver(receiver_base_type, receiver, ast.children().*, allocator)","class":"lineCov","hits":"1","order":"1828","possible_hits":"1",},
{"lineNum":"  754","line":"    else"},
{"lineNum":"  755","line":"        extract_domain(ast.children().*, allocator);","class":"lineCov","hits":"2","order":"1757","possible_hits":"2",},
{"lineNum":"  756","line":""},
{"lineNum":"  757","line":"    var contexts = std.array_list.Managed(*Type_AST).init(allocator);","class":"lineCov","hits":"1","order":"1766","possible_hits":"1",},
{"lineNum":"  758","line":"    for (ast.method_decl.context_decls.items) |ctx| {","class":"linePartCov","hits":"3","order":"1767","possible_hits":"4",},
{"lineNum":"  759","line":"        contexts.append(ctx.context_value_decl.parent) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  760","line":"    }","class":"linePartCov","hits":"1","order":"1768","possible_hits":"2",},
{"lineNum":"  761","line":""},
{"lineNum":"  762","line":"    // Create the function type"},
{"lineNum":"  763","line":"    const _type = Type_AST.create_function(","class":"lineCov","hits":"1","order":"1772","possible_hits":"1",},
{"lineNum":"  764","line":"        ast.method_decl.ret_type.token(),","class":"lineCov","hits":"3","order":"1769","possible_hits":"3",},
{"lineNum":"  765","line":"        ast.method_decl.domain.?,","class":"lineCov","hits":"3","order":"1770","possible_hits":"3",},
{"lineNum":"  766","line":"        ast.method_decl.ret_type,","class":"lineCov","hits":"3","order":"1771","possible_hits":"3",},
{"lineNum":"  767","line":"        contexts,"},
{"lineNum":"  768","line":"        allocator,"},
{"lineNum":"  769","line":"    );"},
{"lineNum":"  770","line":"    return _type;","class":"lineCov","hits":"1","order":"1776","possible_hits":"1",},
{"lineNum":"  771","line":"}"},
{"lineNum":"  772","line":""},
{"lineNum":"  773","line":"fn create_method_symbol("},
{"lineNum":"  774","line":"    ast: *ast_.AST,"},
{"lineNum":"  775","line":"    errors: *errs_.Errors,"},
{"lineNum":"  776","line":"    allocator: std.mem.Allocator,"},
{"lineNum":"  777","line":") Error!*Symbol {","class":"lineCov","hits":"2","order":"1867","possible_hits":"2",},
{"lineNum":"  778","line":"    const receiver_base_type: *Type_AST = ast.method_decl.impl.?.impl._type;","class":"lineCov","hits":"2","order":"1868","possible_hits":"2",},
{"lineNum":"  779","line":""},
{"lineNum":"  780","line":"    // Create the function type"},
{"lineNum":"  781","line":"    ast.method_decl._decl_type = create_method_type(ast, allocator);","class":"lineCov","hits":"3","order":"1869","possible_hits":"3",},
{"lineNum":"  782","line":""},
{"lineNum":"  783","line":"    if (ast.method_decl.receiver != null) {","class":"lineCov","hits":"2","order":"1870","possible_hits":"2",},
{"lineNum":"  784","line":"        // addr-of receiver, prepend receiver to parameters as normal"},
{"lineNum":"  785","line":"        const recv_type = create_receiver_addr(receiver_base_type, ast.method_decl.receiver.?, allocator);","class":"lineCov","hits":"3","order":"1889","possible_hits":"3",},
{"lineNum":"  786","line":"        recv_type.addr_of.anytptr = true;","class":"lineCov","hits":"3","order":"1890","possible_hits":"3",},
{"lineNum":"  787","line":"        // value receiver, prepend a void* self_ptr parameter"},
{"lineNum":"  788","line":"        const receiver_symbol = Symbol.init(","class":"lineCov","hits":"1","order":"1894","possible_hits":"1",},
{"lineNum":"  789","line":"            ast.scope().?,","class":"lineCov","hits":"2","order":"1891","possible_hits":"2",},
{"lineNum":"  790","line":"            if (ast.method_decl.receiver.?.receiver.kind == .value) \"self__ptr\" else \"self\",","class":"lineCov","hits":"2","order":"1892","possible_hits":"2",},
{"lineNum":"  791","line":"            ast.method_decl.receiver,","class":"lineCov","hits":"3","order":"1893","possible_hits":"3",},
{"lineNum":"  792","line":"            .let,"},
{"lineNum":"  793","line":"            .local,"},
{"lineNum":"  794","line":"            allocator,"},
{"lineNum":"  795","line":"        );"},
{"lineNum":"  796","line":"        receiver_symbol.param = true;","class":"lineCov","hits":"1","order":"1895","possible_hits":"1",},
{"lineNum":"  797","line":"        try ast.scope().?.put_symbol(receiver_symbol, errors);","class":"lineCov","hits":"2","order":"1896","possible_hits":"2",},
{"lineNum":"  798","line":"        ast.param_symbols().?.append(receiver_symbol) catch unreachable;","class":"lineCov","hits":"2","order":"1897","possible_hits":"2",},
{"lineNum":"  799","line":""},
{"lineNum":"  800","line":"        if (ast.method_decl.receiver.?.receiver.kind == .value) {","class":"lineCov","hits":"2","order":"1898","possible_hits":"2",},
{"lineNum":"  801","line":"            const self_type = recv_type.child();","class":"lineCov","hits":"1","order":"6327","possible_hits":"1",},
{"lineNum":"  802","line":"            const self_init = ast_.AST.create_dereference(ast.token(), ast_.AST.create_identifier(Token.init_simple(\"self__ptr\"), allocator), allocator);","class":"lineCov","hits":"1","order":"6328","possible_hits":"1",},
{"lineNum":"  803","line":"            const receiver_span = ast.method_decl.receiver.?.token().span;","class":"lineCov","hits":"3","order":"6329","possible_hits":"3",},
{"lineNum":"  804","line":"            const self_decl = ast_.AST.create_binding(","class":"lineCov","hits":"1","order":"6332","possible_hits":"1",},
{"lineNum":"  805","line":"                ast.token(),","class":"lineCov","hits":"1","order":"6330","possible_hits":"1",},
{"lineNum":"  806","line":"                ast_.AST.create_pattern_symbol(Token.init(\"self\", .identifier, receiver_span.filename, receiver_span.line_text, receiver_span.line_number, receiver_span.col), .let, .local, \"self\", allocator),","class":"lineCov","hits":"1","order":"6331","possible_hits":"1",},
{"lineNum":"  807","line":"                self_type,"},
{"lineNum":"  808","line":"                self_init,"},
{"lineNum":"  809","line":"                allocator,"},
{"lineNum":"  810","line":"            );"},
{"lineNum":"  811","line":"            if (ast.method_decl.init.?.* != .unit_value) {","class":"lineCov","hits":"2","order":"6333","possible_hits":"2",},
{"lineNum":"  812","line":"                const method_block_statements = ast.method_decl.init.?.children();","class":"lineCov","hits":"3","order":"6334","possible_hits":"3",},
{"lineNum":"  813","line":"                method_block_statements.insert(0, self_decl) catch unreachable;","class":"lineCov","hits":"2","order":"6335","possible_hits":"2",},
{"lineNum":"  814","line":"            } else {"},
{"lineNum":"  815","line":"                // Technically, init COULD be `{ }`, and it would cause a not-used error later on, but we need to handle this properly here before then"},
{"lineNum":"  816","line":"                var statements = std.array_list.Managed(*ast_.AST).init(allocator);","class":"lineCov","hits":"1","order":"6477","possible_hits":"1",},
{"lineNum":"  817","line":"                statements.append(self_decl) catch unreachable;","class":"lineCov","hits":"2","order":"6478","possible_hits":"2",},
{"lineNum":"  818","line":"                ast.method_decl.init = ast_.AST.create_block(ast.method_decl.init.?.token(), statements, null, allocator);","class":"lineCov","hits":"6","order":"1871","possible_hits":"6",},
{"lineNum":"  819","line":"            }"},
{"lineNum":"  820","line":"        }"},
{"lineNum":"  821","line":"    }"},
{"lineNum":"  822","line":""},
{"lineNum":"  823","line":"    const retval = Symbol.init(","class":"lineCov","hits":"1","order":"1876","possible_hits":"1",},
{"lineNum":"  824","line":"        ast.scope().?,","class":"lineCov","hits":"2","order":"1872","possible_hits":"2",},
{"lineNum":"  825","line":"        ast.method_decl.name.token().data,","class":"lineCov","hits":"3","order":"1875","possible_hits":"3",},
{"lineNum":"  826","line":"        ast,"},
{"lineNum":"  827","line":"        .@\"fn\","},
{"lineNum":"  828","line":"        .local,"},
{"lineNum":"  829","line":"        allocator,"},
{"lineNum":"  830","line":"    );"},
{"lineNum":"  831","line":"    ast.scope().?.inner_function = retval;","class":"lineCov","hits":"3","order":"1877","possible_hits":"3",},
{"lineNum":"  832","line":""},
{"lineNum":"  833","line":"    return retval;","class":"lineCov","hits":"1","order":"1878","possible_hits":"1",},
{"lineNum":"  834","line":"}"},
]};
var percent_low = 25;var percent_high = 75;
var header = { "command" : "orng-test", "date" : "2025-11-10 15:43:08", "instrumented" : 415, "covered" : 398,};
var merged_data = [];
