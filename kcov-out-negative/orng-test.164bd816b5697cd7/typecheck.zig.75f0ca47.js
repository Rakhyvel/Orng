var data = {lines:[
{"lineNum":"    1","line":"//! This file contains logic for validating an AST."},
{"lineNum":"    2","line":""},
{"lineNum":"    3","line":"const std = @import(\"std\");"},
{"lineNum":"    4","line":"const ast_ = @import(\"../ast/ast.zig\");"},
{"lineNum":"    5","line":"const args_ = @import(\"args.zig\");"},
{"lineNum":"    6","line":"const Const_Eval = @import(\"../semantic/const_eval.zig\");"},
{"lineNum":"    7","line":"const Compiler_Context = @import(\"../hierarchy/compiler.zig\");"},
{"lineNum":"    8","line":"const defaults_ = @import(\"defaults.zig\");"},
{"lineNum":"    9","line":"const errs_ = @import(\"../util/errors.zig\");"},
{"lineNum":"   10","line":"const poison_ = @import(\"../ast/poison.zig\");"},
{"lineNum":"   11","line":"const prelude_ = @import(\"../hierarchy/prelude.zig\");"},
{"lineNum":"   12","line":"const Tree_Writer = @import(\"../ast/tree_writer.zig\");"},
{"lineNum":"   13","line":"const typing_ = @import(\"typing.zig\");"},
{"lineNum":"   14","line":"const Type_AST = @import(\"../types/type.zig\").Type_AST;"},
{"lineNum":"   15","line":"const walk_ = @import(\"../ast/walker.zig\");"},
{"lineNum":"   16","line":""},
{"lineNum":"   17","line":"const Validate_Error_Enum = error{"},
{"lineNum":"   18","line":"    // Returned when there is a type check compile error"},
{"lineNum":"   19","line":"    CompileError,"},
{"lineNum":"   20","line":"    // Returned when a type is encountered, which may or may not be expected"},
{"lineNum":"   21","line":"    UnexpectedTypeType,"},
{"lineNum":"   22","line":"    // General purpose out of memory error"},
{"lineNum":"   23","line":"    OutOfMemory,"},
{"lineNum":"   24","line":"};"},
{"lineNum":"   25","line":""},
{"lineNum":"   26","line":"const Self: type = @This();"},
{"lineNum":"   27","line":""},
{"lineNum":"   28","line":"ctx: *Compiler_Context,"},
{"lineNum":"   29","line":"map: std.AutoArrayHashMap(*ast_.AST, *Type_AST),"},
{"lineNum":"   30","line":""},
{"lineNum":"   31","line":"pub fn init(ctx: *Compiler_Context) Self {","class":"lineCov","hits":"2","order":"114","possible_hits":"2",},
{"lineNum":"   32","line":"    return Self{","class":"lineCov","hits":"1","order":"116","possible_hits":"1",},
{"lineNum":"   33","line":"        .ctx = ctx,"},
{"lineNum":"   34","line":"        .map = std.AutoArrayHashMap(*ast_.AST, *Type_AST).init(ctx.allocator()),","class":"lineCov","hits":"1","order":"115","possible_hits":"1",},
{"lineNum":"   35","line":"    };"},
{"lineNum":"   36","line":"}"},
{"lineNum":"   37","line":""},
{"lineNum":"   38","line":"pub fn typeof(self: *const Self, ast: *ast_.AST) *Type_AST {","class":"lineCov","hits":"2","order":"2405","possible_hits":"2",},
{"lineNum":"   39","line":"    if ((ast.common().validation_state != .valid and ast.common().validation_state != .invalid)) {","class":"lineCov","hits":"2","order":"2406","possible_hits":"2",},
{"lineNum":"   40","line":"        std.debug.panic(\"type for ast {f} has not been constructed\", .{ast});","class":"linePartCov","hits":"1","order":"2407","possible_hits":"2",},
{"lineNum":"   41","line":"    }"},
{"lineNum":"   42","line":"    return self.map.get(ast) orelse poison_.poisoned_type;","class":"lineCov","hits":"2","order":"2408","possible_hits":"2",},
{"lineNum":"   43","line":"}"},
{"lineNum":"   44","line":""},
{"lineNum":"   45","line":"pub fn assert_typeof(self: *Self, ast: *ast_.AST, _type: *Type_AST) void {","class":"lineCov","hits":"2","order":"3379","possible_hits":"2",},
{"lineNum":"   46","line":"    ast.common().validation_state = .valid;","class":"lineCov","hits":"1","order":"3380","possible_hits":"1",},
{"lineNum":"   47","line":"    self.map.put(ast, _type) catch unreachable;","class":"lineCov","hits":"1","order":"3381","possible_hits":"1",},
{"lineNum":"   48","line":"}"},
{"lineNum":"   49","line":""},
{"lineNum":"   50","line":"/// Recursively validates an AST, returning a valid AST if successful, or the poisoned AST if not."},
{"lineNum":"   51","line":"///"},
{"lineNum":"   52","line":"/// Interpretation occurs during the validation of comptime AST nodes. Module compilation is possible during this phase"},
{"lineNum":"   53","line":"/// as well, when validating the build script."},
{"lineNum":"   54","line":"///"},
{"lineNum":"   55","line":"/// ### Parameters"},
{"lineNum":"   56","line":"/// - `ast`: The AST to validate."},
{"lineNum":"   57","line":"/// - `old_expected_type`: Should be null if `ast` can be any type"},
{"lineNum":"   58","line":"/// - `compiler`: The compiler instance."},
{"lineNum":"   59","line":"pub fn typecheck_AST(self: *Self, ast: *ast_.AST, expected: ?*Type_AST) Validate_Error_Enum!*Type_AST {","class":"lineCov","hits":"2","order":"2021","possible_hits":"2",},
{"lineNum":"   60","line":"    // TODO: Bit long"},
{"lineNum":"   61","line":"    if (ast.common().validation_state == .validating) {","class":"lineCov","hits":"1","order":"2022","possible_hits":"1",},
{"lineNum":"   62","line":"        // std.debug.print(\"{}\\n\", .{ast});"},
{"lineNum":"   63","line":"        self.ctx.errors.add_error(errs_.Error{ .recursive_definition = .{","class":"lineCov","hits":"2","order":"4846","possible_hits":"2",},
{"lineNum":"   64","line":"            .span = ast.token().span,","class":"lineCov","hits":"1","order":"4847","possible_hits":"1",},
{"lineNum":"   65","line":"            .symbol_name = null,"},
{"lineNum":"   66","line":"        } });"},
{"lineNum":"   67","line":"        return error.CompileError;","class":"lineCov","hits":"1","order":"4848","possible_hits":"1",},
{"lineNum":"   68","line":"    } else if (ast.common().validation_state != .unvalidated) {","class":"lineCov","hits":"1","order":"2023","possible_hits":"1",},
{"lineNum":"   69","line":"        return self.typeof(ast);","class":"lineCov","hits":"2","order":"2024","possible_hits":"2",},
{"lineNum":"   70","line":"    }"},
{"lineNum":"   71","line":""},
{"lineNum":"   72","line":"    var expected_type = expected;","class":"lineCov","hits":"1","order":"2025","possible_hits":"1",},
{"lineNum":"   73","line":""},
{"lineNum":"   74","line":"    // std.debug.print(\"{}: {?}\\n\", .{ ast, expected_type });"},
{"lineNum":"   75","line":"    ast.common().validation_state = .validating;","class":"lineCov","hits":"1","order":"2026","possible_hits":"1",},
{"lineNum":"   76","line":""},
{"lineNum":"   77","line":"    if (expected_type != null and expected_type.?.* == .poison) {","class":"lineCov","hits":"2","order":"2027","possible_hits":"2",},
{"lineNum":"   78","line":"        expected_type = null;","class":"lineCov","hits":"2","order":"2028","possible_hits":"2",},
{"lineNum":"   79","line":"    }"},
{"lineNum":"   80","line":""},
{"lineNum":"   81","line":"    if (expected_type) |_| {","class":"lineCov","hits":"1","order":"2029","possible_hits":"1",},
{"lineNum":"   82","line":"        const expanded = expected_type.?.expand_identifier();","class":"lineCov","hits":"3","order":"2089","possible_hits":"3",},
{"lineNum":"   83","line":"        if (expected_type.?.* == .type_of) {","class":"lineCov","hits":"2","order":"2102","possible_hits":"2",},
{"lineNum":"   84","line":"            expected_type.?.* = expanded.*;","class":"linePartCov","hits":"1","order":"2103","possible_hits":"2",},
{"lineNum":"   85","line":"        }"},
{"lineNum":"   86","line":"        if (expected_type.?.* == .annotation) {","class":"lineCov","hits":"2","order":"2104","possible_hits":"2",},
{"lineNum":"   87","line":"            expected_type = expected_type.?.child();","class":"lineCov","hits":"2","order":"2105","possible_hits":"2",},
{"lineNum":"   88","line":"        }"},
{"lineNum":"   89","line":"        if (expected_type.?.* == .access) {","class":"lineCov","hits":"2","order":"2106","possible_hits":"2",},
{"lineNum":"   90","line":"            expected_type = expected_type.?.symbol().?.init_typedef();","class":"linePartCov","hits":"3","order":"2030","possible_hits":"4",},
{"lineNum":"   91","line":"        }"},
{"lineNum":"   92","line":"    }"},
{"lineNum":"   93","line":""},
{"lineNum":"   94","line":"    const actual_type = self.typecheck_AST_internal(ast, expected_type) catch |e| {","class":"lineCov","hits":"2","order":"2031","possible_hits":"2",},
{"lineNum":"   95","line":"        ast.common().validation_state = .invalid;","class":"lineCov","hits":"1","order":"4837","possible_hits":"1",},
{"lineNum":"   96","line":"        return e;","class":"lineCov","hits":"2","order":"2040","possible_hits":"2",},
{"lineNum":"   97","line":"    };"},
{"lineNum":"   98","line":""},
{"lineNum":"   99","line":"    if (expected_type) |_| {","class":"lineCov","hits":"1","order":"2041","possible_hits":"1",},
{"lineNum":"  100","line":"        if (!prelude_.unit_type.types_match(expected_type.?))","class":"lineCov","hits":"2","order":"2148","possible_hits":"2",},
{"lineNum":"  101","line":"            typing_.type_check(ast.token().span, actual_type, expected_type.?, &self.ctx.errors) catch |e| {","class":"lineCov","hits":"2","order":"2149","possible_hits":"2",},
{"lineNum":"  102","line":"                ast.common().validation_state = .invalid;","class":"lineCov","hits":"1","order":"4939","possible_hits":"1",},
{"lineNum":"  103","line":"                return e;","class":"lineCov","hits":"4","order":"2042","possible_hits":"4",},
{"lineNum":"  104","line":"            };"},
{"lineNum":"  105","line":"    }"},
{"lineNum":"  106","line":""},
{"lineNum":"  107","line":"    self.map.put(ast, actual_type) catch unreachable;","class":"lineCov","hits":"2","order":"2043","possible_hits":"2",},
{"lineNum":"  108","line":""},
{"lineNum":"  109","line":"    if (actual_type.* != .poison) {","class":"lineCov","hits":"1","order":"2044","possible_hits":"1",},
{"lineNum":"  110","line":"        ast.common().validation_state = .invalid;","class":"lineCov","hits":"1","order":"2045","possible_hits":"1",},
{"lineNum":"  111","line":"    } else {"},
{"lineNum":"  112","line":"        ast.common().validation_state = .valid;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  113","line":"    }"},
{"lineNum":"  114","line":""},
{"lineNum":"  115","line":"    return actual_type;","class":"lineCov","hits":"1","order":"2046","possible_hits":"1",},
{"lineNum":"  116","line":"}"},
{"lineNum":"  117","line":""},
{"lineNum":"  118","line":"var depth: usize = 0;"},
{"lineNum":"  119","line":"fn typecheck_AST_internal(self: *Self, ast: *ast_.AST, expected: ?*Type_AST) Validate_Error_Enum!*Type_AST {","class":"lineCov","hits":"2","order":"2032","possible_hits":"2",},
{"lineNum":"  120","line":"    // TODO: Ugh this function is too long"},
{"lineNum":"  121","line":"    depth += 1;","class":"lineCov","hits":"1","order":"2033","possible_hits":"1",},
{"lineNum":"  122","line":"    // std.debug.print(\"[{}] {f}: {?f}\\n\", .{ depth, ast, expected });"},
{"lineNum":"  123","line":"    switch (ast.*) {","class":"linePartCov","hits":"1","order":"2034","possible_hits":"3",},
{"lineNum":"  124","line":"        // Nop, always \"valid\""},
{"lineNum":"  125","line":"        .poison => return poison_.poisoned_type,","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  126","line":""},
{"lineNum":"  127","line":"        // Pattern symbols, traits, and impls are validated elsewhere, the AST doesn\'t need to be re-validated."},
{"lineNum":"  128","line":"        .module,"},
{"lineNum":"  129","line":"        .trait,"},
{"lineNum":"  130","line":"        .impl,"},
{"lineNum":"  131","line":"        .enum_decl,"},
{"lineNum":"  132","line":"        .struct_decl,"},
{"lineNum":"  133","line":"        .type_alias,"},
{"lineNum":"  134","line":"        .unit_value,"},
{"lineNum":"  135","line":"        => return prelude_.unit_type,","class":"lineCov","hits":"1","order":"2230","possible_hits":"1",},
{"lineNum":"  136","line":""},
{"lineNum":"  137","line":"        .pattern_symbol => return ast.symbol().?.type(),","class":"lineCov","hits":"2","order":"6171","possible_hits":"2",},
{"lineNum":"  138","line":""},
{"lineNum":"  139","line":"        .int => return try typing_.type_check_int(ast, expected, &self.ctx.errors),","class":"lineCov","hits":"2","order":"2035","possible_hits":"2",},
{"lineNum":"  140","line":""},
{"lineNum":"  141","line":"        .float => return try typing_.type_check_float(ast, expected, &self.ctx.errors),","class":"lineCov","hits":"2","order":"6724","possible_hits":"2",},
{"lineNum":"  142","line":""},
{"lineNum":"  143","line":"        .string => return prelude_.string_type,","class":"lineCov","hits":"1","order":"2384","possible_hits":"1",},
{"lineNum":"  144","line":""},
{"lineNum":"  145","line":"        .identifier => {"},
{"lineNum":"  146","line":"            // look up symbol, that\'s the type"},
{"lineNum":"  147","line":"            const symbol = ast.symbol().?;","class":"lineCov","hits":"3","order":"2332","possible_hits":"3",},
{"lineNum":"  148","line":"            if (symbol.validation_state == .invalid) {","class":"lineCov","hits":"1","order":"2333","possible_hits":"1",},
{"lineNum":"  149","line":"                return error.CompileError;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  150","line":"            }"},
{"lineNum":"  151","line":"            try self.ctx.validate_symbol.validate_symbol(symbol);","class":"lineCov","hits":"2","order":"2334","possible_hits":"2",},
{"lineNum":"  152","line":"            if (symbol.is_type() or symbol.kind == .context) {","class":"lineCov","hits":"2","order":"2339","possible_hits":"2",},
{"lineNum":"  153","line":"                if (expected != null) {","class":"lineCov","hits":"1","order":"6416","possible_hits":"1",},
{"lineNum":"  154","line":"                    self.ctx.errors.add_error(errs_.Error{ .unexpected_type_type = .{ .expected = expected, .span = ast.token().span } });","class":"lineCov","hits":"1","order":"6846","possible_hits":"1",},
{"lineNum":"  155","line":"                    return error.CompileError;","class":"lineCov","hits":"1","order":"6847","possible_hits":"1",},
{"lineNum":"  156","line":"                }"},
{"lineNum":"  157","line":"                return error.UnexpectedTypeType;","class":"lineCov","hits":"2","order":"2340","possible_hits":"2",},
{"lineNum":"  158","line":"            }"},
{"lineNum":"  159","line":"            if (symbol.decl.?.num_generic_params() > 0) {","class":"lineCov","hits":"2","order":"2341","possible_hits":"2",},
{"lineNum":"  160","line":"                self.ctx.errors.add_error(errs_.Error{ .unapplied_generic = .{","class":"lineCov","hits":"2","order":"5210","possible_hits":"2",},
{"lineNum":"  161","line":"                    .span = ast.token().span,","class":"lineCov","hits":"1","order":"5211","possible_hits":"1",},
{"lineNum":"  162","line":"                    .symbol_name = symbol.name,","class":"lineCov","hits":"1","order":"5212","possible_hits":"1",},
{"lineNum":"  163","line":"                    .num_generics = symbol.decl.?.num_generic_params(),","class":"lineCov","hits":"3","order":"5213","possible_hits":"3",},
{"lineNum":"  164","line":"                } });"},
{"lineNum":"  165","line":"                return error.CompileError;","class":"lineCov","hits":"2","order":"2344","possible_hits":"2",},
{"lineNum":"  166","line":"            }"},
{"lineNum":"  167","line":"            return symbol.type();","class":"lineCov","hits":"1","order":"2345","possible_hits":"1",},
{"lineNum":"  168","line":"        },"},
{"lineNum":"  169","line":"        .access => {"},
{"lineNum":"  170","line":"            _ = self.typecheck_AST(ast.lhs(), null) catch |e| switch (e) {","class":"linePartCov","hits":"1","order":"5582","possible_hits":"2",},
{"lineNum":"  171","line":"                error.UnexpectedTypeType => {}, // This is expected"},
{"lineNum":"  172","line":"                else => return e,","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  173","line":"            };"},
{"lineNum":"  174","line":""},
{"lineNum":"  175","line":"            // look up symbol, that\'s the type"},
{"lineNum":"  176","line":"            const symbol = ast.symbol().?;","class":"lineCov","hits":"3","order":"5589","possible_hits":"3",},
{"lineNum":"  177","line":"            if (symbol.validation_state == .invalid) {","class":"lineCov","hits":"1","order":"5590","possible_hits":"1",},
{"lineNum":"  178","line":"                return error.CompileError;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  179","line":"            }"},
{"lineNum":"  180","line":"            try self.ctx.validate_symbol.validate_symbol(symbol);","class":"linePartCov","hits":"1","order":"5591","possible_hits":"2",},
{"lineNum":"  181","line":""},
{"lineNum":"  182","line":"            if (symbol.decl.?.num_generic_params() > 0) {","class":"lineCov","hits":"2","order":"5592","possible_hits":"2",},
{"lineNum":"  183","line":"                self.ctx.errors.add_error(errs_.Error{ .unapplied_generic = .{","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  184","line":"                    .span = ast.token().span,","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  185","line":"                    .symbol_name = symbol.name,","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  186","line":"                    .num_generics = symbol.decl.?.num_generic_params(),","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  187","line":"                } });"},
{"lineNum":"  188","line":"                return error.CompileError;","class":"linePartCov","hits":"1","order":"5593","possible_hits":"2",},
{"lineNum":"  189","line":"            }"},
{"lineNum":"  190","line":""},
{"lineNum":"  191","line":"            if (symbol.is_type()) {","class":"lineCov","hits":"1","order":"5594","possible_hits":"1",},
{"lineNum":"  192","line":"                if (expected != null) {","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  193","line":"                    self.ctx.errors.add_error(errs_.Error{ .unexpected_type_type = .{ .expected = expected, .span = ast.token().span } });","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  194","line":"                    return error.CompileError;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  195","line":"                } else {"},
{"lineNum":"  196","line":"                    return prelude_.unit_type;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  197","line":"                }"},
{"lineNum":"  198","line":"            } else {"},
{"lineNum":"  199","line":"                return symbol.type();","class":"lineCov","hits":"1","order":"5595","possible_hits":"1",},
{"lineNum":"  200","line":"            }"},
{"lineNum":"  201","line":"        },"},
{"lineNum":"  202","line":"        .true, .false => return prelude_.bool_type,","class":"lineCov","hits":"1","order":"4734","possible_hits":"1",},
{"lineNum":"  203","line":"        .not => {"},
{"lineNum":"  204","line":"            _ = self.typecheck_AST(ast.expr(), prelude_.bool_type) catch return error.CompileError;","class":"lineCov","hits":"2","order":"6787","possible_hits":"2",},
{"lineNum":"  205","line":"            return prelude_.bool_type;","class":"lineCov","hits":"1","order":"6788","possible_hits":"1",},
{"lineNum":"  206","line":"        },"},
{"lineNum":"  207","line":"        .negate => {"},
{"lineNum":"  208","line":"            const expr_type = self.typecheck_AST(ast.expr(), expected) catch return error.CompileError;","class":"linePartCov","hits":"1","order":"6774","possible_hits":"3",},
{"lineNum":"  209","line":"            try typing_.type_check_arithmetic(ast.token().span, expr_type, &self.ctx.errors);","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  210","line":"            return expr_type;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  211","line":"        },"},
{"lineNum":"  212","line":"        .dereference => {"},
{"lineNum":"  213","line":"            const expr_span = ast.expr().token().span;","class":"lineCov","hits":"1","order":"3295","possible_hits":"1",},
{"lineNum":"  214","line":"            const expr_expected_type: ?*Type_AST ="},
{"lineNum":"  215","line":"                if (expected != null)","class":"lineCov","hits":"1","order":"3296","possible_hits":"1",},
{"lineNum":"  216","line":"                    Type_AST.create_addr_of_type(ast.token(), expected.?, false, false, self.ctx.allocator())","class":"lineCov","hits":"3","order":"3297","possible_hits":"3",},
{"lineNum":"  217","line":"                else"},
{"lineNum":"  218","line":"                    null;"},
{"lineNum":"  219","line":""},
{"lineNum":"  220","line":"            const expr_type = self.typecheck_AST(ast.expr(), expr_expected_type) catch return error.CompileError;","class":"lineCov","hits":"3","order":"3298","possible_hits":"3",},
{"lineNum":"  221","line":"            const expanded_expr_type = expr_type.expand_identifier();","class":"lineCov","hits":"1","order":"3299","possible_hits":"1",},
{"lineNum":"  222","line":"            if (expanded_expr_type.* != .addr_of) {","class":"lineCov","hits":"1","order":"3300","possible_hits":"1",},
{"lineNum":"  223","line":"                return typing_.throw_wrong_from(\"address\", \"dereference\", expanded_expr_type, expr_span, &self.ctx.errors);","class":"lineCov","hits":"1","order":"6586","possible_hits":"1",},
{"lineNum":"  224","line":"            } else {"},
{"lineNum":"  225","line":"                return expanded_expr_type.child();","class":"lineCov","hits":"1","order":"3301","possible_hits":"1",},
{"lineNum":"  226","line":"            }"},
{"lineNum":"  227","line":"        },"},
{"lineNum":"  228","line":"        .@\"try\" => {"},
{"lineNum":"  229","line":"            const expr_span = ast.expr().token().span;","class":"lineCov","hits":"1","order":"6857","possible_hits":"1",},
{"lineNum":"  230","line":"            const expr_type = self.typecheck_AST(ast.expr(), null) catch return error.CompileError;","class":"lineCov","hits":"3","order":"6858","possible_hits":"3",},
{"lineNum":"  231","line":"            var expanded_expr_type = expr_type.expand_identifier();","class":"lineCov","hits":"1","order":"6859","possible_hits":"1",},
{"lineNum":"  232","line":"            if (expanded_expr_type.* != .enum_type or expanded_expr_type.enum_type.from != .@\"error\") {","class":"lineCov","hits":"2","order":"6860","possible_hits":"2",},
{"lineNum":"  233","line":"                return typing_.throw_wrong_from(\"error\", \"try\", expanded_expr_type, expr_span, &self.ctx.errors);","class":"lineCov","hits":"1","order":"6861","possible_hits":"1",},
{"lineNum":"  234","line":"            }"},
{"lineNum":"  235","line":"            const expanded_function_codomain = ast.symbol().?.type().rhs().expand_identifier();","class":"lineCov","hits":"3","order":"6862","possible_hits":"3",},
{"lineNum":"  236","line":"            if (expanded_function_codomain.* != .enum_type or expanded_function_codomain.enum_type.from != .@\"error\") {","class":"lineCov","hits":"2","order":"6863","possible_hits":"2",},
{"lineNum":"  237","line":"                self.ctx.errors.add_error(errs_.Error{ .basic = .{","class":"lineCov","hits":"2","order":"6878","possible_hits":"2",},
{"lineNum":"  238","line":"                    .span = ast.token().span,","class":"lineCov","hits":"1","order":"6879","possible_hits":"1",},
{"lineNum":"  239","line":"                    .msg = \"enclosing function around try expression does not return an error\","},
{"lineNum":"  240","line":"                } });"},
{"lineNum":"  241","line":"                return error.CompileError;","class":"lineCov","hits":"1","order":"6880","possible_hits":"1",},
{"lineNum":"  242","line":"            } else {"},
{"lineNum":"  243","line":"                // err must match"},
{"lineNum":"  244","line":"                const expr_error_type = expanded_expr_type.get_err_type().child();","class":"lineCov","hits":"1","order":"6864","possible_hits":"1",},
{"lineNum":"  245","line":"                const function_error_type = expanded_function_codomain.get_err_type().child();","class":"lineCov","hits":"1","order":"6868","possible_hits":"1",},
{"lineNum":"  246","line":"                if (!expr_error_type.types_match(function_error_type)) {","class":"lineCov","hits":"1","order":"6869","possible_hits":"1",},
{"lineNum":"  247","line":"                    return typing_.throw_unexpected_type(expr_span, expanded_expr_type, expanded_function_codomain, &self.ctx.errors);","class":"linePartCov","hits":"1","order":"6870","possible_hits":"2",},
{"lineNum":"  248","line":"                }"},
{"lineNum":"  249","line":"            }"},
{"lineNum":"  250","line":"            return expanded_expr_type.get_ok_type().child();","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  251","line":"        },"},
{"lineNum":"  252","line":"        .default => {"},
{"lineNum":"  253","line":"            try self.ctx.validate_type.validate_type(ast.default._type);","class":"lineCov","hits":"2","order":"4920","possible_hits":"2",},
{"lineNum":"  254","line":"            return ast.default._type;","class":"lineCov","hits":"1","order":"4921","possible_hits":"1",},
{"lineNum":"  255","line":"        },"},
{"lineNum":"  256","line":"        .size_of => {"},
{"lineNum":"  257","line":"            try self.ctx.validate_type.validate_type(ast.size_of._type);","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  258","line":"            return prelude_.int_type;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  259","line":"        },"},
{"lineNum":"  260","line":"        .@\"comptime\" => {"},
{"lineNum":"  261","line":"            const expr_type = self.typecheck_AST(ast.expr(), expected) catch return error.CompileError;","class":"lineCov","hits":"3","order":"2385","possible_hits":"3",},
{"lineNum":"  262","line":"            const expr_expanded_type = expr_type.expand_identifier();","class":"lineCov","hits":"1","order":"2412","possible_hits":"1",},
{"lineNum":"  263","line":"            if (expr_expanded_type.types_match(prelude_.void_type)) {","class":"lineCov","hits":"1","order":"2413","possible_hits":"1",},
{"lineNum":"  264","line":"                return typing_.throw_unexpected_void_type(ast.expr().token().span, &self.ctx.errors);","class":"lineCov","hits":"1","order":"4833","possible_hits":"1",},
{"lineNum":"  265","line":"            }"},
{"lineNum":"  266","line":"            return expr_type;","class":"lineCov","hits":"1","order":"2414","possible_hits":"1",},
{"lineNum":"  267","line":"        },"},
{"lineNum":"  268","line":"        .assign => {"},
{"lineNum":"  269","line":"            try self.validate_L_Value(ast.lhs());","class":"lineCov","hits":"2","order":"3258","possible_hits":"2",},
{"lineNum":"  270","line":"            const lhs_type = self.typecheck_AST(ast.lhs(), null) catch return error.CompileError;","class":"lineCov","hits":"2","order":"3263","possible_hits":"2",},
{"lineNum":"  271","line":"            const rhs_expected: ?*Type_AST = if (ast.lhs().* == .identifier and std.mem.eql(u8, ast.lhs().token().data, \"_\")) null else lhs_type;","class":"lineCov","hits":"3","order":"3265","possible_hits":"3",},
{"lineNum":"  272","line":"            _ = self.typecheck_AST(ast.rhs(), rhs_expected) catch return error.CompileError;","class":"lineCov","hits":"2","order":"3266","possible_hits":"2",},
{"lineNum":"  273","line":"            try self.assert_mutable(ast.lhs());","class":"lineCov","hits":"2","order":"3267","possible_hits":"2",},
{"lineNum":"  274","line":"            return prelude_.unit_type;","class":"lineCov","hits":"1","order":"3273","possible_hits":"1",},
{"lineNum":"  275","line":"        },"},
{"lineNum":"  276","line":"        .@\"or\", .@\"and\" => {"},
{"lineNum":"  277","line":"            _ = self.typecheck_AST(ast.lhs(), prelude_.bool_type) catch return error.CompileError;","class":"lineCov","hits":"2","order":"6601","possible_hits":"2",},
{"lineNum":"  278","line":"            _ = self.typecheck_AST(ast.rhs(), prelude_.bool_type) catch return error.CompileError;","class":"lineCov","hits":"2","order":"6602","possible_hits":"2",},
{"lineNum":"  279","line":"            return prelude_.bool_type;","class":"lineCov","hits":"1","order":"6603","possible_hits":"1",},
{"lineNum":"  280","line":"        },"},
{"lineNum":"  281","line":"        .add, .sub, .mult, .div => {"},
{"lineNum":"  282","line":"            // These operators are open, since they allow for polymorphism between their operands."},
{"lineNum":"  283","line":"            const lhs_type = try self.binary_operator_open(ast, expected);","class":"lineCov","hits":"2","order":"3344","possible_hits":"2",},
{"lineNum":"  284","line":"            const expanded_lhs_type = lhs_type.expand_identifier();","class":"lineCov","hits":"1","order":"3350","possible_hits":"1",},
{"lineNum":"  285","line":"            try typing_.type_check_arithmetic(ast.token().span, expanded_lhs_type, &self.ctx.errors);","class":"lineCov","hits":"1","order":"3351","possible_hits":"1",},
{"lineNum":"  286","line":"            return expanded_lhs_type;","class":"lineCov","hits":"1","order":"3365","possible_hits":"1",},
{"lineNum":"  287","line":"        },"},
{"lineNum":"  288","line":"        .mod => {"},
{"lineNum":"  289","line":"            const lhs_type = try self.binary_operator_open(ast, null);","class":"linePartCov","hits":"1","order":"5813","possible_hits":"2",},
{"lineNum":"  290","line":"            try typing_.type_check_integral(ast.token().span, lhs_type, &self.ctx.errors);","class":"lineCov","hits":"1","order":"5814","possible_hits":"1",},
{"lineNum":"  291","line":"            return lhs_type;","class":"lineCov","hits":"1","order":"5824","possible_hits":"1",},
{"lineNum":"  292","line":"        },"},
{"lineNum":"  293","line":"        .equal, .not_equal => {"},
{"lineNum":"  294","line":"            const lhs_type = try self.binary_operator_open(ast, null);","class":"lineCov","hits":"2","order":"3405","possible_hits":"2",},
{"lineNum":"  295","line":"            try typing_.type_check_eq(ast.token().span, lhs_type, &self.ctx.errors); // TODO: Return a constraint type thats T: Eq, and let the top-level-function try and unify it","class":"lineCov","hits":"1","order":"3406","possible_hits":"1",},
{"lineNum":"  296","line":"            return prelude_.bool_type;","class":"lineCov","hits":"1","order":"3418","possible_hits":"1",},
{"lineNum":"  297","line":"        },"},
{"lineNum":"  298","line":"        .greater, .lesser, .greater_equal, .lesser_equal => {"},
{"lineNum":"  299","line":"            const lhs_type = try self.binary_operator_open(ast, null);","class":"linePartCov","hits":"1","order":"3387","possible_hits":"2",},
{"lineNum":"  300","line":"            try typing_.type_check_ord(ast.token().span, lhs_type, &self.ctx.errors);","class":"lineCov","hits":"1","order":"3388","possible_hits":"1",},
{"lineNum":"  301","line":"            return prelude_.bool_type;","class":"lineCov","hits":"1","order":"3400","possible_hits":"1",},
{"lineNum":"  302","line":"        },"},
{"lineNum":"  303","line":"        .@\"catch\", .@\"orelse\" => {"},
{"lineNum":"  304","line":"            const lhs_span = ast.lhs().token().span;","class":"lineCov","hits":"1","order":"6694","possible_hits":"1",},
{"lineNum":"  305","line":"            const lhs_type = self.typecheck_AST(ast.lhs(), null) catch return error.CompileError;","class":"lineCov","hits":"3","order":"6695","possible_hits":"3",},
{"lineNum":"  306","line":"            _ = self.typecheck_AST(ast.rhs(), expected) catch return error.CompileError;","class":"lineCov","hits":"2","order":"6696","possible_hits":"2",},
{"lineNum":"  307","line":"            var expanded_lhs_type = lhs_type.expand_identifier();","class":"lineCov","hits":"1","order":"6697","possible_hits":"1",},
{"lineNum":"  308","line":"            try typing_.coalesce_operator(expanded_lhs_type, ast, lhs_span, &self.ctx.errors);","class":"lineCov","hits":"2","order":"6698","possible_hits":"2",},
{"lineNum":"  309","line":"            return expanded_lhs_type.get_nominal_type().child();","class":"lineCov","hits":"1","order":"6704","possible_hits":"1",},
{"lineNum":"  310","line":"        },"},
{"lineNum":"  311","line":"        .bit_and, .bit_or, .bit_xor => {"},
{"lineNum":"  312","line":"            var retval: ?*Type_AST = null;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  313","line":"            for (0..ast.children().items.len) |i| {","class":"lineNoCov","hits":"0","possible_hits":"4",},
{"lineNum":"  314","line":"                const arg_type = self.typecheck_AST(ast.children().items[i], expected orelse prelude_.word64_type) catch return error.CompileError;","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  315","line":"                if (retval == null) {","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  316","line":"                    retval = arg_type;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  317","line":"                }"},
{"lineNum":"  318","line":"                try typing_.type_check_bits(ast.children().items[i].token().span, arg_type, &self.ctx.errors);","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  319","line":"            }","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  320","line":"            return retval.?;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  321","line":"        },"},
{"lineNum":"  322","line":"        .bit_not => {"},
{"lineNum":"  323","line":"            const expr_type = self.typecheck_AST(ast.expr(), expected orelse prelude_.word64_type) catch return error.CompileError;","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  324","line":"            try typing_.type_check_bits(ast.token().span, expr_type, &self.ctx.errors);","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  325","line":"            return expr_type;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  326","line":"        },"},
{"lineNum":"  327","line":"        .left_shift, .right_shift => {"},
{"lineNum":"  328","line":"            const lhs_type = self.typecheck_AST(ast.lhs(), expected orelse prelude_.word64_type) catch return error.CompileError;","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  329","line":"            _ = self.typecheck_AST(ast.rhs(), lhs_type) catch return error.CompileError;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  330","line":"            try typing_.type_check_bits(ast.token().span, lhs_type, &self.ctx.errors);","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  331","line":"            return lhs_type;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  332","line":"        },"},
{"lineNum":"  333","line":"        .call => {"},
{"lineNum":"  334","line":"            const lhs_span = ast.lhs().token().span;","class":"lineCov","hits":"1","order":"4497","possible_hits":"1",},
{"lineNum":"  335","line":"            var lhs_type = self.typecheck_AST(ast.lhs(), null) catch return error.CompileError;","class":"lineCov","hits":"3","order":"4498","possible_hits":"3",},
{"lineNum":"  336","line":"            const expanded_lhs_type = lhs_type.expand_identifier();","class":"lineCov","hits":"1","order":"4499","possible_hits":"1",},
{"lineNum":"  337","line":"            if (ast.lhs().* != .enum_value and expanded_lhs_type.* != .function) {","class":"lineCov","hits":"2","order":"4500","possible_hits":"2",},
{"lineNum":"  338","line":"                return typing_.throw_wrong_from(","class":"lineCov","hits":"1","order":"6688","possible_hits":"1",},
{"lineNum":"  339","line":"                    \"function\","},
{"lineNum":"  340","line":"                    \"call\","},
{"lineNum":"  341","line":"                    expanded_lhs_type,"},
{"lineNum":"  342","line":"                    lhs_span,"},
{"lineNum":"  343","line":"                    &self.ctx.errors,","class":"lineCov","hits":"1","order":"6687","possible_hits":"1",},
{"lineNum":"  344","line":"                );"},
{"lineNum":"  345","line":"            }"},
{"lineNum":"  346","line":""},
{"lineNum":"  347","line":"            // since enum_values are always compiler constructed, and their type is always a sum-type, this should always hold"},
{"lineNum":"  348","line":"            std.debug.assert(ast.lhs().* != .enum_value or expanded_lhs_type.* == .enum_type); // (an `implies` operator would be cool btw...)","class":"lineCov","hits":"3","order":"4501","possible_hits":"3",},
{"lineNum":"  349","line":""},
{"lineNum":"  350","line":"            // If lhs is function type and has context(s), try and find them. Error if you can\'t."},
{"lineNum":"  351","line":"            if (expanded_lhs_type.* == .function) {","class":"lineCov","hits":"1","order":"4502","possible_hits":"1",},
{"lineNum":"  352","line":"                try self.validate_context(expanded_lhs_type, ast);","class":"linePartCov","hits":"1","order":"4503","possible_hits":"2",},
{"lineNum":"  353","line":"            }"},
{"lineNum":"  354","line":""},
{"lineNum":"  355","line":"            const domain = if (expanded_lhs_type.* == .function) expanded_lhs_type.lhs() else ast.lhs().enum_value.domain.?;","class":"lineCov","hits":"3","order":"4507","possible_hits":"3",},
{"lineNum":"  356","line":"            const codomain = if (expanded_lhs_type.* == .function) expanded_lhs_type.rhs() else ast.lhs().enum_value.base.?;","class":"lineCov","hits":"3","order":"4508","possible_hits":"3",},
{"lineNum":"  357","line":"            const variadic = expanded_lhs_type.* == .function and expanded_lhs_type.function.variadic;","class":"lineCov","hits":"3","order":"4509","possible_hits":"3",},
{"lineNum":"  358","line":"            ast.set_children(try args_.default_args(.function, ast.children().*, ast.token().span, domain, &self.ctx.errors, self.ctx.allocator()));","class":"lineCov","hits":"2","order":"4510","possible_hits":"2",},
{"lineNum":"  359","line":"            args_.implicit_ref(ast.children(), domain, self.ctx.allocator());","class":"lineCov","hits":"1","order":"4512","possible_hits":"1",},
{"lineNum":"  360","line":"            try args_.validate_args_arity(.function, ast.children(), domain, variadic, ast.token().span, &self.ctx.errors);","class":"lineCov","hits":"1","order":"4520","possible_hits":"1",},
{"lineNum":"  361","line":"            _ = try self.validate_args_type(ast.children(), domain, variadic);","class":"lineCov","hits":"1","order":"4521","possible_hits":"1",},
{"lineNum":"  362","line":"            return codomain;","class":"lineCov","hits":"1","order":"4522","possible_hits":"1",},
{"lineNum":"  363","line":"        },"},
{"lineNum":"  364","line":"        .index => {"},
{"lineNum":"  365","line":"            const lhs_span = ast.lhs().token().span; // Used for error reporting","class":"lineCov","hits":"1","order":"3281","possible_hits":"1",},
{"lineNum":"  366","line":"            const lhs_type = self.typecheck_AST(ast.lhs(), null) catch return error.CompileError;","class":"lineCov","hits":"3","order":"3282","possible_hits":"3",},
{"lineNum":"  367","line":"            if (ast.children().items.len > 1) {","class":"lineCov","hits":"1","order":"3327","possible_hits":"1",},
{"lineNum":"  368","line":"                self.ctx.errors.add_error(errs_.Error{ .basic = .{ .span = ast.token().span, .msg = \"too many indices\" } });","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  369","line":"                return error.CompileError;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  370","line":"            }"},
{"lineNum":"  371","line":"            _ = self.typecheck_AST(ast.children().items[0], prelude_.int_type) catch return error.CompileError;","class":"lineCov","hits":"2","order":"3328","possible_hits":"2",},
{"lineNum":"  372","line":""},
{"lineNum":"  373","line":"            const expanded_lhs_type = try self.implicit_dereference(ast, lhs_type.expand_identifier());","class":"linePartCov","hits":"1","order":"3329","possible_hits":"2",},
{"lineNum":"  374","line":""},
{"lineNum":"  375","line":"            if (expanded_lhs_type.* == .struct_type) {","class":"lineCov","hits":"1","order":"3330","possible_hits":"1",},
{"lineNum":"  376","line":"                if (expanded_lhs_type.struct_type.was_slice) {","class":"lineCov","hits":"2","order":"6178","possible_hits":"2",},
{"lineNum":"  377","line":"                    return expanded_lhs_type.children().items[0].child().child();","class":"lineCov","hits":"2","order":"6179","possible_hits":"2",},
{"lineNum":"  378","line":"                } else {"},
{"lineNum":"  379","line":"                    self.ctx.errors.add_error(errs_.Error{ .not_indexable = .{ .span = lhs_span, ._type = expanded_lhs_type } });","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  380","line":"                    return error.CompileError;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  381","line":"                }"},
{"lineNum":"  382","line":"            } else if (expanded_lhs_type.* == .tuple_type) {","class":"lineCov","hits":"1","order":"3331","possible_hits":"1",},
{"lineNum":"  383","line":"                // TODO: comptime expand the index"},
{"lineNum":"  384","line":"                try walk_.walk_ast(ast.children().items[0], Const_Eval.new(self.ctx));","class":"lineCov","hits":"2","order":"6148","possible_hits":"2",},
{"lineNum":"  385","line":"                if (ast.children().items[0].* != .int) {","class":"lineCov","hits":"2","order":"6149","possible_hits":"2",},
{"lineNum":"  386","line":"                    self.ctx.errors.add_error(errs_.Error{ .basic = .{ .span = ast.token().span, .msg = \"not a constant integer\" } });","class":"lineCov","hits":"1","order":"6748","possible_hits":"1",},
{"lineNum":"  387","line":"                    return error.CompileError;","class":"lineCov","hits":"1","order":"6749","possible_hits":"1",},
{"lineNum":"  388","line":"                }"},
{"lineNum":"  389","line":"                const pos = ast.children().items[0].int.data;","class":"lineCov","hits":"3","order":"6150","possible_hits":"3",},
{"lineNum":"  390","line":"                ast.* = ast_.AST.create_select(ast.token(), ast.lhs(), ast.children().items[0], self.ctx.allocator()).*;","class":"lineCov","hits":"3","order":"6151","possible_hits":"3",},
{"lineNum":"  391","line":"                ast.set_pos(@as(usize, @intCast(pos)));","class":"linePartCov","hits":"1","order":"6152","possible_hits":"2",},
{"lineNum":"  392","line":"                return self.typecheck_AST(ast, expected);","class":"lineCov","hits":"1","order":"6153","possible_hits":"1",},
{"lineNum":"  393","line":"            } else if (expanded_lhs_type.* == .array_of) {","class":"lineCov","hits":"1","order":"3332","possible_hits":"1",},
{"lineNum":"  394","line":"                return expanded_lhs_type.child();","class":"lineCov","hits":"1","order":"3333","possible_hits":"1",},
{"lineNum":"  395","line":"            } else if (expanded_lhs_type.* == .addr_of and expanded_lhs_type.addr_of.multiptr) {","class":"lineCov","hits":"1","order":"5520","possible_hits":"1",},
{"lineNum":"  396","line":"                return expanded_lhs_type.child();","class":"lineCov","hits":"1","order":"5521","possible_hits":"1",},
{"lineNum":"  397","line":"            } else {"},
{"lineNum":"  398","line":"                self.ctx.errors.add_error(errs_.Error{ .not_indexable = .{ .span = lhs_span, ._type = expanded_lhs_type } });","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  399","line":"                return error.CompileError;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  400","line":"            }"},
{"lineNum":"  401","line":"        },"},
{"lineNum":"  402","line":"        .generic_apply => {"},
{"lineNum":"  403","line":"            // look up symbol, that\'s the type"},
{"lineNum":"  404","line":"            const symbol = ast.symbol().?;","class":"lineCov","hits":"3","order":"5583","possible_hits":"3",},
{"lineNum":"  405","line":"            if (symbol.validation_state == .invalid) {","class":"lineCov","hits":"1","order":"5584","possible_hits":"1",},
{"lineNum":"  406","line":"                return error.CompileError;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  407","line":"            }"},
{"lineNum":"  408","line":"            try self.ctx.validate_symbol.validate_symbol(symbol);","class":"linePartCov","hits":"1","order":"5585","possible_hits":"2",},
{"lineNum":"  409","line":"            if (symbol.is_type() or symbol.kind == .context) {","class":"lineCov","hits":"2","order":"5586","possible_hits":"2",},
{"lineNum":"  410","line":"                if (expected != null) {","class":"lineCov","hits":"1","order":"5587","possible_hits":"1",},
{"lineNum":"  411","line":"                    self.ctx.errors.add_error(errs_.Error{ .unexpected_type_type = .{ .expected = expected, .span = ast.token().span } });","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  412","line":"                    return error.CompileError;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  413","line":"                }"},
{"lineNum":"  414","line":"                return error.UnexpectedTypeType;","class":"linePartCov","hits":"1","order":"5588","possible_hits":"2",},
{"lineNum":"  415","line":"            }"},
{"lineNum":"  416","line":"            return symbol.type();","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  417","line":"        },"},
{"lineNum":"  418","line":"        .select => {"},
{"lineNum":"  419","line":"            const lhs_type = self.typecheck_AST(ast.lhs(), null) catch return error.CompileError;","class":"lineCov","hits":"3","order":"3283","possible_hits":"3",},
{"lineNum":"  420","line":"            const expanded_lhs_type = try self.implicit_dereference(ast, lhs_type.expand_identifier());","class":"linePartCov","hits":"1","order":"3285","possible_hits":"2",},
{"lineNum":"  421","line":""},
{"lineNum":"  422","line":"            if (ast.pos() == null) {","class":"lineCov","hits":"1","order":"3308","possible_hits":"1",},
{"lineNum":"  423","line":"                ast.set_pos(try typing_.find_select_pos(expanded_lhs_type, ast.rhs().token().data, ast.token().span, &self.ctx.errors));","class":"lineCov","hits":"2","order":"3309","possible_hits":"2",},
{"lineNum":"  424","line":"            }"},
{"lineNum":"  425","line":""},
{"lineNum":"  426","line":"            var select_lhs_type = expanded_lhs_type;","class":"lineCov","hits":"1","order":"3319","possible_hits":"1",},
{"lineNum":"  427","line":"            if (ast.pos().? < 0 or ast.pos().? >= select_lhs_type.children().items.len) {","class":"lineCov","hits":"2","order":"3320","possible_hits":"2",},
{"lineNum":"  428","line":"                self.ctx.errors.add_error(errs_.Error{ .bad_index = .{","class":"lineCov","hits":"2","order":"6154","possible_hits":"2",},
{"lineNum":"  429","line":"                    .span = ast.token().span,","class":"lineCov","hits":"1","order":"6155","possible_hits":"1",},
{"lineNum":"  430","line":"                    ._type = lhs_type,"},
{"lineNum":"  431","line":"                    .index = ast.pos().?,","class":"lineCov","hits":"3","order":"6156","possible_hits":"3",},
{"lineNum":"  432","line":"                    .length = select_lhs_type.children().items.len,","class":"lineCov","hits":"1","order":"6157","possible_hits":"1",},
{"lineNum":"  433","line":"                } });"},
{"lineNum":"  434","line":"                return error.CompileError;","class":"lineCov","hits":"2","order":"3321","possible_hits":"2",},
{"lineNum":"  435","line":"            }"},
{"lineNum":"  436","line":"            var retval = select_lhs_type.children().items[ast.pos().?];","class":"lineCov","hits":"2","order":"3322","possible_hits":"2",},
{"lineNum":"  437","line":"            while (retval.* == .annotation) {","class":"lineCov","hits":"1","order":"3323","possible_hits":"1",},
{"lineNum":"  438","line":"                retval = retval.child();","class":"lineCov","hits":"1","order":"3324","possible_hits":"1",},
{"lineNum":"  439","line":"            }","class":"lineCov","hits":"3","order":"3325","possible_hits":"3",},
{"lineNum":"  440","line":"            return retval;","class":"lineCov","hits":"1","order":"3326","possible_hits":"1",},
{"lineNum":"  441","line":"        },"},
{"lineNum":"  442","line":""},
{"lineNum":"  443","line":"        .invoke => {"},
{"lineNum":"  444","line":"            // true_lhs_type is lhs\'s type"},
{"lineNum":"  445","line":"            const true_lhs_type = self.typecheck_AST(ast.lhs(), null) catch return error.CompileError;","class":"lineCov","hits":"3","order":"5601","possible_hits":"3",},
{"lineNum":"  446","line":"            // method_decl is the method_decl AST of the method being invoked"},
{"lineNum":"  447","line":"            var method_decl: ?*ast_.AST = undefined;","class":"lineCov","hits":"1","order":"5602","possible_hits":"1",},
{"lineNum":"  448","line":"            if (true_lhs_type.expand_identifier().* == .dyn_type) {","class":"lineCov","hits":"1","order":"5603","possible_hits":"1",},
{"lineNum":"  449","line":"                // The receiver is a dynamic type"},
{"lineNum":"  450","line":"                const trait = true_lhs_type.expand_identifier().child().symbol().?.decl.?;","class":"lineCov","hits":"3","order":"6273","possible_hits":"3",},
{"lineNum":"  451","line":"                method_decl = trait.trait.find_method(ast.rhs().token().data);","class":"lineCov","hits":"2","order":"6274","possible_hits":"2",},
{"lineNum":"  452","line":"            } else {"},
{"lineNum":"  453","line":"                // The receiver is a regular type. STRIP AWAY ADDRs!"},
{"lineNum":"  454","line":"                const lhs_type = if (true_lhs_type.* == .addr_of) true_lhs_type.child() else true_lhs_type;","class":"lineCov","hits":"3","order":"5604","possible_hits":"3",},
{"lineNum":"  455","line":"                try self.ctx.validate_type.validate_type(lhs_type);","class":"linePartCov","hits":"1","order":"5605","possible_hits":"2",},
{"lineNum":"  456","line":"                method_decl = try ast.scope().?.lookup_impl_member(lhs_type, ast.rhs().token().data, self.ctx);","class":"lineCov","hits":"1","order":"5606","possible_hits":"1",},
{"lineNum":"  457","line":"            }"},
{"lineNum":"  458","line":"            if (method_decl == null) {","class":"lineCov","hits":"1","order":"5608","possible_hits":"1",},
{"lineNum":"  459","line":"                self.ctx.errors.add_error(errs_.Error{","class":"lineCov","hits":"2","order":"6423","possible_hits":"2",},
{"lineNum":"  460","line":"                    .type_not_impl_method = .{"},
{"lineNum":"  461","line":"                        .span = ast.token().span,","class":"lineCov","hits":"1","order":"6424","possible_hits":"1",},
{"lineNum":"  462","line":"                        .method_name = ast.rhs().token().data,","class":"lineCov","hits":"1","order":"6425","possible_hits":"1",},
{"lineNum":"  463","line":"                        ._type = true_lhs_type, // TODO: Strip away addr_of\'s"},
{"lineNum":"  464","line":"                    },"},
{"lineNum":"  465","line":"                });"},
{"lineNum":"  466","line":"                return error.CompileError;","class":"lineCov","hits":"1","order":"6426","possible_hits":"1",},
{"lineNum":"  467","line":"            }"},
{"lineNum":"  468","line":"            // std.debug.assert(method_decl.?.method_decl.impl.?.num_generic_params() == 0); // must be an instatiated impl"},
{"lineNum":"  469","line":"            const method_decl_type = self.typecheck_AST(method_decl.?, null) catch return error.CompileError;","class":"lineCov","hits":"3","order":"5609","possible_hits":"3",},
{"lineNum":"  470","line":"            ast.invoke.method_decl = method_decl.?;","class":"lineCov","hits":"3","order":"5610","possible_hits":"3",},
{"lineNum":"  471","line":"            const domain: *Type_AST = method_decl.?.method_decl.domain.?;","class":"lineCov","hits":"3","order":"5611","possible_hits":"3",},
{"lineNum":"  472","line":"            const expanded_true_lhs_type = true_lhs_type.expand_identifier();","class":"lineCov","hits":"1","order":"5612","possible_hits":"1",},
{"lineNum":"  473","line":"            if (method_decl.?.method_decl.receiver != null and !ast.invoke.prepended) {","class":"lineCov","hits":"2","order":"5613","possible_hits":"2",},
{"lineNum":"  474","line":"                const receiver_kind: ?ast_.Receiver_Kind = method_decl.?.method_decl.receiver.?.receiver.kind;","class":"lineCov","hits":"3","order":"5614","possible_hits":"3",},
{"lineNum":"  475","line":"                // Trait method takes a receiver..."},
{"lineNum":"  476","line":"                // Prepend invoke lhs to args if there is a receiver"},
{"lineNum":"  477","line":"                if (expanded_true_lhs_type.* == .dyn_type or expanded_true_lhs_type.* == .addr_of) {","class":"lineCov","hits":"2","order":"5615","possible_hits":"2",},
{"lineNum":"  478","line":"                    // lhs type is dynamic or an address..."},
{"lineNum":"  479","line":"                    if (!expanded_true_lhs_type.mut() and receiver_kind == .mut_addr_of) {","class":"lineCov","hits":"2","order":"6279","possible_hits":"2",},
{"lineNum":"  480","line":"                        // Receiver is immutable when it should be mutable"},
{"lineNum":"  481","line":"                        self.ctx.errors.add_error(errs_.Error{ .invoke_receiver_mismatch = .{","class":"lineCov","hits":"2","order":"6430","possible_hits":"2",},
{"lineNum":"  482","line":"                            .lhs_type = true_lhs_type,"},
{"lineNum":"  483","line":"                            .method_name = method_decl.?.method_decl.name.token().data,","class":"lineCov","hits":"3","order":"6431","possible_hits":"3",},
{"lineNum":"  484","line":"                            .method_receiver = receiver_kind.?,","class":"lineCov","hits":"3","order":"6432","possible_hits":"3",},
{"lineNum":"  485","line":"                            .receiver_span = ast.lhs().token().span,","class":"lineCov","hits":"1","order":"6433","possible_hits":"1",},
{"lineNum":"  486","line":"                        } });"},
{"lineNum":"  487","line":"                        return error.CompileError;","class":"lineCov","hits":"2","order":"6282","possible_hits":"2",},
{"lineNum":"  488","line":"                    }"},
{"lineNum":"  489","line":"                    ast.children().insert(0, ast.lhs()) catch unreachable; // prepend lhs to children as a receiver","class":"lineCov","hits":"2","order":"6283","possible_hits":"2",},
{"lineNum":"  490","line":"                    ast.invoke.prepended = true;","class":"lineCov","hits":"2","order":"6284","possible_hits":"2",},
{"lineNum":"  491","line":"                } else {"},
{"lineNum":"  492","line":"                    // lhs type is not dynamic and not an address"},
{"lineNum":"  493","line":"                    const addr_of = ast_.AST.create_addr_of(ast.lhs().token(), ast.lhs(), receiver_kind.? == .mut_addr_of, false, self.ctx.allocator());","class":"lineCov","hits":"3","order":"5616","possible_hits":"3",},
{"lineNum":"  494","line":"                    ast.children().insert(0, addr_of) catch unreachable; // prepend lhs to children as a receiver","class":"lineCov","hits":"2","order":"5617","possible_hits":"2",},
{"lineNum":"  495","line":"                    ast.invoke.prepended = true;","class":"lineCov","hits":"3","order":"5618","possible_hits":"3",},
{"lineNum":"  496","line":"                }"},
{"lineNum":"  497","line":"            } else if (ast.invoke.prepended) {","class":"lineCov","hits":"2","order":"6384","possible_hits":"2",},
{"lineNum":"  498","line":"                ast.set_lhs(ast.children().items[0]);","class":"linePartCov","hits":"2","order":"6385","possible_hits":"3",},
{"lineNum":"  499","line":"            }"},
{"lineNum":"  500","line":""},
{"lineNum":"  501","line":"            try self.validate_context(method_decl_type, ast);","class":"linePartCov","hits":"1","order":"5619","possible_hits":"2",},
{"lineNum":"  502","line":""},
{"lineNum":"  503","line":"            ast.set_children(try args_.default_args(.method, ast.children().*, ast.token().span, domain, &self.ctx.errors, self.ctx.allocator()));","class":"lineCov","hits":"1","order":"5620","possible_hits":"1",},
{"lineNum":"  504","line":"            try args_.validate_args_arity(.method, ast.children(), domain, false, ast.token().span, &self.ctx.errors);","class":"lineCov","hits":"1","order":"5622","possible_hits":"1",},
{"lineNum":"  505","line":"            _ = try self.validate_args_type(ast.children(), domain, false);","class":"lineCov","hits":"1","order":"5623","possible_hits":"1",},
{"lineNum":"  506","line":""},
{"lineNum":"  507","line":"            return ast.invoke.method_decl.?.method_decl.ret_type;","class":"lineCov","hits":"1","order":"5624","possible_hits":"1",},
{"lineNum":"  508","line":"        },"},
{"lineNum":"  509","line":"        .dyn_value => {"},
{"lineNum":"  510","line":"            const expr_type = self.typecheck_AST(ast.expr(), null) catch return error.CompileError;","class":"lineCov","hits":"3","order":"6396","possible_hits":"3",},
{"lineNum":"  511","line":"            try self.ctx.validate_type.validate_type(ast.dyn_value.dyn_type);","class":"lineCov","hits":"2","order":"6397","possible_hits":"2",},
{"lineNum":"  512","line":""},
{"lineNum":"  513","line":"            const impl = ast.scope().?.impl_trait_lookup(expr_type, ast.dyn_value.dyn_type.child().symbol().?);","class":"lineCov","hits":"2","order":"6398","possible_hits":"2",},
{"lineNum":"  514","line":"            if (impl.ast == null) {","class":"lineCov","hits":"1","order":"6399","possible_hits":"1",},
{"lineNum":"  515","line":"                self.ctx.errors.add_error(errs_.Error{ .type_not_impl_trait = .{","class":"lineCov","hits":"2","order":"6400","possible_hits":"2",},
{"lineNum":"  516","line":"                    .span = ast.token().span,","class":"lineCov","hits":"1","order":"6401","possible_hits":"1",},
{"lineNum":"  517","line":"                    .trait_name = ast.dyn_value.dyn_type.child().symbol().?.name,","class":"lineCov","hits":"3","order":"6402","possible_hits":"3",},
{"lineNum":"  518","line":"                    ._type = expr_type,"},
{"lineNum":"  519","line":"                } });"},
{"lineNum":"  520","line":"                return error.CompileError;","class":"linePartCov","hits":"1","order":"6403","possible_hits":"2",},
{"lineNum":"  521","line":"            }"},
{"lineNum":"  522","line":"            ast.dyn_value.impl = impl.ast;","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  523","line":""},
{"lineNum":"  524","line":"            return ast.dyn_value.dyn_type;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  525","line":"        },"},
{"lineNum":"  526","line":"        .context_value => {"},
{"lineNum":"  527","line":"            try self.ctx.validate_type.validate_type(ast.context_value.parent);","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  528","line":"            const expanded_expected: *Type_AST = if (expected == null) ast.context_value.parent.expand_identifier() else expected.?.expand_identifier();","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  529","line":"            if (expanded_expected.* == .context_type) {","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  530","line":"                // Expecting ast to be a product value of some product type"},
{"lineNum":"  531","line":"                ast.set_children(try args_.default_args(.context, ast.children().*, ast.token().span, expanded_expected, &self.ctx.errors, self.ctx.allocator()));","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  532","line":"                try args_.validate_args_arity(.context, ast.children(), expanded_expected, false, ast.token().span, &self.ctx.errors);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  533","line":"                _ = try self.validate_args_type(ast.children(), expanded_expected, false);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  534","line":"                return ast.context_value.parent;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  535","line":"            } else if (ast.context_value.parent.expand_identifier().* != .context_type) {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  536","line":"                // Parent wasn\'t even a context type!"},
{"lineNum":"  537","line":"                return typing_.throw_wrong_from(\"context\", \"context value\", ast.context_value.parent, ast.token().span, &self.ctx.errors);","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  538","line":"            } else if (!prelude_.unit_type.types_match(expanded_expected)) {","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  539","line":"                // It\'s ok to assign this to a unit type, something like `_ = (1, 2, 3)`"},
{"lineNum":"  540","line":"                // expecting something that is not a type nor a product is not ok!"},
{"lineNum":"  541","line":"                // poison `got`, so that it doesn\'t print anything for the `got` section, wouldn\'t make sense anyway"},
{"lineNum":"  542","line":"                return typing_.throw_unexpected_type(ast.token().span, expanded_expected, ast.context_value.parent, &self.ctx.errors);","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  543","line":"            } else {"},
{"lineNum":"  544","line":"                return prelude_.unit_type;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  545","line":"            }"},
{"lineNum":"  546","line":"        },"},
{"lineNum":"  547","line":"        .struct_value => {"},
{"lineNum":"  548","line":"            try self.ctx.validate_type.validate_type(ast.struct_value.parent);","class":"lineCov","hits":"2","order":"2280","possible_hits":"2",},
{"lineNum":"  549","line":"            const expanded_expected: *Type_AST = if (expected == null) ast.struct_value.parent.expand_identifier() else expected.?.expand_identifier();","class":"lineCov","hits":"2","order":"2281","possible_hits":"2",},
{"lineNum":"  550","line":"            if (expanded_expected.* == .struct_type) {","class":"lineCov","hits":"1","order":"2282","possible_hits":"1",},
{"lineNum":"  551","line":"                // Expecting ast to be a product value of some product type"},
{"lineNum":"  552","line":"                ast.set_children(try args_.default_args(.@\"struct\", ast.children().*, ast.token().span, expanded_expected, &self.ctx.errors, self.ctx.allocator()));","class":"lineCov","hits":"2","order":"2283","possible_hits":"2",},
{"lineNum":"  553","line":"                try args_.validate_args_arity(.@\"struct\", ast.children(), expanded_expected, false, ast.token().span, &self.ctx.errors);","class":"lineCov","hits":"1","order":"2318","possible_hits":"1",},
{"lineNum":"  554","line":"                _ = try self.validate_args_type(ast.children(), expanded_expected, false);","class":"lineCov","hits":"1","order":"2324","possible_hits":"1",},
{"lineNum":"  555","line":"                return ast.struct_value.parent;","class":"lineCov","hits":"1","order":"2418","possible_hits":"1",},
{"lineNum":"  556","line":"            } else if (ast.struct_value.parent.expand_identifier().* != .struct_type) {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  557","line":"                // Parent wasn\'t even a struct type!"},
{"lineNum":"  558","line":"                return typing_.throw_wrong_from(\"struct\", \"struct value\", ast.struct_value.parent, ast.token().span, &self.ctx.errors);","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  559","line":"            } else if (!prelude_.unit_type.types_match(expanded_expected)) {","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  560","line":"                // It\'s ok to assign this to a unit type, something like `_ = (1, 2, 3)`"},
{"lineNum":"  561","line":"                // expecting something that is not a type nor a product is not ok!"},
{"lineNum":"  562","line":"                // poison `got`, so that it doesn\'t print anything for the `got` section, wouldn\'t make sense anyway"},
{"lineNum":"  563","line":"                return typing_.throw_unexpected_type(ast.token().span, expanded_expected, ast.struct_value.parent, &self.ctx.errors);","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  564","line":"            } else {"},
{"lineNum":"  565","line":"                return prelude_.unit_type;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  566","line":"            }"},
{"lineNum":"  567","line":"        },"},
{"lineNum":"  568","line":"        .tuple_value => {"},
{"lineNum":"  569","line":"            // TODO: This could construct the type better..."},
{"lineNum":"  570","line":"            const expanded_expected: ?*Type_AST = if (expected == null) null else expected.?.expand_identifier();","class":"lineCov","hits":"3","order":"6130","possible_hits":"3",},
{"lineNum":"  571","line":"            var terms: std.array_list.Managed(*Type_AST) = undefined;","class":"lineCov","hits":"1","order":"6131","possible_hits":"1",},
{"lineNum":"  572","line":"            if (expanded_expected == null) {","class":"lineCov","hits":"1","order":"6132","possible_hits":"1",},
{"lineNum":"  573","line":"                terms = std.array_list.Managed(*Type_AST).init(self.ctx.allocator());","class":"lineCov","hits":"1","order":"6133","possible_hits":"1",},
{"lineNum":"  574","line":"                // Not expecting anything"},
{"lineNum":"  575","line":"                for (0..ast.children().items.len) |i| {","class":"linePartCov","hits":"3","order":"6134","possible_hits":"4",},
{"lineNum":"  576","line":"                    const term_type = self.typecheck_AST(ast.children().items[i], null) catch return error.CompileError;","class":"lineCov","hits":"3","order":"6135","possible_hits":"3",},
{"lineNum":"  577","line":"                    terms.append(term_type) catch unreachable;","class":"lineCov","hits":"2","order":"6136","possible_hits":"2",},
{"lineNum":"  578","line":"                }","class":"lineCov","hits":"4","order":"6137","possible_hits":"4",},
{"lineNum":"  579","line":"            } else if (expanded_expected != null and expanded_expected.?.* == .tuple_type) {","class":"lineCov","hits":"2","order":"6238","possible_hits":"2",},
{"lineNum":"  580","line":"                // Expecting ast to be a product value of some product type"},
{"lineNum":"  581","line":"                try args_.validate_args_arity(.tuple, ast.children(), expanded_expected.?, false, ast.token().span, &self.ctx.errors);","class":"lineCov","hits":"2","order":"6745","possible_hits":"2",},
{"lineNum":"  582","line":"                terms = try self.validate_args_type(ast.children(), expanded_expected.?, false);","class":"lineCov","hits":"1","order":"6746","possible_hits":"1",},
{"lineNum":"  583","line":"                return expected.?;","class":"lineCov","hits":"1","order":"6747","possible_hits":"1",},
{"lineNum":"  584","line":"            } else {"},
{"lineNum":"  585","line":"                // It\'s ok to assign this to a unit type, something like `_ = (1, 2, 3)`"},
{"lineNum":"  586","line":"                // expecting something that is not a type nor a product is not ok!"},
{"lineNum":"  587","line":"                // poison `got`, so that it doesn\'t print anything for the `got` section, wouldn\'t make sense anyway"},
{"lineNum":"  588","line":"                return typing_.throw_unexpected_type(ast.token().span, expected.?, poison_.poisoned_type, &self.ctx.errors);","class":"lineCov","hits":"2","order":"6239","possible_hits":"2",},
{"lineNum":"  589","line":"            }"},
{"lineNum":"  590","line":"            return Type_AST.create_tuple_type(ast.token(), terms, self.ctx.allocator());","class":"lineCov","hits":"1","order":"6138","possible_hits":"1",},
{"lineNum":"  591","line":"        },"},
{"lineNum":"  592","line":"        .array_value => {"},
{"lineNum":"  593","line":"            const expanded_expanded = get_expanded_expected(expected);","class":"lineCov","hits":"1","order":"2386","possible_hits":"1",},
{"lineNum":"  594","line":"            if (expanded_expanded != null and expanded_expanded.?.* != .array_of) {","class":"lineCov","hits":"2","order":"2389","possible_hits":"2",},
{"lineNum":"  595","line":"                return typing_.throw_wrong_from(\"array\", \"array value\", expanded_expanded.?, ast.token().span, &self.ctx.errors);","class":"linePartCov","hits":"1","order":"2390","possible_hits":"2",},
{"lineNum":"  596","line":"            }"},
{"lineNum":"  597","line":"            const elem_type = if (expanded_expanded == null) null else expanded_expanded.?.array_of._child;","class":"lineCov","hits":"3","order":"2391","possible_hits":"3",},
{"lineNum":"  598","line":"            if (ast.children().items.len != 0) {","class":"lineCov","hits":"1","order":"2392","possible_hits":"1",},
{"lineNum":"  599","line":"                const first_type = self.typecheck_AST(ast.children().items[0], elem_type) catch return error.CompileError;","class":"lineCov","hits":"3","order":"2393","possible_hits":"3",},
{"lineNum":"  600","line":"                for (ast.children().items[1..]) |child| {","class":"lineCov","hits":"4","order":"2403","possible_hits":"4",},
{"lineNum":"  601","line":"                    _ = self.typecheck_AST(child, first_type) catch return error.CompileError;","class":"lineCov","hits":"2","order":"2404","possible_hits":"2",},
{"lineNum":"  602","line":"                }","class":"lineCov","hits":"3","order":"2409","possible_hits":"3",},
{"lineNum":"  603","line":"                return Type_AST.create_array_of(ast.token(), first_type, ast_.AST.create_int(ast.token(), ast.children().items.len, self.ctx.allocator()), self.ctx.allocator());","class":"lineCov","hits":"1","order":"2410","possible_hits":"1",},
{"lineNum":"  604","line":"            } else if (expanded_expanded != null) {","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  605","line":"                return expanded_expanded.?;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  606","line":"            } else {"},
{"lineNum":"  607","line":"                self.ctx.errors.add_error(errs_.Error{ .basic = .{ .span = ast.token().span, .msg = \"cannot infer type for empty array\" } });","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  608","line":"                return error.CompileError;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  609","line":"            }"},
{"lineNum":"  610","line":"        },"},
{"lineNum":"  611","line":"        .as => {"},
{"lineNum":"  612","line":"            const child_type = self.typecheck_AST(ast.expr(), null) catch return error.CompileError;","class":"lineCov","hits":"3","order":"5500","possible_hits":"3",},
{"lineNum":"  613","line":"            if (!child_type.convertible_to(ast.type())) {","class":"lineCov","hits":"1","order":"5501","possible_hits":"1",},
{"lineNum":"  614","line":"                self.ctx.errors.add_error(errs_.Error{ .non_convertible = .{ .span = ast.token().span, .from = child_type, .to = ast.type() } });","class":"lineCov","hits":"1","order":"6780","possible_hits":"1",},
{"lineNum":"  615","line":"                return error.CompileError;","class":"lineCov","hits":"1","order":"6781","possible_hits":"1",},
{"lineNum":"  616","line":"            }"},
{"lineNum":"  617","line":"            return ast.type();","class":"lineCov","hits":"1","order":"5513","possible_hits":"1",},
{"lineNum":"  618","line":"        },"},
{"lineNum":"  619","line":"        .addr_of => {"},
{"lineNum":"  620","line":"            // FIXME: High cyclo"},
{"lineNum":"  621","line":"            if (expected == null) {","class":"lineCov","hits":"1","order":"5571","possible_hits":"1",},
{"lineNum":"  622","line":"                // Not expecting anything, just validate expr"},
{"lineNum":"  623","line":"                const child_type = self.typecheck_AST(ast.expr(), null) catch return error.CompileError;","class":"lineCov","hits":"3","order":"6420","possible_hits":"3",},
{"lineNum":"  624","line":"                try self.validate_L_Value(ast.expr());","class":"linePartCov","hits":"1","order":"6421","possible_hits":"2",},
{"lineNum":"  625","line":"                return Type_AST.create_addr_of_type(ast.token(), child_type, ast.addr_of.mut, ast.addr_of.multiptr, self.ctx.allocator());","class":"lineCov","hits":"1","order":"6422","possible_hits":"1",},
{"lineNum":"  626","line":"            } else {"},
{"lineNum":"  627","line":"                // Address value, expected must be an address, inner must match with expected\'s inner"},
{"lineNum":"  628","line":"                const expanded_expected = expected.?.expand_identifier();","class":"lineCov","hits":"3","order":"5572","possible_hits":"3",},
{"lineNum":"  629","line":"                if (expanded_expected.* == .dyn_type) {","class":"lineCov","hits":"1","order":"5573","possible_hits":"1",},
{"lineNum":"  630","line":"                    // TODO: Need to re-write this as a dyn-value"},
{"lineNum":"  631","line":"                    ast.* = ast_.AST.create_dyn_value(","class":"lineCov","hits":"1","order":"6391","possible_hits":"1",},
{"lineNum":"  632","line":"                        ast.token(),","class":"lineCov","hits":"1","order":"6386","possible_hits":"1",},
{"lineNum":"  633","line":"                        expanded_expected,"},
{"lineNum":"  634","line":"                        ast.expr(),","class":"lineCov","hits":"1","order":"6387","possible_hits":"1",},
{"lineNum":"  635","line":"                        ast.scope().?,","class":"lineCov","hits":"2","order":"6388","possible_hits":"2",},
{"lineNum":"  636","line":"                        ast.addr_of.mut,","class":"lineCov","hits":"3","order":"6389","possible_hits":"3",},
{"lineNum":"  637","line":"                        self.ctx.allocator(),","class":"lineCov","hits":"1","order":"6390","possible_hits":"1",},
{"lineNum":"  638","line":"                    ).*;"},
{"lineNum":"  639","line":"                    return self.typecheck_AST(ast, expected);","class":"linePartCov","hits":"1","order":"6395","possible_hits":"2",},
{"lineNum":"  640","line":"                } else if (expanded_expected.* != .addr_of) {","class":"lineCov","hits":"1","order":"5574","possible_hits":"1",},
{"lineNum":"  641","line":"                    // Didn\'t expect an address type. Validate expr and report error"},
{"lineNum":"  642","line":"                    return typing_.throw_unexpected_type(ast.token().span, expected.?, poison_.poisoned_type, &self.ctx.errors);","class":"lineCov","hits":"3","order":"5575","possible_hits":"3",},
{"lineNum":"  643","line":"                }"},
{"lineNum":"  644","line":"                _ = expanded_expected.child().expand_identifier();","class":"lineCov","hits":"1","order":"5576","possible_hits":"1",},
{"lineNum":"  645","line":""},
{"lineNum":"  646","line":"                // Everythings Ok."},
{"lineNum":"  647","line":"                const child_type = self.typecheck_AST(ast.expr(), expanded_expected.child()) catch return error.CompileError;","class":"lineCov","hits":"3","order":"5577","possible_hits":"3",},
{"lineNum":"  648","line":"                if (ast.addr_of.mut) {","class":"lineCov","hits":"2","order":"5578","possible_hits":"2",},
{"lineNum":"  649","line":"                    try self.assert_mutable(ast.expr());","class":"linePartCov","hits":"1","order":"5579","possible_hits":"2",},
{"lineNum":"  650","line":"                }"},
{"lineNum":"  651","line":"                return Type_AST.create_addr_of_type(ast.token(), child_type, ast.addr_of.mut, ast.addr_of.multiptr, self.ctx.allocator());","class":"lineCov","hits":"2","order":"5580","possible_hits":"2",},
{"lineNum":"  652","line":"            }"},
{"lineNum":"  653","line":"        },"},
{"lineNum":"  654","line":"        .slice_of => {"},
{"lineNum":"  655","line":"            const expr_type = self.typecheck_AST(ast.expr(), null) catch return error.CompileError;","class":"lineCov","hits":"3","order":"4856","possible_hits":"3",},
{"lineNum":"  656","line":""},
{"lineNum":"  657","line":"            // ast.expr() must be homotypical tuple type of expected"},
{"lineNum":"  658","line":"            if (expr_type.* != .array_of) {","class":"lineCov","hits":"1","order":"4857","possible_hits":"1",},
{"lineNum":"  659","line":"                self.ctx.errors.add_error(errs_.Error{ .basic = .{","class":"lineCov","hits":"2","order":"4858","possible_hits":"2",},
{"lineNum":"  660","line":"                    .span = ast.token().span,","class":"lineCov","hits":"1","order":"4859","possible_hits":"1",},
{"lineNum":"  661","line":"                    .msg = \"attempt to take slice-of something that is not an array\","},
{"lineNum":"  662","line":"                } });"},
{"lineNum":"  663","line":"                return error.CompileError;","class":"lineCov","hits":"1","order":"4860","possible_hits":"1",},
{"lineNum":"  664","line":"            }"},
{"lineNum":"  665","line":""},
{"lineNum":"  666","line":"            if (ast.slice_of.mut) {","class":"lineCov","hits":"2","order":"5546","possible_hits":"2",},
{"lineNum":"  667","line":"                try self.assert_mutable(ast.expr());","class":"linePartCov","hits":"1","order":"5547","possible_hits":"2",},
{"lineNum":"  668","line":"            }"},
{"lineNum":"  669","line":"            const retval = Type_AST.create_slice_type(expr_type.child(), ast.slice_of.mut, self.ctx.allocator());","class":"lineCov","hits":"3","order":"5548","possible_hits":"3",},
{"lineNum":"  670","line":"            ast.* = ast_.AST.create_slice_value(ast.expr(), ast.slice_of.mut, expr_type, self.ctx.allocator()).*;","class":"lineCov","hits":"3","order":"5549","possible_hits":"3",},
{"lineNum":"  671","line":"            _ = self.typecheck_AST(ast, null) catch return error.CompileError;","class":"lineCov","hits":"2","order":"5570","possible_hits":"2",},
{"lineNum":"  672","line":"            return retval;","class":"lineCov","hits":"1","order":"5581","possible_hits":"1",},
{"lineNum":"  673","line":"        },"},
{"lineNum":"  674","line":"        .sub_slice => {"},
{"lineNum":"  675","line":"            const super_type = self.typecheck_AST(ast.sub_slice.super, null) catch return error.CompileError;","class":"lineCov","hits":"3","order":"6834","possible_hits":"3",},
{"lineNum":"  676","line":"            const expanded_super_type = super_type.expand_identifier();","class":"lineCov","hits":"1","order":"6835","possible_hits":"1",},
{"lineNum":"  677","line":"            _ = self.typecheck_AST(ast.sub_slice.lower.?, null) catch return error.CompileError; // lower and upper should exist","class":"lineCov","hits":"2","order":"6836","possible_hits":"2",},
{"lineNum":"  678","line":"            _ = self.typecheck_AST(ast.sub_slice.upper.?, null) catch return error.CompileError; // they are set in expand phase","class":"lineCov","hits":"2","order":"6837","possible_hits":"2",},
{"lineNum":"  679","line":"            if (expanded_super_type.* != .struct_type or !expanded_super_type.struct_type.was_slice) {","class":"lineCov","hits":"2","order":"6838","possible_hits":"2",},
{"lineNum":"  680","line":"                self.ctx.errors.add_error(errs_.Error{ .not_subsliceable = .{","class":"lineCov","hits":"2","order":"6839","possible_hits":"2",},
{"lineNum":"  681","line":"                    .span = ast.token().span,","class":"lineCov","hits":"1","order":"6840","possible_hits":"1",},
{"lineNum":"  682","line":"                    ._type = expanded_super_type,"},
{"lineNum":"  683","line":"                } });"},
{"lineNum":"  684","line":"                return error.CompileError;","class":"lineCov","hits":"1","order":"6841","possible_hits":"1",},
{"lineNum":"  685","line":"            }"},
{"lineNum":"  686","line":"            return expanded_super_type;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  687","line":"        },"},
{"lineNum":"  688","line":""},
{"lineNum":"  689","line":"        .enum_value => {"},
{"lineNum":"  690","line":"            if (ast.enum_value.base == null and expected == null) {","class":"lineCov","hits":"2","order":"2358","possible_hits":"2",},
{"lineNum":"  691","line":"                self.ctx.errors.add_error(errs_.Error{ .basic = .{ .span = ast.token().span, .msg = \"cannot infer type for initializer\" } });","class":"lineCov","hits":"1","order":"6750","possible_hits":"1",},
{"lineNum":"  692","line":"                return error.CompileError;","class":"lineCov","hits":"1","order":"6751","possible_hits":"1",},
{"lineNum":"  693","line":"            } else if (ast.enum_value.base == null) {","class":"lineCov","hits":"2","order":"2359","possible_hits":"2",},
{"lineNum":"  694","line":"                // Infer that the base type is `expected`"},
{"lineNum":"  695","line":"                ast.enum_value.base = expected;","class":"lineCov","hits":"3","order":"2360","possible_hits":"3",},
{"lineNum":"  696","line":"            }"},
{"lineNum":"  697","line":""},
{"lineNum":"  698","line":"            const expanded_base: *Type_AST = ast.enum_value.base.?.expand_identifier();","class":"lineCov","hits":"3","order":"2361","possible_hits":"3",},
{"lineNum":"  699","line":"            if (expanded_base.* != .enum_type) {","class":"lineCov","hits":"1","order":"2362","possible_hits":"1",},
{"lineNum":"  700","line":"                return typing_.throw_wrong_from(\"enum\", \"enum value\", expanded_base, ast.token().span, &self.ctx.errors);","class":"lineCov","hits":"1","order":"6752","possible_hits":"1",},
{"lineNum":"  701","line":"            }"},
{"lineNum":"  702","line":""},
{"lineNum":"  703","line":"            const pos = expanded_base.get_pos(ast.token().data);","class":"lineCov","hits":"1","order":"2363","possible_hits":"1",},
{"lineNum":"  704","line":"            if (pos == null and expanded_base.* == .enum_type) {","class":"lineCov","hits":"2","order":"2368","possible_hits":"2",},
{"lineNum":"  705","line":"                self.ctx.errors.add_error(errs_.Error{ .member_not_in_type = .{ .span = ast.token().span, .identifier = ast.token().data, .name = \"enum\", .type = expanded_base } });","class":"lineCov","hits":"1","order":"6754","possible_hits":"1",},
{"lineNum":"  706","line":"                return error.CompileError;","class":"lineCov","hits":"1","order":"6755","possible_hits":"1",},
{"lineNum":"  707","line":"            }"},
{"lineNum":"  708","line":"            ast.set_pos(expanded_base.get_pos(ast.token().data));","class":"lineCov","hits":"1","order":"2369","possible_hits":"1",},
{"lineNum":"  709","line":""},
{"lineNum":"  710","line":"            ast.enum_value.domain = expanded_base.children().items[ast.pos().?];","class":"lineCov","hits":"3","order":"2372","possible_hits":"3",},
{"lineNum":"  711","line":"            if (ast.enum_value.init == null) {","class":"lineCov","hits":"2","order":"2375","possible_hits":"2",},
{"lineNum":"  712","line":"                // This may be usurped by a .call node"},
{"lineNum":"  713","line":"                ast.enum_value.init = ast.enum_value.domain.?.annotation.init orelse","class":"lineCov","hits":"3","order":"2376","possible_hits":"3",},
{"lineNum":"  714","line":"                    try defaults_.generate_default(ast.enum_value.domain.?.child(), ast.token().span, &self.ctx.errors, self.ctx.allocator());","class":"lineCov","hits":"3","order":"2377","possible_hits":"3",},
{"lineNum":"  715","line":"            }"},
{"lineNum":"  716","line":"            _ = self.typecheck_AST(ast.enum_value.init.?, ast.enum_value.domain.?.child()) catch return error.CompileError;","class":"lineCov","hits":"2","order":"2381","possible_hits":"2",},
{"lineNum":"  717","line":"            return ast.enum_value.base.?;","class":"lineCov","hits":"2","order":"2382","possible_hits":"2",},
{"lineNum":"  718","line":"        },"},
{"lineNum":"  719","line":"        .@\"if\" => {"},
{"lineNum":"  720","line":"            // FIXME: High cyclo"},
{"lineNum":"  721","line":"            if (ast.@\"if\".let) |let| {","class":"lineCov","hits":"2","order":"3402","possible_hits":"2",},
{"lineNum":"  722","line":"                _ = self.typecheck_AST(let, null) catch return error.CompileError;","class":"lineCov","hits":"2","order":"3403","possible_hits":"2",},
{"lineNum":"  723","line":"            }"},
{"lineNum":"  724","line":""},
{"lineNum":"  725","line":"            _ = self.typecheck_AST(ast.@\"if\".condition, prelude_.bool_type) catch return error.CompileError;","class":"lineCov","hits":"2","order":"3404","possible_hits":"2",},
{"lineNum":"  726","line":""},
{"lineNum":"  727","line":"            // expecting a type"},
{"lineNum":"  728","line":"            var expected_type: ?*Type_AST = undefined;","class":"lineCov","hits":"1","order":"3419","possible_hits":"1",},
{"lineNum":"  729","line":"            var expanded_expected: *Type_AST = undefined;","class":"lineCov","hits":"1","order":"3420","possible_hits":"1",},
{"lineNum":"  730","line":"            var is_result_optional: bool = false;","class":"lineCov","hits":"1","order":"3421","possible_hits":"1",},
{"lineNum":"  731","line":"            if (expected == null) {","class":"lineCov","hits":"1","order":"3422","possible_hits":"1",},
{"lineNum":"  732","line":"                expected_type = null;","class":"lineCov","hits":"1","order":"3423","possible_hits":"1",},
{"lineNum":"  733","line":"            } else {"},
{"lineNum":"  734","line":"                expanded_expected = expected.?.expand_identifier();","class":"lineCov","hits":"2","order":"6729","possible_hits":"2",},
{"lineNum":"  735","line":"                is_result_optional = expanded_expected.* == .enum_type and","class":"linePartCov","hits":"1","order":"6730","possible_hits":"2",},
{"lineNum":"  736","line":"                    expanded_expected.enum_type.from == .optional and","class":"linePartCov","hits":"2","order":"6731","possible_hits":"3",},
{"lineNum":"  737","line":"                    !expanded_expected.types_match(prelude_.void_type);","class":"linePartCov","hits":"2","order":"6732","possible_hits":"3",},
{"lineNum":"  738","line":"                if (ast.else_block() != null) {","class":"lineCov","hits":"1","order":"6733","possible_hits":"1",},
{"lineNum":"  739","line":"                    expected_type = expected.?;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  740","line":"                } else if (is_result_optional) {","class":"lineCov","hits":"1","order":"6734","possible_hits":"1",},
{"lineNum":"  741","line":"                    expected_type = expanded_expected.get_some_type();","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  742","line":"                } else {"},
{"lineNum":"  743","line":"                    return typing_.throw_unexpected_type(ast.token().span, expected.?, poison_.poisoned_type, &self.ctx.errors);","class":"linePartCov","hits":"1","order":"6735","possible_hits":"3",},
{"lineNum":"  744","line":"                }"},
{"lineNum":"  745","line":"            }"},
{"lineNum":"  746","line":""},
{"lineNum":"  747","line":"            const body_type = self.typecheck_AST(ast.body_block(), expected_type) catch return error.CompileError;","class":"lineCov","hits":"3","order":"3424","possible_hits":"3",},
{"lineNum":"  748","line":"            var else_type: ?*Type_AST = null;","class":"lineCov","hits":"1","order":"3431","possible_hits":"1",},
{"lineNum":"  749","line":"            if (ast.else_block() != null) {","class":"lineCov","hits":"1","order":"3432","possible_hits":"1",},
{"lineNum":"  750","line":"                else_type = self.typecheck_AST(ast.else_block().?, expected_type) catch return error.CompileError;","class":"lineCov","hits":"2","order":"3433","possible_hits":"2",},
{"lineNum":"  751","line":"            }"},
{"lineNum":"  752","line":"            if (body_type.is_ident_type(\"Void\") and ast.else_block() != null) {","class":"lineCov","hits":"2","order":"3434","possible_hits":"2",},
{"lineNum":"  753","line":"                return else_type.?;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  754","line":"            } else if (ast.else_block() != null or","class":"lineCov","hits":"2","order":"3435","possible_hits":"2",},
{"lineNum":"  755","line":"                prelude_.unit_type.types_match(body_type.expand_identifier()) or","class":"lineCov","hits":"3","order":"3436","possible_hits":"3",},
{"lineNum":"  756","line":"                body_type.expand_identifier().types_match(prelude_.void_type))","class":"lineCov","hits":"2","order":"3437","possible_hits":"2",},
{"lineNum":"  757","line":"            {"},
{"lineNum":"  758","line":"                return body_type;","class":"lineCov","hits":"1","order":"3438","possible_hits":"1",},
{"lineNum":"  759","line":"            } else {"},
{"lineNum":"  760","line":"                return Type_AST.create_optional_type(body_type, self.ctx.allocator());","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  761","line":"            }"},
{"lineNum":"  762","line":"        },"},
{"lineNum":"  763","line":"        .match => {"},
{"lineNum":"  764","line":"            if (ast.match.let != null) {","class":"lineCov","hits":"2","order":"6041","possible_hits":"2",},
{"lineNum":"  765","line":"                _ = self.typecheck_AST(ast.match.let.?, null) catch return error.CompileError;","class":"linePartCov","hits":"1","order":"6042","possible_hits":"2",},
{"lineNum":"  766","line":"            }"},
{"lineNum":"  767","line":"            const expr_type = self.typecheck_AST(ast.expr(), null) catch return error.CompileError;","class":"lineCov","hits":"3","order":"6043","possible_hits":"3",},
{"lineNum":"  768","line":""},
{"lineNum":"  769","line":"            const expanded_expr_type = expr_type.expand_identifier();","class":"lineCov","hits":"1","order":"6044","possible_hits":"1",},
{"lineNum":"  770","line":""},
{"lineNum":"  771","line":"            var retval: ?*Type_AST = null;","class":"lineCov","hits":"1","order":"6045","possible_hits":"1",},
{"lineNum":"  772","line":"            for (0..ast.children().items.len) |i| {","class":"linePartCov","hits":"3","order":"6046","possible_hits":"4",},
{"lineNum":"  773","line":"                const child_type = self.typecheck_AST(ast.children().items[i], expected) catch return error.CompileError;","class":"lineCov","hits":"3","order":"6047","possible_hits":"3",},
{"lineNum":"  774","line":"                if (!child_type.is_ident_type(\"Void\")) {","class":"lineCov","hits":"1","order":"6049","possible_hits":"1",},
{"lineNum":"  775","line":"                    retval = child_type;","class":"linePartCov","hits":"1","order":"6050","possible_hits":"2",},
{"lineNum":"  776","line":"                }"},
{"lineNum":"  777","line":"                try self.ctx.validate_pattern.assert_pattern_matches(ast.children().items[i].lhs(), expanded_expr_type);","class":"lineCov","hits":"2","order":"6051","possible_hits":"2",},
{"lineNum":"  778","line":"            }","class":"lineCov","hits":"3","order":"6065","possible_hits":"3",},
{"lineNum":"  779","line":""},
{"lineNum":"  780","line":"            try self.ctx.validate_pattern.exhaustive_check(expanded_expr_type, ast.children(), ast.token().span);","class":"lineCov","hits":"2","order":"6066","possible_hits":"2",},
{"lineNum":"  781","line":"            return retval orelse prelude_.void_type;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  782","line":"        },"},
{"lineNum":"  783","line":"        .mapping => return self.typecheck_AST(ast.rhs(), expected),","class":"lineCov","hits":"2","order":"6048","possible_hits":"2",},
{"lineNum":"  784","line":"        .@\"while\" => {"},
{"lineNum":"  785","line":"            if (ast.@\"while\".let) |let| {","class":"lineCov","hits":"2","order":"3366","possible_hits":"2",},
{"lineNum":"  786","line":"                _ = self.typecheck_AST(let, null) catch return error.CompileError;","class":"lineCov","hits":"2","order":"3367","possible_hits":"2",},
{"lineNum":"  787","line":"            }"},
{"lineNum":"  788","line":"            if (ast.@\"while\".post) |post| {","class":"lineCov","hits":"2","order":"3384","possible_hits":"2",},
{"lineNum":"  789","line":"                _ = self.typecheck_AST(post, null) catch return error.CompileError;","class":"lineCov","hits":"2","order":"3385","possible_hits":"2",},
{"lineNum":"  790","line":"            }"},
{"lineNum":"  791","line":"            _ = self.typecheck_AST(ast.@\"while\".condition, prelude_.bool_type) catch return error.CompileError;","class":"lineCov","hits":"2","order":"3386","possible_hits":"2",},
{"lineNum":"  792","line":""},
{"lineNum":"  793","line":"            _ = self.typecheck_AST(ast.body_block(), null) catch return error.CompileError;","class":"lineCov","hits":"2","order":"3401","possible_hits":"2",},
{"lineNum":"  794","line":"            if (ast.else_block() != null) {","class":"lineCov","hits":"1","order":"3439","possible_hits":"1",},
{"lineNum":"  795","line":"                _ = self.typecheck_AST(ast.else_block().?, null) catch return error.CompileError;","class":"linePartCov","hits":"1","order":"3440","possible_hits":"2",},
{"lineNum":"  796","line":"            }"},
{"lineNum":"  797","line":""},
{"lineNum":"  798","line":"            return prelude_.unit_type;","class":"linePartCov","hits":"1","order":"3441","possible_hits":"2",},
{"lineNum":"  799","line":"        },"},
{"lineNum":"  800","line":"        .with => {"},
{"lineNum":"  801","line":"            for (ast.with.contexts.items) |child| {","class":"lineNoCov","hits":"0","possible_hits":"4",},
{"lineNum":"  802","line":"                _ = try self.typecheck_AST(child, null);","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  803","line":"            }","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  804","line":"            return self.typecheck_AST(ast.with._body_block, expected);","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  805","line":"        },"},
{"lineNum":"  806","line":"        .block => {"},
{"lineNum":"  807","line":"            var last_type: ?*Type_AST = null;","class":"lineCov","hits":"1","order":"2276","possible_hits":"1",},
{"lineNum":"  808","line":"            for (0..ast.children().items.len) |i| {","class":"linePartCov","hits":"3","order":"2277","possible_hits":"4",},
{"lineNum":"  809","line":"                const expected_type: ?*Type_AST = if (ast.block.final == null and i == ast.children().items.len - 1) expected else null;","class":"lineCov","hits":"3","order":"2278","possible_hits":"3",},
{"lineNum":"  810","line":"                const statement_type = self.typecheck_AST(ast.children().items[i], expected_type) catch return error.CompileError;","class":"lineCov","hits":"3","order":"2279","possible_hits":"3",},
{"lineNum":"  811","line":"                const statement = ast.children().items[i];","class":"lineCov","hits":"3","order":"2419","possible_hits":"3",},
{"lineNum":"  812","line":"                last_type = statement_type;","class":"lineCov","hits":"1","order":"2420","possible_hits":"1",},
{"lineNum":"  813","line":"                // A middle-statement is any but the last statement if there is no final, or any statement if there is a final"},
{"lineNum":"  814","line":"                // Middle statements\' type must be unit"},
{"lineNum":"  815","line":"                const is_middle_statement = if (ast.block.final == null) i < ast.children().items.len - 1 else true;","class":"lineCov","hits":"3","order":"2421","possible_hits":"3",},
{"lineNum":"  816","line":"                if ((statement.* != .fn_decl or statement.fn_decl.name == null) and is_middle_statement) {","class":"lineCov","hits":"2","order":"2422","possible_hits":"2",},
{"lineNum":"  817","line":"                    // Don\'t worry about fn_decl\'s, those should be allowed to be \"discarded\""},
{"lineNum":"  818","line":"                    const expanded_statement_type = statement_type.expand_identifier();","class":"lineCov","hits":"1","order":"3274","possible_hits":"1",},
{"lineNum":"  819","line":"                    try typing_.middle_statement_check(statement.token().span, expanded_statement_type, &self.ctx.errors);","class":"lineCov","hits":"2","order":"2423","possible_hits":"2",},
{"lineNum":"  820","line":"                }"},
{"lineNum":"  821","line":"            }","class":"lineCov","hits":"3","order":"2424","possible_hits":"3",},
{"lineNum":"  822","line":"            if (ast.block.final) |final| {","class":"lineCov","hits":"2","order":"2425","possible_hits":"2",},
{"lineNum":"  823","line":"                _ = self.typecheck_AST(final, expected) catch return error.CompileError;","class":"lineCov","hits":"2","order":"3425","possible_hits":"2",},
{"lineNum":"  824","line":"                return prelude_.void_type;","class":"lineCov","hits":"1","order":"3430","possible_hits":"1",},
{"lineNum":"  825","line":"            } else if (ast.children().items.len == 0) {","class":"lineCov","hits":"1","order":"2426","possible_hits":"1",},
{"lineNum":"  826","line":"                return prelude_.unit_type;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  827","line":"            } else {"},
{"lineNum":"  828","line":"                return last_type.?;","class":"lineCov","hits":"1","order":"2427","possible_hits":"1",},
{"lineNum":"  829","line":"            }"},
{"lineNum":"  830","line":"        },"},
{"lineNum":"  831","line":"        .@\"break\", .@\"continue\", .@\"unreachable\" => return prelude_.void_type,","class":"lineCov","hits":"1","order":"3278","possible_hits":"1",},
{"lineNum":"  832","line":"        .@\"return\" => {"},
{"lineNum":"  833","line":"            if (ast.@\"return\"._ret_expr) |expr| {","class":"lineCov","hits":"2","order":"3426","possible_hits":"2",},
{"lineNum":"  834","line":"                _ = self.typecheck_AST(expr, ast.symbol().?.type().rhs()) catch return error.CompileError;","class":"lineCov","hits":"2","order":"4832","possible_hits":"2",},
{"lineNum":"  835","line":"            } else if (expected != null and (expected.?.expand_identifier()).* != .unit_type) {","class":"lineCov","hits":"2","order":"3427","possible_hits":"2",},
{"lineNum":"  836","line":"                const inner_fn_ret_type = ast.symbol().?.type().rhs();","class":"lineCov","hits":"3","order":"6191","possible_hits":"3",},
{"lineNum":"  837","line":"                if (inner_fn_ret_type.expand_identifier().* != .unit_type) {","class":"lineCov","hits":"1","order":"6192","possible_hits":"1",},
{"lineNum":"  838","line":"                    return typing_.throw_unexpected_type(ast.token().span, expected.?, prelude_.void_type, &self.ctx.errors);","class":"linePartCov","hits":"3","order":"3428","possible_hits":"5",},
{"lineNum":"  839","line":"                }"},
{"lineNum":"  840","line":"            }"},
{"lineNum":"  841","line":"            return prelude_.void_type;","class":"lineCov","hits":"1","order":"3429","possible_hits":"1",},
{"lineNum":"  842","line":"        },"},
{"lineNum":"  843","line":"        .@\"defer\", .@\"errdefer\" => {"},
{"lineNum":"  844","line":"            _ = self.typecheck_AST(ast.statement(), null) catch return error.CompileError;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  845","line":"            return prelude_.unit_type;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  846","line":"        },"},
{"lineNum":"  847","line":"        .fn_decl => {"},
{"lineNum":"  848","line":"            try self.ctx.validate_symbol.validate_symbol(ast.symbol().?);","class":"lineCov","hits":"2","order":"6214","possible_hits":"2",},
{"lineNum":"  849","line":"            return ast.decl_type();","class":"lineCov","hits":"1","order":"6215","possible_hits":"1",},
{"lineNum":"  850","line":"        },"},
{"lineNum":"  851","line":"        .method_decl => {"},
{"lineNum":"  852","line":"            std.debug.assert(expected == null); // Why wouldn\'t it be?","class":"lineCov","hits":"1","order":"3520","possible_hits":"1",},
{"lineNum":"  853","line":"            if (ast.symbol() != null) {","class":"lineCov","hits":"1","order":"3521","possible_hits":"1",},
{"lineNum":"  854","line":"                // Not a trait-method"},
{"lineNum":"  855","line":"                try self.ctx.validate_symbol.validate_symbol(ast.symbol().?);","class":"lineCov","hits":"2","order":"3522","possible_hits":"2",},
{"lineNum":"  856","line":"            }"},
{"lineNum":"  857","line":"            // ast.method_decl.domain = try self.typecheck_AST(ast.method_decl.domain.?, prelude_.type_type);"},
{"lineNum":"  858","line":"            try self.ctx.validate_type.validate_type(ast.method_decl.domain.?);","class":"lineCov","hits":"2","order":"3523","possible_hits":"2",},
{"lineNum":"  859","line":"            return ast.decl_type();","class":"lineCov","hits":"1","order":"3524","possible_hits":"1",},
{"lineNum":"  860","line":"        },"},
{"lineNum":"  861","line":"        .decl => {"},
{"lineNum":"  862","line":"            // ast.decl.type = try self.typecheck_AST(ast.decl.type, prelude_.type_type);"},
{"lineNum":"  863","line":"            try self.ctx.validate_type.validate_type(ast.decl.type);","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  864","line":"            if (ast.decl.init) |_init| {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  865","line":"                _ = self.typecheck_AST(_init, ast.decl.type) catch return error.CompileError;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  866","line":"            }"},
{"lineNum":"  867","line":"            try self.ctx.validate_symbol.validate_symbol(ast.decl.name.symbol().?);","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  868","line":"            return prelude_.unit_type;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  869","line":"        },"},
{"lineNum":"  870","line":"        .context_value_decl => {"},
{"lineNum":"  871","line":"            try self.ctx.validate_type.validate_type(ast.context_value_decl.parent);","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  872","line":"            if (ast.context_value_decl.init) |_init| {","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  873","line":"                _ = self.typecheck_AST(_init, ast.context_value_decl.parent) catch return error.CompileError;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  874","line":"            }"},
{"lineNum":"  875","line":"            try self.ctx.validate_symbol.validate_symbol(ast.symbol().?);","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  876","line":"            return prelude_.unit_type;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  877","line":"        },"},
{"lineNum":"  878","line":"        .binding => {"},
{"lineNum":"  879","line":"            try self.ctx.validate_type.validate_type(ast.binding.type);","class":"lineCov","hits":"2","order":"3368","possible_hits":"2",},
{"lineNum":"  880","line":"            if (ast.binding.init) |_init| {","class":"lineCov","hits":"2","order":"3369","possible_hits":"2",},
{"lineNum":"  881","line":"                _ = self.typecheck_AST(_init, ast.binding.type) catch return error.CompileError;","class":"lineCov","hits":"3","order":"3370","possible_hits":"3",},
{"lineNum":"  882","line":"            }"},
{"lineNum":"  883","line":"            for (ast.binding.decls.items) |decl| {","class":"lineCov","hits":"4","order":"3371","possible_hits":"4",},
{"lineNum":"  884","line":"                try self.ctx.validate_symbol.validate_symbol(decl.decl.name.symbol().?);","class":"lineCov","hits":"2","order":"3372","possible_hits":"2",},
{"lineNum":"  885","line":"            }","class":"lineCov","hits":"3","order":"3373","possible_hits":"3",},
{"lineNum":"  886","line":"            try self.ctx.validate_pattern.assert_pattern_matches(ast.binding.pattern, ast.binding.type);","class":"lineCov","hits":"2","order":"3374","possible_hits":"2",},
{"lineNum":"  887","line":"            return prelude_.unit_type;","class":"lineCov","hits":"1","order":"3383","possible_hits":"1",},
{"lineNum":"  888","line":"        },"},
{"lineNum":"  889","line":"        else => std.debug.panic(\"compiler error: typecheck_AST() unimplemented for {s}\", .{@tagName(ast.*)}),","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  890","line":"    }"},
{"lineNum":"  891","line":"}"},
{"lineNum":"  892","line":""},
{"lineNum":"  893","line":"/// Validates an open binary operator. An operator is `open` if it returns a type different from the"},
{"lineNum":"  894","line":"/// ones it acts on."},
{"lineNum":"  895","line":"///"},
{"lineNum":"  896","line":"/// Returns the type of the validated operator."},
{"lineNum":"  897","line":"pub fn binary_operator_open("},
{"lineNum":"  898","line":"    self: *Self,"},
{"lineNum":"  899","line":"    ast: *ast_.AST,"},
{"lineNum":"  900","line":"    expected: ?*Type_AST,"},
{"lineNum":"  901","line":") Validate_Error_Enum!*Type_AST {","class":"lineCov","hits":"2","order":"3345","possible_hits":"2",},
{"lineNum":"  902","line":"    const lhs_type = self.typecheck_AST(ast.lhs(), expected) catch return error.CompileError;","class":"lineCov","hits":"2","order":"3346","possible_hits":"2",},
{"lineNum":"  903","line":"    if (ast.lhs().* == .identifier and ast.lhs().symbol().?.is_type()) {","class":"lineCov","hits":"2","order":"3347","possible_hits":"2",},
{"lineNum":"  904","line":"        return error.CompileError;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  905","line":"    }"},
{"lineNum":"  906","line":"    _ = self.typecheck_AST(ast.rhs(), lhs_type) catch return error.CompileError;","class":"lineCov","hits":"2","order":"3348","possible_hits":"2",},
{"lineNum":"  907","line":"    return lhs_type;","class":"lineCov","hits":"1","order":"3349","possible_hits":"1",},
{"lineNum":"  908","line":"}"},
{"lineNum":"  909","line":""},
{"lineNum":"  910","line":"/// Validates just that each argument\'s type matches its corresponding parameter\'s type. Assumes arity is valid."},
{"lineNum":"  911","line":"pub fn validate_args_type("},
{"lineNum":"  912","line":"    self: *Self,"},
{"lineNum":"  913","line":"    args: *std.array_list.Managed(*ast_.AST),"},
{"lineNum":"  914","line":"    expected: *Type_AST,"},
{"lineNum":"  915","line":"    variadic: bool,"},
{"lineNum":"  916","line":") Validate_Error_Enum!std.array_list.Managed(*Type_AST) {","class":"lineCov","hits":"2","order":"2325","possible_hits":"2",},
{"lineNum":"  917","line":"    const expected_length = if (expected.* == .unit_type) 0 else if (expected.* == .struct_type or expected.* == .tuple_type or expected.* == .context_type) expected.children().items.len else 1;","class":"lineCov","hits":"2","order":"2326","possible_hits":"2",},
{"lineNum":"  918","line":""},
{"lineNum":"  919","line":"    var terms = std.array_list.Managed(*Type_AST).init(self.ctx.allocator());","class":"lineCov","hits":"1","order":"2327","possible_hits":"1",},
{"lineNum":"  920","line":"    errdefer terms.deinit();","class":"linePartCov","hits":"1","order":"5625","possible_hits":"2",},
{"lineNum":"  921","line":"    for (0..expected_length) |i| {","class":"linePartCov","hits":"3","order":"2328","possible_hits":"4",},
{"lineNum":"  922","line":"        const param_type = if (expected.* == .struct_type or expected.* == .tuple_type or expected.* == .context_type) expected.children().items[i] else expected;","class":"lineCov","hits":"3","order":"2329","possible_hits":"3",},
{"lineNum":"  923","line":"        const term_type = self.typecheck_AST(args.items[i], param_type) catch return error.CompileError;","class":"lineCov","hits":"4","order":"2330","possible_hits":"4",},
{"lineNum":"  924","line":"        terms.append(term_type) catch unreachable;","class":"lineCov","hits":"2","order":"2356","possible_hits":"2",},
{"lineNum":"  925","line":"    }","class":"lineCov","hits":"3","order":"2357","possible_hits":"3",},
{"lineNum":"  926","line":"    if (variadic) {","class":"linePartCov","hits":"1","order":"2415","possible_hits":"2",},
{"lineNum":"  927","line":"        for (expected_length..args.items.len) |i| {","class":"lineNoCov","hits":"0","possible_hits":"5",},
{"lineNum":"  928","line":"            const term_type = self.typecheck_AST(args.items[i], null) catch return error.CompileError;","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  929","line":"            terms.append(term_type) catch unreachable;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  930","line":"        }","class":"linePartCov","hits":"1","order":"2416","possible_hits":"5",},
{"lineNum":"  931","line":"    }"},
{"lineNum":"  932","line":"    return terms;","class":"lineCov","hits":"1","order":"2417","possible_hits":"1",},
{"lineNum":"  933","line":"}"},
{"lineNum":"  934","line":""},
{"lineNum":"  935","line":"fn validate_context(self: *Self, function_type: *Type_AST, ast: *ast_.AST) Validate_Error_Enum!void {","class":"lineCov","hits":"2","order":"4504","possible_hits":"2",},
{"lineNum":"  936","line":"    for (function_type.function.contexts.items) |context| {","class":"lineCov","hits":"3","order":"4505","possible_hits":"3",},
{"lineNum":"  937","line":"        var fn_ctx = context;","class":"lineCov","hits":"1","order":"5028","possible_hits":"1",},
{"lineNum":"  938","line":"        const symbol = ast.scope().?.context_lookup(fn_ctx, self.ctx) orelse {","class":"lineCov","hits":"2","order":"5029","possible_hits":"2",},
{"lineNum":"  939","line":"            if (fn_ctx.* == .addr_of) {","class":"lineCov","hits":"1","order":"5033","possible_hits":"1",},
{"lineNum":"  940","line":"                fn_ctx = fn_ctx.child();","class":"linePartCov","hits":"1","order":"5034","possible_hits":"2",},
{"lineNum":"  941","line":"            }"},
{"lineNum":"  942","line":"            self.ctx.errors.add_error(errs_.Error{ .missing_context = .{","class":"lineCov","hits":"2","order":"5035","possible_hits":"2",},
{"lineNum":"  943","line":"                .span = ast.token().span,","class":"lineCov","hits":"1","order":"5036","possible_hits":"1",},
{"lineNum":"  944","line":"                .context = fn_ctx,"},
{"lineNum":"  945","line":"            } });"},
{"lineNum":"  946","line":"            return error.CompileError;","class":"linePartCov","hits":"1","order":"5037","possible_hits":"2",},
{"lineNum":"  947","line":"        };"},
{"lineNum":"  948","line":"        try ast.context_args().append(symbol);","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  949","line":"    }","class":"linePartCov","hits":"2","order":"4506","possible_hits":"4",},
{"lineNum":"  950","line":"}"},
{"lineNum":"  951","line":""},
{"lineNum":"  952","line":"fn validate_L_Value(self: *Self, ast: *ast_.AST) Validate_Error_Enum!void {","class":"lineCov","hits":"2","order":"3259","possible_hits":"2",},
{"lineNum":"  953","line":"    switch (ast.*) {","class":"lineCov","hits":"3","order":"3260","possible_hits":"3",},
{"lineNum":"  954","line":"        .select, .identifier, .array_value, .context_value => {},"},
{"lineNum":"  955","line":""},
{"lineNum":"  956","line":"        .dereference => if (ast.expr().* != .addr_of) {","class":"lineCov","hits":"1","order":"6412","possible_hits":"1",},
{"lineNum":"  957","line":"            try self.validate_L_Value(ast.expr());","class":"linePartCov","hits":"2","order":"6413","possible_hits":"3",},
{"lineNum":"  958","line":"        },"},
{"lineNum":"  959","line":""},
{"lineNum":"  960","line":"        .index => try self.validate_L_Value(ast.lhs()),","class":"linePartCov","hits":"2","order":"3280","possible_hits":"3",},
{"lineNum":"  961","line":""},
{"lineNum":"  962","line":"        .tuple_value => for (ast.children().items) |term| {","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":"  963","line":"            try self.validate_L_Value(term);","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  964","line":"        },","class":"linePartCov","hits":"1","order":"3261","possible_hits":"5",},
{"lineNum":"  965","line":""},
{"lineNum":"  966","line":"        else => {"},
{"lineNum":"  967","line":"            self.ctx.errors.add_error(errs_.Error{ .basic = .{ .span = ast.token().span, .msg = \"not an l-value\" } });","class":"lineCov","hits":"1","order":"6738","possible_hits":"1",},
{"lineNum":"  968","line":"            return error.CompileError;","class":"lineCov","hits":"2","order":"3262","possible_hits":"2",},
{"lineNum":"  969","line":"        },"},
{"lineNum":"  970","line":"    }"},
{"lineNum":"  971","line":"}"},
{"lineNum":"  972","line":""},
{"lineNum":"  973","line":"fn implicit_dereference(self: *Self, ast: *ast_.AST, old_lhs_type: *Type_AST) Validate_Error_Enum!*Type_AST {","class":"lineCov","hits":"2","order":"3286","possible_hits":"2",},
{"lineNum":"  974","line":"    var lhs_type = old_lhs_type;","class":"lineCov","hits":"1","order":"3287","possible_hits":"1",},
{"lineNum":"  975","line":"    if (lhs_type.* == .addr_of and !lhs_type.addr_of.multiptr) {","class":"lineCov","hits":"2","order":"3288","possible_hits":"2",},
{"lineNum":"  976","line":"        ast.set_lhs(ast_.AST.create_dereference(ast.token(), ast.lhs(), self.ctx.allocator()));","class":"lineCov","hits":"1","order":"3289","possible_hits":"1",},
{"lineNum":"  977","line":"        lhs_type = (self.typecheck_AST(ast.lhs(), null) catch return error.CompileError).expand_identifier();","class":"lineCov","hits":"2","order":"3294","possible_hits":"2",},
{"lineNum":"  978","line":"    }"},
{"lineNum":"  979","line":"    try poison_.assert_none_poisoned(.{ ast.lhs(), lhs_type });","class":"linePartCov","hits":"1","order":"3302","possible_hits":"2",},
{"lineNum":"  980","line":"    return lhs_type;","class":"lineCov","hits":"1","order":"3307","possible_hits":"1",},
{"lineNum":"  981","line":"}"},
{"lineNum":"  982","line":""},
{"lineNum":"  983","line":"fn assert_mutable(self: *Self, ast: *ast_.AST) Validate_Error_Enum!void {","class":"lineCov","hits":"2","order":"3268","possible_hits":"2",},
{"lineNum":"  984","line":"    switch (ast.*) {","class":"linePartCov","hits":"2","order":"3269","possible_hits":"4",},
{"lineNum":"  985","line":"        .identifier => {"},
{"lineNum":"  986","line":"            const symbol = ast.symbol().?;","class":"lineCov","hits":"3","order":"3270","possible_hits":"3",},
{"lineNum":"  987","line":"            if (!std.mem.eql(u8, symbol.name, \"_\") and symbol.kind != .mut) {","class":"lineCov","hits":"2","order":"3271","possible_hits":"2",},
{"lineNum":"  988","line":"                self.ctx.errors.add_error(errs_.Error{ .modify_immutable = .{ .identifier = ast.token() } });","class":"lineCov","hits":"1","order":"6247","possible_hits":"1",},
{"lineNum":"  989","line":"                return error.CompileError;","class":"lineCov","hits":"2","order":"3272","possible_hits":"2",},
{"lineNum":"  990","line":"            }"},
{"lineNum":"  991","line":"        },"},
{"lineNum":"  992","line":""},
{"lineNum":"  993","line":"        .dereference => {"},
{"lineNum":"  994","line":"            const expr_expanded_type = self.typeof(ast.expr()).expand_identifier();","class":"lineCov","hits":"1","order":"3339","possible_hits":"1",},
{"lineNum":"  995","line":"            try self.assert_mutable_address(expr_expanded_type);","class":"lineCov","hits":"2","order":"3340","possible_hits":"2",},
{"lineNum":"  996","line":"        },"},
{"lineNum":"  997","line":""},
{"lineNum":"  998","line":"        .index => {"},
{"lineNum":"  999","line":"            const lhs_type = self.typeof(ast.lhs());","class":"lineCov","hits":"1","order":"3334","possible_hits":"1",},
{"lineNum":" 1000","line":"            if (lhs_type.* == .struct_type and lhs_type.struct_type.was_slice) {","class":"lineCov","hits":"2","order":"3335","possible_hits":"2",},
{"lineNum":" 1001","line":"                try self.assert_mutable_address(lhs_type.children().items[0].child());","class":"lineCov","hits":"2","order":"6737","possible_hits":"2",},
{"lineNum":" 1002","line":"            } else if (lhs_type.* == .addr_of and lhs_type.addr_of.multiptr) {","class":"lineCov","hits":"2","order":"3336","possible_hits":"2",},
{"lineNum":" 1003","line":"                try self.assert_mutable_address(lhs_type);","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":" 1004","line":"            } else {"},
{"lineNum":" 1005","line":"                try self.assert_mutable(ast.lhs());","class":"linePartCov","hits":"3","order":"3337","possible_hits":"5",},
{"lineNum":" 1006","line":"            }"},
{"lineNum":" 1007","line":"        },"},
{"lineNum":" 1008","line":""},
{"lineNum":" 1009","line":"        .tuple_value => for (ast.children().items) |term| {","class":"lineNoCov","hits":"0","possible_hits":"3",},
{"lineNum":" 1010","line":"            try self.assert_mutable(term);","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":" 1011","line":"        },","class":"lineNoCov","hits":"0","possible_hits":"4",},
{"lineNum":" 1012","line":""},
{"lineNum":" 1013","line":"        .select => try self.assert_mutable(ast.lhs()),","class":"linePartCov","hits":"1","order":"3338","possible_hits":"2",},
{"lineNum":" 1014","line":""},
{"lineNum":" 1015","line":"        else => {},"},
{"lineNum":" 1016","line":"    }"},
{"lineNum":" 1017","line":"}"},
{"lineNum":" 1018","line":""},
{"lineNum":" 1019","line":"fn assert_mutable_address(self: *const Self, ast: *Type_AST) Validate_Error_Enum!void {","class":"lineCov","hits":"2","order":"3341","possible_hits":"2",},
{"lineNum":" 1020","line":"    if (!ast.addr_of.mut) {","class":"lineCov","hits":"2","order":"3342","possible_hits":"2",},
{"lineNum":" 1021","line":"        self.ctx.errors.add_error(errs_.Error{ .basic = .{ .span = ast.token().span, .msg = \"cannot modify non-mutable address\" } });","class":"lineCov","hits":"1","order":"6736","possible_hits":"1",},
{"lineNum":" 1022","line":"        return error.CompileError;","class":"lineCov","hits":"2","order":"3343","possible_hits":"2",},
{"lineNum":" 1023","line":"    }"},
{"lineNum":" 1024","line":"}"},
{"lineNum":" 1025","line":""},
{"lineNum":" 1026","line":"fn get_expanded_expected(expected: ?*Type_AST) ?*Type_AST {","class":"lineCov","hits":"2","order":"2387","possible_hits":"2",},
{"lineNum":" 1027","line":"    return if (expected == null) null else expected.?.expand_identifier();","class":"lineCov","hits":"1","order":"2388","possible_hits":"1",},
{"lineNum":" 1028","line":"}"},
]};
var percent_low = 25;var percent_high = 75;
var header = { "command" : "orng-test", "date" : "2025-11-10 15:43:08", "instrumented" : 581, "covered" : 480,};
var merged_data = [];
